<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HΦ: mltplyHubbardCore.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mltply_hubbard_core_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mltplyHubbardCore.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mltply_hubbard_core_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* HPhi  -  Quantum Lattice Model Simulator */</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* Copyright (C) 2015 The University of Tokyo */</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* This program is free software: you can redistribute it and/or modify */</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* it under the terms of the GNU General Public License as published by */</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/* the Free Software Foundation, either version 3 of the License, or */</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* (at your option) any later version. */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* This program is distributed in the hope that it will be useful, */</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* but WITHOUT ANY WARRANTY; without even the implied warranty of */</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the */</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* GNU General Public License for more details. */</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* You should have received a copy of the GNU General Public License */</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/* along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;bitcalc.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;xsetmem.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;wrapperMPI.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;mltplyCommon.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;mltplyHubbardCore.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//[s] GetInfo functions</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">   34</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a>(</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> isite2,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sigma1,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sigma2</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1];</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2];</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (isite1 &gt; isite2) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 &lt; isite2) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (sigma1 &gt; sigma2) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a> + X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}<span class="comment">/*int child_general_hopp_GetInfo*/</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">   76</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a>(</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> iInterAll,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite2,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite4,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sigma1,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sigma2,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sigma3,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sigma4,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">double</span> complex tmp_V</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin, is2_spin, is3_spin, is4_spin;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> A_spin, B_spin;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isA_spin, isB_spin;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  is1_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1];</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  is2_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (isite1 &gt; isite2) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite2 &gt; isite1) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">else</span> {<span class="comment">//isite1=isite2</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (sigma1 &gt; sigma2) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  is3_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 2 + sigma3];</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  is4_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 2 + sigma4];</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (isite3 &gt; isite4) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 2 + sigma3] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 1 + sigma4]);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite3 &lt; isite4) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 2 + sigma4] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 1 + sigma3]);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">else</span> {<span class="comment">//isite3=isite4</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (sigma3 &gt; sigma4) {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 2 + sigma3] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 1 + sigma4]);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 2 + sigma4] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 1 + sigma3]);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  isA_spin = is1_spin + is2_spin;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  isB_spin = is3_spin + is4_spin;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a> = is1_spin;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a> = is2_spin;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a> = is3_spin;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a> = is4_spin;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a> = isA_spin;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a> = isB_spin;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = A_spin;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a> = B_spin;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">tmp_V</a> = tmp_V;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae17d138429da3b0e55e106e9599c499b">isite1</a> = isite1;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a523438b712f4d79554b6331505e70e14">isite2</a> = isite2;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a9bfe297ac2953656469df4531a9bdd0b">isite3</a> = isite3;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a29034b413fdc5c9ff20e38ba94f72bc7">isite4</a> = isite4;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}<span class="comment">/*int child_general_int_GetInfo*/</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">  169</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a>(</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">int</span> iPairHopp,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">int</span> isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[iPairHopp][0] + 1;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[iPairHopp][1] + 1;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">ParaPairHopping</a>[iPairHopp];</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2];</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1];</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2];</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1];</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}<span class="comment">/*int child_pairhopp_GetInfo*/</span></div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">  197</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a>(</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">int</span> iExchange,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">int</span> isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[iExchange][0] + 1;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">int</span> isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[iExchange][1] + 1;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a> = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">ParaExchangeCoupling</a>[iExchange];</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1];</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}<span class="comment">/*int child_exchange_GetInfo*/</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//[e] GetInfo functions</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//[s] core routines</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4">  233</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4">GC_CisAis</a>(</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">double</span> complex tmp_trans</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> A_ibit_tmp;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  A_ibit_tmp = (list_1_j &amp; is1_spin) / is1_spin;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  dmv = tmp_v1[j] * A_ibit_tmp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    tmp_v0[j] += dmv * tmp_trans;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }<span class="comment">/*if (X-&gt;Large.mode == M_MLTPLY || X-&gt;Large.mode == M_CALCSPEC)*/</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  dam_pr = dmv * conj(tmp_v1[j]);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}<span class="comment">/*double complex GC_CisAis*/</span></div><div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#af29e620c3f3ae1fe39112a747bc1b05d">  260</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#af29e620c3f3ae1fe39112a747bc1b05d">GC_AisCis</a>(</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">double</span> complex tmp_trans</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> A_ibit_tmp;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  A_ibit_tmp = (list_1_j &amp; is1_spin) / is1_spin;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  dmv = tmp_v1[j] * (1 - A_ibit_tmp);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    tmp_v0[j] += dmv * tmp_trans;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }<span class="comment">/*if (X-&gt;Large.mode == M_MLTPLY || X-&gt;Large.mode == M_CALCSPEC)*/</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  dam_pr = dmv * conj(tmp_v1[j]);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}<span class="comment">/*double complex GC_AisCis*/</span></div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">  288</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">int</span> A_ibit_tmp;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// off = j</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  A_ibit_tmp = (list_1_j &amp; is1_spin) / is1_spin;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">return</span> A_ibit_tmp;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928">  305</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928">CisAjt</a>(</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_spin,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum_spin,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff_spin,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">double</span> complex tmp_V</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1, ibit_tmp_2;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit, iexchg, off;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">int</span> sgn;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  ibit_tmp_1 = (<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_spin);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  ibit_tmp_2 = (<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_spin);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0 &amp;&amp; ibit_tmp_2 != 0) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    bit = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; diff_spin;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] ^ sum_spin;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>, &amp;off)==<a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    if(X-&gt;Large.mode==M_CORR){</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">      fprintf(stdout, &quot;DEBUG-1: myrank=%d, org=%d, bit=%d, iexchg=%d, list_1[%d]=%d\n&quot;,</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">              myrank, list_1[j], bit, iexchg, off, list_1[off]);</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    dmv = sgn * tmp_v1[j];</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      tmp_v0[off] += tmp_V * dmv;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    dam_pr = dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936">  354</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a>(</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_spin,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum_spin,</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff_spin,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1, ibit_tmp_2;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordtype">int</span> sgn;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  ibit_tmp_2 = (list_1_j &amp; is2_spin);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0 &amp;&amp; ibit_tmp_2 != 0) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    bit = list_1_j &amp; diff_spin;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    list_1_off = list_1_j ^ sum_spin;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    dmv = sgn * tmp_v1[j];</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      tmp_v0[list_1_off + 1] += dmv * tmp_V;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    dam_pr = dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}<span class="comment">/*double complex GC_CisAjt*/</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">  399</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_spin,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum_spin,</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff_spin,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">int</span> sgn = 1;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(list_1_j, X, is1_spin, is2_spin, sum_spin, diff_spin, tmp_off);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">if</span> (sgn != 0) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, *tmp_off, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      *tmp_off = 0;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">return</span> sgn;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}<span class="comment">/*int X_CisAjt*/</span></div><div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">  431</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j,</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_spin,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum_spin,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff_spin,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1, ibit_tmp_2;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit, off;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">int</span> sgn = 1;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  ibit_tmp_2 = (list_1_j &amp; is2_spin);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0 &amp;&amp; ibit_tmp_2 != 0) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    bit = list_1_j &amp; diff_spin;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    off = list_1_j ^ sum_spin;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">return</span> sgn; <span class="comment">// pm 1</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">//[e] core routines</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">//[s] child element functions</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59">  472</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59">child_exchange_element</a>(</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ilft = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihfbit = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  ibit1_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_up;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  ibit2_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_up;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  ibit1_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_down;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  ibit2_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_down;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down != 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down == 0) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] - (is1_down + is2_up);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    iexchg += (is1_up + is2_down);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, irght, ilft, ihfbit, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      tmp_v0[off] += dmv;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    dam_pr += dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibit1_up != 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up == 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] - (is1_up + is2_down);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    iexchg += (is1_down + is2_up);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, irght, ilft, ihfbit, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      tmp_v0[off] += dmv;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    dam_pr += dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}<span class="comment">/*double complex child_exchange_element*/</span></div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f">  533</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f">child_pairhopp_element</a>(</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ilft = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihfbit = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  ibit1_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_up;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  ibit2_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_up;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  ibit1_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_down;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  ibit2_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_down;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] - (is2_up + is2_down);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    iexchg += (is1_up + is1_down);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, irght, ilft, ihfbit, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      tmp_v0[off] += dmv;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    dam_pr += dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}<span class="comment">/*double complex child_pairhopp_element*/</span></div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5">  582</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5">GC_child_exchange_element</a>(</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  ibit1_up = list_1_j &amp; is1_up;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  ibit2_up = list_1_j &amp; is2_up;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  ibit1_down = list_1_j &amp; is1_down;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  ibit2_down = list_1_j &amp; is2_down;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down != 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down == 0) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    iexchg = list_1_j - (is1_down + is2_up);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    iexchg += (is1_up + is2_down);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    list_1_off = iexchg;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      tmp_v0[list_1_off + 1] += dmv;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    dam_pr += dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibit1_up != 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up == 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    iexchg = list_1_j - (is1_up + is2_down);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    iexchg += (is1_down + is2_up);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    list_1_off = iexchg;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      tmp_v0[list_1_off + 1] += dmv;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    dam_pr += dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}<span class="comment">/*double complex GC_child_exchange_element*/</span></div><div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">  640</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">GC_child_pairhopp_element</a>(</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  ibit1_up = list_1_j &amp; is1_up;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  ibit2_up = list_1_j &amp; is2_up;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  ibit1_down = list_1_j &amp; is1_down;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  ibit2_down = list_1_j &amp; is2_down;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    iexchg = list_1_j - (is2_up + is2_down);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    iexchg += (is1_up + is1_down);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    list_1_off = iexchg;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      tmp_v0[list_1_off + 1] += dmv;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    dam_pr += dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div><div class="line"><a name="l00689"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">  689</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a>(</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;) {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite1);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    tmp_v0[j] += dmv;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  dam_pr = conj(tmp_v1[j]) * dmv;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}<span class="comment">/*double complex child_CisAisCisAis_element*/</span></div><div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">  718</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a>(</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite4,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bsum,</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bdiff,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3, isite4, Bsum, Bdiff, tmp_off);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[*tmp_off], X, isite1);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        tmp_v0[*tmp_off] += dmv;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off]) * dmv;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}<span class="comment">/*double complex child_CisAisCjtAku_element*/</span></div><div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">  754</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a>(</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite2,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Adiff,</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  dam_pr = 0;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite1, isite2, Asum, Adiff, tmp_off);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        tmp_v0[*tmp_off] += dmv;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off]) * dmv;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;}<span class="comment">/*double complex child_CisAjtCkuAku_element*/</span></div><div class="line"><a name="l00791"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">  791</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a>(</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite2,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite4,</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Adiff,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bsum,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bdiff,</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off_2</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_1;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3, isite4, Bsum, Bdiff, &amp;tmp_off_1);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(tmp_off_1, X, isite1, isite2, Asum, Adiff, tmp_off_2);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        tmp_v0[*tmp_off_2] += dmv;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off_2]) * dmv;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;}<span class="comment">/*double complex child_CisAjtCkuAlv_element*/</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">//[s] Grand Canonical</span></div><div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">  834</a></span>&#160;<span class="comment"></span><span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a>(</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(j - 1, X, isite3);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(j - 1, X, isite1);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      tmp_v0[j] += dmv;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    dam_pr = conj(tmp_v1[j]) * dmv;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}<span class="comment">/*double complex GC_child_CisAisCisAis_element*/</span></div><div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">  865</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a>(</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite4,</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bsum,</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bdiff,</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>((j - 1), X, isite3, isite4, Bsum, Bdiff, tmp_off);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(*tmp_off, X, isite1);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        tmp_v0[*tmp_off + 1] += dmv;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off + 1]) * dmv;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}<span class="comment">/*double complex GC_child_CisAisCjtAku_element*/</span></div><div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">  901</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a>(</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite2,</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Adiff,</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;) {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>((j - 1), X, isite3);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>((j - 1), X, isite1, isite2, Asum, Adiff, tmp_off);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        tmp_v0[*tmp_off + 1] += dmv;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off + 1]) * dmv;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    }<span class="comment">/*if (tmp_sgn != 0)*/</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }<span class="comment">/*if (tmp_sgn != 0)*/</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;}<span class="comment">/*double complex GC_child_CisAjtCkuAku_element*/</span></div><div class="line"><a name="l00937"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">  937</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a>(</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite2,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3,</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite4,</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Adiff,</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bsum,</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Bdiff,</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off_2</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;) {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_1;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>((j - 1), X, isite3, isite4, Bsum, Bdiff, &amp;tmp_off_1);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(tmp_off_1, X, isite1, isite2, Asum, Adiff, tmp_off_2);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        tmp_v0[*tmp_off_2 + 1] += dmv;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off_2 + 1]) * dmv;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;}<span class="comment">/*double complex GC_child_CisAjtCkuAlv_element*/</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">//[e] Grand Canonical</span></div><div class="line"><a name="l00980"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a82057cd7316bca01585868207301cf39">  980</a></span>&#160;<span class="comment"></span><span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a82057cd7316bca01585868207301cf39">GC_Cis</a>(</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;) {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">// is1_spin = Tpow[2*isite + ispin]</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0) {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">// able to create an electron at the is1_spin state</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    list_1_off = list_1_j | is1_spin; <span class="comment">// OR</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    dmv = ipsgn * sgn * tmp_v1[j];</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">//if (X-&gt;Large.mode == M_MLTPLY) { // for multply</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    tmp_v0[list_1_off + 1] += dmv * tmp_V;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    dam_pr = dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}<span class="comment">/*double complex GC_Cis*/</span></div><div class="line"><a name="l01031"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a414245ea3f4742224f9d99a0da15a228"> 1031</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#a414245ea3f4742224f9d99a0da15a228">GC_Ajt</a>(</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v0,</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordtype">double</span> complex *tmp_v1,</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordtype">double</span> complex tmp_V,</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;) {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == is1_spin) {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// able to create an electron at the is1_spin state</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    list_1_off = list_1_j ^ is1_spin;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    dmv = ipsgn * sgn * tmp_v1[j];</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">//if (X-&gt;Large.mode == M_MLTPLY) { // for multply</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    tmp_v0[list_1_off + 1] += dmv * tmp_V;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    dam_pr = dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}<span class="comment">/*double complex GC_Ajt*/</span></div><div class="line"><a name="l01081"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#a3f49b75c63d21a51d25b3d414a759be7"> 1081</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="mltply_hubbard_core_8c.html#a3f49b75c63d21a51d25b3d414a759be7">X_Cis</a>(</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off,</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *<a class="code" href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a>,</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *list_2_1_target,</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *list_2_2_target,</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _irght,</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _ilft,</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _ihfbit</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;) {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  list_1_j = list_1_org[j];</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// is1_spin = Tpow[2*isite + ispin]</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">// able to create an electron at the is1_spin state</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    list_1_off = list_1_j | is1_spin; <span class="comment">// OR</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(list_2_1_target, list_2_2_target, list_1_off, _irght, _ilft, _ihfbit, tmp_off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      *tmp_off=0;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    }</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    sgn *= ipsgn;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">return</span> (sgn);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;}<span class="comment">/*int X_Cis*/</span></div><div class="line"><a name="l01135"></a><span class="lineno"><a class="line" href="mltply_hubbard_core_8c.html#ae302b1f2124063034b348974c361f966"> 1135</a></span>&#160;<span class="keywordtype">double</span> complex <a class="code" href="mltply_hubbard_core_8c.html#ae302b1f2124063034b348974c361f966">X_Ajt</a>(</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j,</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin,</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *tmp_off,</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *<a class="code" href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a>,</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *list_2_1_target,</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *list_2_2_target,</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _irght,</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _ilft,</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _ihfbit</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  list_1_j = list_1_org[j];</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">// is1_spin = Tpow[2*isite + ispin]</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 != 0) {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">// able to delete an electron at the is1_spin state</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    list_1_off = list_1_j ^ is1_spin;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(list_2_1_target, list_2_2_target, list_1_off, _irght, _ilft, _ihfbit, tmp_off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      *tmp_off=0;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    sgn *= ipsgn;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">return</span>(sgn);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  }</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}<span class="comment">/*double complex X_Ajt*/</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">//[e] child element functions</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">/******************************************************************************/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00410">struct.h:410</a></div></div>
<div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00342">struct.h:342</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00288">mltplyHubbardCore.c:288</a></div></div>
<div class="ttc" id="struct_large_list_html_a855e8bc4876c7e6da5249d8ae2b46b9c"><div class="ttname"><a href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">LargeList::ihfbit</a></div><div class="ttdeci">long unsigned int ihfbit</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00345">struct.h:345</a></div></div>
<div class="ttc" id="struct_define_list_html_aca15af1bddc7adf084cf01542a25f4c2"><div class="ttname"><a href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">DefineList::ExchangeCoupling</a></div><div class="ttdeci">int ** ExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling][2] Index of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00146">struct.h:146</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a576edff50809bed2a8ac5016b54027a4"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a></div><div class="ttdeci">int X_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00399">mltplyHubbardCore.c:399</a></div></div>
<div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00327">struct.h:327</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00335">struct.h:335</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00347">struct.h:347</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a913be849115ac81f093256931b45bba2"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a></div><div class="ttdeci">int child_general_int_GetInfo(int iInterAll, struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdoc">Compute mask for bit operation of general interaction term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00076">mltplyHubbardCore.c:76</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a8575bdd2f35cf049753b0617d2693edb"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00754">mltplyHubbardCore.c:754</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_addf4f9287c995be7868555e50bbf898f"><div class="ttname"><a href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f">child_pairhopp_element</a></div><div class="ttdeci">double complex child_pairhopp_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute pairhopp term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00533">mltplyHubbardCore.c:533</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_aaf0a9a1a4862be39ce011d0acf118928"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928">CisAjt</a></div><div class="ttdeci">double complex CisAjt(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V)</div><div class="ttdoc"> term for canonical Hubbard </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00305">mltplyHubbardCore.c:305</a></div></div>
<div class="ttc" id="struct_large_list_html_a523438b712f4d79554b6331505e70e14"><div class="ttname"><a href="struct_large_list.html#a523438b712f4d79554b6331505e70e14">LargeList::isite2</a></div><div class="ttdeci">int isite2</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00337">struct.h:337</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ab45a0a7e963c4c9d2d4bfa86ca5c44b8"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">GC_child_pairhopp_element</a></div><div class="ttdeci">double complex GC_child_pairhopp_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute pairhopp term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00640">mltplyHubbardCore.c:640</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00330">struct.h:330</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00026">global.h:26</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a257628b6ed79f7a93d3d2a9a957bc936"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a></div><div class="ttdeci">double complex GC_CisAjt(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V, long unsigned int *tmp_off)</div><div class="ttdoc"> term for grandcanonical Hubbard </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00354">mltplyHubbardCore.c:354</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_acc7b0c2967b4cd90703907383169df59"><div class="ttname"><a href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59">child_exchange_element</a></div><div class="ttdeci">double complex child_exchange_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute exchange term of canonical-Hubbard. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00472">mltplyHubbardCore.c:472</a></div></div>
<div class="ttc" id="struct_large_list_html_a9bfe297ac2953656469df4531a9bdd0b"><div class="ttname"><a href="struct_large_list.html#a9bfe297ac2953656469df4531a9bdd0b">LargeList::isite3</a></div><div class="ttdeci">int isite3</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00338">struct.h:338</a></div></div>
<div class="ttc" id="struct_define_list_html_ad60b3e75def64fc7dbdcd484236419eb"><div class="ttname"><a href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">DefineList::PairHopping</a></div><div class="ttdeci">int ** PairHopping</div><div class="ttdoc">[DefineList::NPairHopping][2] Index of pair-hopping. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00140">struct.h:140</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a85a5f403eb683e5ebee4ab40a8a390e5"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5">GC_child_exchange_element</a></div><div class="ttdeci">double complex GC_child_exchange_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute exchange term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00582">mltplyHubbardCore.c:582</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00341">struct.h:341</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00323">struct.h:323</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00328">struct.h:328</a></div></div>
<div class="ttc" id="struct_bind_struct_html"><div class="ttname"><a href="struct_bind_struct.html">BindStruct</a></div><div class="ttdoc">Bind. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00409">struct.h:409</a></div></div>
<div class="ttc" id="struct_define_list_html_a854ba3669106f1f557d0c021c44430b6"><div class="ttname"><a href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">DefineList::ParaExchangeCoupling</a></div><div class="ttdeci">double * ParaExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling] Coupling constant of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00148">struct.h:148</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a3f49b75c63d21a51d25b3d414a759be7"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a3f49b75c63d21a51d25b3d414a759be7">X_Cis</a></div><div class="ttdeci">int X_Cis(long unsigned int j, long unsigned int is1_spin, long unsigned int *tmp_off, long unsigned int *list_1_org, long unsigned int *list_2_1_target, long unsigned int *list_2_2_target, long unsigned int _irght, long unsigned int _ilft, long unsigned int _ihfbit)</div><div class="ttdoc">Compute index of final wavefunction associatesd to  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l01081">mltplyHubbardCore.c:1081</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_af29e620c3f3ae1fe39112a747bc1b05d"><div class="ttname"><a href="mltply_hubbard_core_8c.html#af29e620c3f3ae1fe39112a747bc1b05d">GC_AisCis</a></div><div class="ttdeci">double complex GC_AisCis(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, double complex tmp_trans)</div><div class="ttdoc">Operation of  (Grandcanonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00260">mltplyHubbardCore.c:260</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00325">struct.h:325</a></div></div>
<div class="ttc" id="struct_define_list_html_add52f995b8c9ac337a079d0bbf8ae095"><div class="ttname"><a href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">DefineList::Tpow</a></div><div class="ttdeci">long unsigned int * Tpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00090">struct.h:90</a></div></div>
<div class="ttc" id="struct_large_list_html_a8e610d200c449d87882eccdc479b8cab"><div class="ttname"><a href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">LargeList::ilft</a></div><div class="ttdeci">long unsigned int ilft</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00344">struct.h:344</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a7fbaf32cf6b714a4304e20db480b5404"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a></div><div class="ttdeci">int child_pairhopp_GetInfo(int iPairHopp, struct BindStruct *X)</div><div class="ttdoc">Compute mask for bit operation of pairhop term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00169">mltplyHubbardCore.c:169</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a414245ea3f4742224f9d99a0da15a228"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a414245ea3f4742224f9d99a0da15a228">GC_Ajt</a></div><div class="ttdeci">double complex GC_Ajt(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, long unsigned int is1_spin, double complex tmp_V, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l01031">mltplyHubbardCore.c:1031</a></div></div>
<div class="ttc" id="global_8h_html_a1e2e45bf7e1194670acdd42d8616ccac"><div class="ttname"><a href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a></div><div class="ttdeci">long unsigned int * list_1_org</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00053">global.h:53</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00326">struct.h:326</a></div></div>
<div class="ttc" id="global_8h_html_a59e163bd798ad16a8c9d47e545e2e42f"><div class="ttname"><a href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a></div><div class="ttdeci">long unsigned int * list_2_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00049">global.h:49</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a6e5c6a3af522a385b4ee60f66efb2557"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00834">mltplyHubbardCore.c:834</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ae302b1f2124063034b348974c361f966"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ae302b1f2124063034b348974c361f966">X_Ajt</a></div><div class="ttdeci">double complex X_Ajt(long unsigned int j, long unsigned int is1_spin, long unsigned int *tmp_off, long unsigned int *list_1_org, long unsigned int *list_2_1_target, long unsigned int *list_2_2_target, long unsigned int _irght, long unsigned int _ilft, long unsigned int _ihfbit)</div><div class="ttdoc">Compute index of final wavefunction associatesd to  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l01135">mltplyHubbardCore.c:1135</a></div></div>
<div class="ttc" id="global_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00047">global.h:47</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a0af550e9f9e1443323aba1b18cc35be0"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a></div><div class="ttdeci">int X_GC_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00431">mltplyHubbardCore.c:431</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00333">struct.h:333</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ad2c9c4176ec4f0f7d5087a890467a264"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a></div><div class="ttdeci">int child_general_hopp_GetInfo(struct BindStruct *X, unsigned long int isite1, unsigned long int isite2, unsigned long int sigma1, unsigned long int sigma2)</div><div class="ttdoc">Compute mask for bit operation of hopping term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00034">mltplyHubbardCore.c:34</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a11e78b661246513350ad6ee2e3985d9f"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00689">mltplyHubbardCore.c:689</a></div></div>
<div class="ttc" id="struct_large_list_html_a29034b413fdc5c9ff20e38ba94f72bc7"><div class="ttname"><a href="struct_large_list.html#a29034b413fdc5c9ff20e38ba94f72bc7">LargeList::isite4</a></div><div class="ttdeci">int isite4</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00339">struct.h:339</a></div></div>
<div class="ttc" id="struct_large_list_html_ad706dd1a7ccaaa6f4e50cdcde74382a9"><div class="ttname"><a href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">LargeList::tmp_V</a></div><div class="ttdeci">double complex tmp_V</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00348">struct.h:348</a></div></div>
<div class="ttc" id="global_8h_html_aac1d1cc6d1099e228cb1f505ef0c86c6"><div class="ttname"><a href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a></div><div class="ttdeci">long unsigned int * list_2_2</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00050">global.h:50</a></div></div>
<div class="ttc" id="struct_define_list_html_ad5e8872cb5fff4eebf3e8b8f1c42ec8e"><div class="ttname"><a href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">DefineList::ParaPairHopping</a></div><div class="ttdeci">double * ParaPairHopping</div><div class="ttdoc">[DefineList::NPairHopping] Coupling constant of pair-hopping term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00142">struct.h:142</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00346">struct.h:346</a></div></div>
<div class="ttc" id="struct_8h_html_a2e5276e30c3a9c9155e407ab3e645567"><div class="ttname"><a href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a></div><div class="ttdeci">struct EDMainCalStruct X</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00432">struct.h:432</a></div></div>
<div class="ttc" id="struct_large_list_html_ae434b7a485083dd5e96f24a24bc3e9b8"><div class="ttname"><a href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">LargeList::irght</a></div><div class="ttdeci">long unsigned int irght</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00343">struct.h:343</a></div></div>
<div class="ttc" id="global_8h_html_aa8a2431e50f9fc7d8c78af300d5f3bee"><div class="ttname"><a href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdoc">Process ID, defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00163">global.h:163</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a82057cd7316bca01585868207301cf39"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a82057cd7316bca01585868207301cf39">GC_Cis</a></div><div class="ttdeci">double complex GC_Cis(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, long unsigned int is1_spin, double complex tmp_V, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00980">mltplyHubbardCore.c:980</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a4765a56a883cd352b3f08546fc3bff08"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a></div><div class="ttdeci">int child_exchange_GetInfo(int iExchange, struct BindStruct *X)</div><div class="ttdoc">Compute mask for bit operation of exchange term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00197">mltplyHubbardCore.c:197</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a5a389f0d9543e02b5d2e19df0198bafc"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex GC_child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00865">mltplyHubbardCore.c:865</a></div></div>
<div class="ttc" id="struct_large_list_html_ae17d138429da3b0e55e106e9599c499b"><div class="ttname"><a href="struct_large_list.html#ae17d138429da3b0e55e106e9599c499b">LargeList::isite1</a></div><div class="ttdeci">int isite1</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00336">struct.h:336</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ab7d585bf30bbcee8449b8c54d0bb128e"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00901">mltplyHubbardCore.c:901</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a2e64839292192a5851d4be60a4f3561a"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00791">mltplyHubbardCore.c:791</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_acf3b726a0fbe639a2b7169210c3a24c4"><div class="ttname"><a href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4">GC_CisAis</a></div><div class="ttdeci">double complex GC_CisAis(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, double complex tmp_trans)</div><div class="ttdoc">Operation of  (Grandcanonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00233">mltplyHubbardCore.c:233</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a6d06655a28258eea84191579396219e1"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00937">mltplyHubbardCore.c:937</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a985bdb0d96a952fc6c447e12ea2b906a"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00718">mltplyHubbardCore.c:718</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="mltply_hubbard_core_8c.html">mltplyHubbardCore.c</a></li>
    <li class="footer">Generated on Mon Jul 1 2019 17:07:06 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

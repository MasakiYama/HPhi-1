<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HΦ: expec_cisajscktaltdc.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('expec__cisajscktaltdc_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">expec_cisajscktaltdc.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="expec__cisajscktaltdc_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* HPhi  -  Quantum Lattice Model Simulator */</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* Copyright (C) 2015 The University of Tokyo */</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* This program is free software: you can redistribute it and/or modify */</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/* it under the terms of the GNU General Public License as published by */</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* the Free Software Foundation, either version 3 of the License, or */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* (at your option) any later version. */</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* This program is distributed in the hope that it will be useful, */</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/* but WITHOUT ANY WARRANTY; without even the implied warranty of */</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the */</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* GNU General Public License for more details. */</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/* You should have received a copy of the GNU General Public License */</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;mltply.h&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;mltplyCommon.h&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;FileIO.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;bitcalc.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;expec_cisajscktaltdc.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;mltplySpinCore.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;mltplyHubbardCore.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;wrapperMPI.h&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;mltplyMPISpin.h&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;mltplyMPISpinCore.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;mltplyMPIHubbardCore.h&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0">expec_cisajscktalt_HubbardGC</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15">expec_cisajscktalt_Hubbard</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a918ce8a912fe44cd3f9e49f6b8ca0581">expec_cisajscktalt_Spin</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a915879a823599f9fa3b0cb041c5de568">expec_cisajscktalt_SpinHalf</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a0b7abd184f6ccce7ac4141c21fabf91c">expec_cisajscktalt_SpinGeneral</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#ad468e5109f6dc215394c103675b503fb">expec_cisajscktalt_SpinGC</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a2e87402ae7a6aeb5e826cd33cdf3ab57">expec_cisajscktalt_SpinGCHalf</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#ad2872d8b3f1c758d3933dc9e2b19dd16">expec_cisajscktalt_SpinGCGeneral</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,<span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, FILE **_fp);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a>(</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">int</span> i,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite1,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite2,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite3,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite4,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma1,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma2,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma3,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma4,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordtype">double</span> complex *tmp_V,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9">expec_cisajscktaltdc</a></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9">   85</a></span>&#160;(</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *<a class="code" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; <span class="keywordtype">double</span> complex *<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; )</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  FILE *fp;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">char</span> sdt[<a class="code" href="global_8h.html#aa68aa1cfd58c60e5cb4877965fa41576">D_FileNameMax</a>];</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght,ilft,ihfbit;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">//For TPQ</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">int</span> step=0;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> rand_i=0;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a> &lt;1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>=M_CORR;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a78387adc1f4e171d3796235adfcbd87e">GetSplitBitByModel</a>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">iCalcModel</a>, &amp;irght, &amp;ilft, &amp;ihfbit)!=0){</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">//Make File Name for output</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">switch</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>){</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">case</span> Lanczos:</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==0){</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      sprintf(sdt, <a class="code" href="global_8c.html#a30aa928612a1c54d049114f96c2d25e7">cFileName2BGreen_Lanczos</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="log_8c.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#ac36c65487237081689e0c26fbe269c35">cLanczosExpecTwoBodyGStart</a>,<span class="stringliteral">&quot;a&quot;</span>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      fprintf(<a class="code" href="global_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_log_message_8c.html#a0be8c630a1808dc9ca208626c64ba9c4">cLogLanczosExpecTwoBodyGStart</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==1){</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      sprintf(sdt, <a class="code" href="global_8c.html#a2a071aec3f989fa3b894107138199ddb">cFileName2BGreen_CG</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="log_8c.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#a95586278e0e76764e6307174e5d6b3f4">cCGExpecTwoBodyGStart</a>,<span class="stringliteral">&quot;a&quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      fprintf(<a class="code" href="global_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_log_message_8c.html#a0be8c630a1808dc9ca208626c64ba9c4">cLogLanczosExpecTwoBodyGStart</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">case</span> TPQCalc:</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    step=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#abe80758171b3ffeca7b5fa790e5ede22">istep</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    rand_i=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#af1a607bc77f32d6efe6a799ee78a9456">irand</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="log_8c.html#aa7daf8ff6a1c61ea795f4096043f1c19">TimeKeeperWithRandAndStep</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#acf90179a5d51508dd9973c8389f4aed2">cTPQExpecTwoBodyGStart</a>, <span class="stringliteral">&quot;a&quot;</span>, rand_i, step);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    sprintf(sdt, <a class="code" href="global_8c.html#a88f940c2e673ea0ac2352249e76f5201">cFileName2BGreen_TPQ</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>, rand_i, step);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">case</span> TimeEvolution:</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    step=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#abe80758171b3ffeca7b5fa790e5ede22">istep</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="log_8c.html#a07deb00043cb31a691ff307cc8ae0552">TimeKeeperWithStep</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#ae7b9876edcd7fb89a7dae61a1e853a9a">cTEExpecTwoBodyGStart</a>, <span class="stringliteral">&quot;a&quot;</span>, step);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    sprintf(sdt, <a class="code" href="global_8c.html#a233d7c672baf88d830d6ddd086f0ebaa">cFileName2BGreen_TE</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>, step);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">case</span> FullDiag:</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">case</span> CG:</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    sprintf(sdt, <a class="code" href="global_8c.html#af97aa29cc5e6f180b89596e6c91a3ffc">cFileName2BGreen_FullDiag</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a4779085fc0aeb372e1b3f3b0a20dee5d">Phys</a>.<a class="code" href="struct_phys_list.html#a5616dcf1777ecef24f4883835541a375">eigen_num</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="_file_i_o_8c.html#a7d23a0790b28a52d128e0b93bc832cfb">childfopenMPI</a>(sdt, <span class="stringliteral">&quot;w&quot;</span>, &amp;fp)!=0){</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">switch</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">iCalcModel</a>){</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">case</span> HubbardGC:</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0">expec_cisajscktalt_HubbardGC</a>(X, vec, &amp;fp)!=0){</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">case</span> KondoGC:</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">case</span> Hubbard:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">case</span> Kondo:</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15">expec_cisajscktalt_Hubbard</a>(X, vec, &amp;fp)!=0){</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">case</span> Spin:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a918ce8a912fe44cd3f9e49f6b8ca0581">expec_cisajscktalt_Spin</a>(X, vec, &amp;fp)!=0){</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">case</span> SpinGC:</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#ad468e5109f6dc215394c103675b503fb">expec_cisajscktalt_SpinGC</a>(X, vec, &amp;fp)!=0){</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  fclose(fp);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>==Lanczos){</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==0){</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="log_8c.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#ad0f20fbe58825d5d2ffe1414937e6386">cLanczosExpecTwoBodyGFinish</a>,<span class="stringliteral">&quot;a&quot;</span>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      fprintf(<a class="code" href="global_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_log_message_8c.html#ad55b0f4978dc9f09cbc491ab0d76c78f">cLogLanczosExpecTwoBodyGFinish</a>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==1){</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="log_8c.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#a7519659e9f2c455440ff713b688cc682">cCGExpecTwoBodyGFinish</a>,<span class="stringliteral">&quot;a&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      fprintf(<a class="code" href="global_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_log_message_8c.html#af9e20cd063f9fc302818c9bd15eff059">cLogCGExpecTwoBodyGFinish</a>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>==TPQCalc){</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="log_8c.html#aa7daf8ff6a1c61ea795f4096043f1c19">TimeKeeperWithRandAndStep</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#a9fbb46cf5afeb53c4d1879ed2cb2123a">cTPQExpecTwoBodyGFinish</a>, <span class="stringliteral">&quot;a&quot;</span>, rand_i, step);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>==TimeEvolution){</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="log_8c.html#a07deb00043cb31a691ff307cc8ae0552">TimeKeeperWithStep</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8c.html#a6fe499b1cbded3afdd638d1c98f26a4b">cTEExpecTwoBodyGFinish</a>, <span class="stringliteral">&quot;a&quot;</span>, step);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">//[s] this part will be added</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">/* For FullDiag, it is convinient to calculate the total spin for each vector.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">     Such functions will be added </span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">     if(X-&gt;Def.iCalcType==FullDiag){</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">     if(X-&gt;Def.iCalcModel==Spin){</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">     expec_cisajscktaltdc_alldiag_spin(X,vec);</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">     }else if(X-&gt;Def.iCalcModel==Hubbard || X-&gt;Def.iCalcModel==Kondo){</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">     expec_cisajscktaltdc_alldiag(X,vec);</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">     }else{// </span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">     X-&gt;Phys.s2=0.0;   </span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">     }</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">     }</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">//[e]</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">  223</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a>(</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                         <span class="keywordtype">int</span> i,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite1,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite2,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite3,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_isite4,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma1,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma2,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma3,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                         <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *org_sigma4,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                         <span class="keywordtype">double</span> complex *tmp_V,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                         )</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_isite1,tmp_org_isite2,tmp_org_isite3,tmp_org_isite4;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_sigma1,tmp_org_sigma2,tmp_org_sigma3,tmp_org_sigma4;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  tmp_org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  tmp_org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  tmp_org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  tmp_org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  tmp_org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  tmp_org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  tmp_org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  tmp_org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">if</span>(tmp_org_isite1==tmp_org_isite2 &amp;&amp; tmp_org_isite3==tmp_org_isite4){</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span>(tmp_org_isite1 &gt; tmp_org_isite3){</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      *org_isite1   = tmp_org_isite3;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      *org_sigma1   = tmp_org_sigma3;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      *org_isite2   = tmp_org_isite4;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      *org_sigma2   = tmp_org_sigma4;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      *org_isite3   = tmp_org_isite1;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      *org_sigma3   = tmp_org_sigma1;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      *org_isite4   = tmp_org_isite2;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      *org_sigma4   = tmp_org_sigma2;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      *org_isite1   = tmp_org_isite1;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      *org_sigma1   = tmp_org_sigma1;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      *org_isite2   = tmp_org_isite2;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      *org_sigma2   = tmp_org_sigma2;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      *org_isite3   = tmp_org_isite3;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      *org_sigma3   = tmp_org_sigma3;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      *org_isite4   = tmp_org_isite4;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      *org_sigma4   = tmp_org_sigma4;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    *tmp_V = 1.0;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp_org_isite1==tmp_org_isite4 &amp;&amp; tmp_org_isite3==tmp_org_isite2){</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span>(tmp_org_isite1 &gt; tmp_org_isite3){</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      *org_isite1   = tmp_org_isite3;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      *org_sigma1   = tmp_org_sigma3;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      *org_isite2   = tmp_org_isite2;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      *org_sigma2   = tmp_org_sigma2;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      *org_isite3   = tmp_org_isite1;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      *org_sigma3   = tmp_org_sigma1;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      *org_isite4   = tmp_org_isite4;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      *org_sigma4   = tmp_org_sigma4;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      *org_isite1   = tmp_org_isite1;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      *org_sigma1   = tmp_org_sigma1;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      *org_isite2   = tmp_org_isite4;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      *org_sigma2   = tmp_org_sigma4;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      *org_isite3   = tmp_org_isite3;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      *org_sigma3   = tmp_org_sigma3;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      *org_isite4   = tmp_org_isite2;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      *org_sigma4   = tmp_org_sigma2;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    *tmp_V =-1.0;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0">  312</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0">expec_cisajscktalt_HubbardGC</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,isite2,isite3,isite4;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma1,org_sigma2,org_sigma3,org_sigma4;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,Bsum,Adiff,Bdiff;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2=0;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">double</span> complex tmp_V= 1.0+0.0*I;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    ;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a>;i++){</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        dam_pr=0.0;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite1-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite2-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> ||</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;           <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite3-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite4-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite1-2+org_sigma1] ;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite2-2+org_sigma2] ;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite3-2+org_sigma3] ;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite4-2+org_sigma4] ;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a571209928d6c7125abd413555f89d748">X_GC_child_CisAisCjtAjt_Hubbard_MPI</a>(org_isite1-1, org_sigma1,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                             org_isite3-1, org_sigma3,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                             1.0, X, vec, vec);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60">X_GC_child_CisAisCjtAku_Hubbard_MPI</a>(org_isite1-1, org_sigma1,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                                             org_isite3-1, org_sigma3, org_isite4-1, org_sigma4,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                                             1.0, X, vec, vec);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866">X_GC_child_CisAjtCkuAku_Hubbard_MPI</a>(org_isite1-1, org_sigma1, org_isite2-1, org_sigma2,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                                             org_isite3-1, org_sigma3,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                                             1.0, X, vec, vec);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a>(org_isite1-1, org_sigma1, org_isite2-1, org_sigma2,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                                             org_isite3-1, org_sigma3, org_isite4-1, org_sigma4,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                                             1.0, X, vec, vec);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        }<span class="comment">//InterPE</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    (i, X, org_isite1, org_isite2, org_isite3, org_isite4,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                     org_sigma1, org_sigma2, org_sigma3, org_sigma4, tmp_V</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    );</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            i_max  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            Asum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            Adiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            Bsum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            Bdiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    dam_pr +=<a class="code" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    dam_pr +=<a class="code" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a>(j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, vec, vec, X, &amp;tmp_off_2);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        dam_pr = <a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }<span class="comment">//Intra PE</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15">  430</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15">expec_cisajscktalt_Hubbard</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,isite2,isite3,isite4;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma1,org_sigma2,org_sigma3,org_sigma4;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,Bsum,Adiff,Bdiff;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2=0;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a>;i++){</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        tmp_V    = 1.0;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        dam_pr=0.0;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cbe288a2c6217a4cd148fbea2226c3a">iFlgSzConserved</a> ==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">if</span>(org_sigma1+org_sigma3 != org_sigma2+org_sigma4){</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                dam_pr=<a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1, org_sigma1, org_isite2-1, org_sigma2, org_isite3-1, org_sigma3, org_isite4-1, org_sigma4, creal(dam_pr), cimag(dam_pr));</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite1-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite2-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> ||</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;           <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite3-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(org_isite4-1, X)==<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite1-2+org_sigma1] ;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite2-2+org_sigma2] ;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite3-2+org_sigma3] ;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*org_isite4-2+org_sigma4] ;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#ac0c99cbb8b6107f22d5f98dda7c261c1">X_child_CisAisCjtAjt_Hubbard_MPI</a>(org_isite1-1, org_sigma1,</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                                          org_isite3-1, org_sigma3,</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                                          1.0, X, vec, vec);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;              <span class="comment">//printf(&quot;org_isite1=%d, org_isite2=%d, org_isite3=%d, org_isite4=%d\n&quot;, org_isite1, org_isite2, org_isite3, org_isite4);</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431">X_child_CisAisCjtAku_Hubbard_MPI</a>(org_isite1-1, org_sigma1,</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                                          org_isite3-1, org_sigma3, org_isite4-1, org_sigma4,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                                          1.0, X, vec, vec);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736">X_child_CisAjtCkuAku_Hubbard_MPI</a>(org_isite1-1, org_sigma1, org_isite2-1, org_sigma2,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                                          org_isite3-1, org_sigma3,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                                          1.0, X, vec, vec);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;              dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327">X_child_CisAjtCkuAlv_Hubbard_MPI</a>(org_isite1-1, org_sigma1, org_isite2-1, org_sigma2,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                          org_isite3-1, org_sigma3, org_isite4-1, org_sigma4,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                                          1.0, X, vec, vec);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        }<span class="comment">//InterPE</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <a class="code" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a>(</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    i, X, org_isite1, org_isite2, org_isite3, org_isite4,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    org_sigma1, org_sigma2, org_sigma3, org_sigma4, tmp_V</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            );</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            i_max  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            Asum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            Adiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            Bsum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            Bdiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            tmp_V  = 1.0;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            dam_pr = 0.0;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    dam_pr +=<a class="code" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    dam_pr +=<a class="code" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a>(j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, vec, vec, X, &amp;tmp_off_2);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        dam_pr = <a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a918ce8a912fe44cd3f9e49f6b8ca0581">  551</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a918ce8a912fe44cd3f9e49f6b8ca0581">expec_cisajscktalt_Spin</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">int</span> info=0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a854332d8078d94fd71f022a8a85fe972">iFlgGeneralSpin</a> == <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        info=<a class="code" href="expec__cisajscktaltdc_8c.html#a915879a823599f9fa3b0cb041c5de568">expec_cisajscktalt_SpinHalf</a>(X,vec, _fp);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        info=<a class="code" href="expec__cisajscktaltdc_8c.html#a0b7abd184f6ccce7ac4141c21fabf91c">expec_cisajscktalt_SpinGeneral</a>(X,vec, _fp);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">return</span> info;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a915879a823599f9fa3b0cb041c5de568">  571</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a915879a823599f9fa3b0cb041c5de568">expec_cisajscktalt_SpinHalf</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma1,org_sigma2,org_sigma3,org_sigma4;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_isite1,tmp_org_isite2,tmp_org_isite3,tmp_org_isite4;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_sigma1,tmp_org_sigma2,tmp_org_sigma3,tmp_org_sigma4;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isA_up, isB_up;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up, is2_up;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">int</span> tmp_sgn, num1, num2;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>=M_CORR;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a>;i++){</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        tmp_org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        tmp_org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        tmp_org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        tmp_org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        tmp_org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        tmp_org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        tmp_org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        tmp_org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a>(i, &amp;org_isite1, &amp;org_isite2, &amp;org_isite3, &amp;org_isite4, &amp;org_sigma1, &amp;org_sigma2, &amp;org_sigma3, &amp;org_sigma4, &amp;tmp_V, X)!=0){</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="comment">//error message will be added</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1,tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,0.0,0.0);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        dam_pr = 0.0;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span>(org_isite1 &gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> &amp;&amp; org_isite3&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite1 - 1];</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite3 - 1];</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                num1 = <a class="code" href="mltply_spin_core_8c.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a> + 1, X, is1_up, org_sigma1);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                num2 = <a class="code" href="mltply_spin_core_8c.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a> + 1, X, is2_up, org_sigma3);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction (+:dam_pr) shared(vec) \</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">  firstprivate(i_max, num1, num2, tmp_V) private(j)</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    dam_pr += tmp_V*num1*num2*vec[j]*conj(vec[j]);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite1==org_isite3 &amp;&amp; org_sigma1==org_sigma4 &amp;&amp; org_sigma2==org_sigma3){</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite1 - 1];</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                num1 = <a class="code" href="mltply_spin_core_8c.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a> + 1, X, is1_up, org_sigma1);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction (+:dam_pr) shared(vec) \</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">  firstprivate(i_max, num1, num2, tmp_V) private(j)</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    dam_pr += tmp_V*num1*vec[j]*conj(vec[j]);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1==org_sigma4 &amp;&amp; org_sigma2==org_sigma3){<span class="comment">//exchange</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_8c.html#a4e5f05080675ce78c92496afca5e5965">X_child_general_int_spin_MPIdouble</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordflow">else</span>{  <span class="comment">// other process is not allowed</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="comment">// error message will be added</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> || org_isite3&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite1 - 1];</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite3 - 1];</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                num2 = <a class="code" href="mltply_spin_core_8c.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a> + 1, X, is2_up, org_sigma3);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                dam_pr=0.0;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr)shared(vec) \</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">  firstprivate(i_max, tmp_V, is1_up, org_sigma1, X, num2) private(j, num1)</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    num1 = <a class="code" href="mltply_spin_core_8c.html#a93558eb8cb0c4df2ce01e0611b771f66">X_Spin_CisAis</a>(j, X, is1_up, org_sigma1);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    dam_pr += tmp_V*num1*num2*conj(vec[j])*vec[j];</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1==org_sigma4 &amp;&amp; org_sigma2==org_sigma3){<span class="comment">//exchange</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_8c.html#abdfa931ba0482cdf3c19181478055d02">X_child_general_int_spin_MPIsingle</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">else</span>{  <span class="comment">// other process is not allowed</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="comment">// error message will be added</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                dam_pr=0.0;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite1-1];</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite3-1];</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off, tmp_V) shared(vec)</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    dam_pr +=<a class="code" href="mltply_spin_core_8c.html#a9f7fc788e6ba0b42f84e2c5a4d187f4a">child_CisAisCisAis_spin_element</a>(j, isA_up, isB_up, org_sigma2, org_sigma4, tmp_V, vec, vec, X);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite1==org_isite3 &amp;&amp; org_sigma1==org_sigma4 &amp;&amp; org_sigma3==org_sigma2){</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, dmv) firstprivate(i_max,X,isA_up,org_sigma1, tmp_V) shared(vec, list_1)</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    dmv = <a class="code" href="mltply_spin_core_8c.html#a93558eb8cb0c4df2ce01e0611b771f66">X_Spin_CisAis</a>(j, X, isA_up, org_sigma1);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    dam_pr += vec[j]*tmp_V*dmv*conj(vec[j]);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1==org_sigma4 &amp;&amp; org_sigma2==org_sigma3){ <span class="comment">// exchange</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                dam_pr = 0.0;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_V) shared(vec)</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    tmp_sgn    =  <a class="code" href="mltply_spin_core_8c.html#a775bcc202a5a6f57d64ce9fcf8212bdb">X_child_exchange_spin_element</a>(j,X,isA_up,isB_up,org_sigma2,org_sigma4,&amp;tmp_off);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    dmv        = vec[j]*tmp_sgn;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    dam_pr    += conj(vec[tmp_off])*dmv;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            }<span class="keywordflow">else</span>{  <span class="comment">// other process is not allowed</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <span class="comment">// error message will be added</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                dam_pr=0.0;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        dam_pr = <a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1, tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,creal(dam_pr),cimag(dam_pr));</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a0b7abd184f6ccce7ac4141c21fabf91c">  703</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a0b7abd184f6ccce7ac4141c21fabf91c">expec_cisajscktalt_SpinGeneral</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma1,org_sigma2,org_sigma3,org_sigma4;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_isite1,tmp_org_isite2,tmp_org_isite3,tmp_org_isite4;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_sigma1,tmp_org_sigma2,tmp_org_sigma3,tmp_org_sigma4;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2=0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list1_off=0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">int</span> num1;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordtype">int</span> tmp_Sz;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org=0;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    vec[0]=0;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>=M_CORR;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a>;i++){</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        tmp_org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        tmp_org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        tmp_org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        tmp_org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        tmp_org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        tmp_org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        tmp_org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        tmp_org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a>(i, &amp;org_isite1, &amp;org_isite2, &amp;org_isite3, &amp;org_isite4, &amp;org_sigma1, &amp;org_sigma2, &amp;org_sigma3, &amp;org_sigma4, &amp;tmp_V, X)!=0){</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1,tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,0.0,0.0);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        tmp_Sz=0;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keywordflow">for</span>(j=0;j&lt;2; j++) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        tmp_org = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4*j+1]*X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4 * j]];</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        tmp_Sz += <a class="code" href="bitcalc_8c.html#af5a13bcff4925b10b27ecba6079fbb5a">GetLocal2Sz</a>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4 * j] + 1, tmp_org, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        tmp_org = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4*j+3]*X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4 * j+2]];</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        tmp_Sz -= <a class="code" href="bitcalc_8c.html#af5a13bcff4925b10b27ecba6079fbb5a">GetLocal2Sz</a>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4 * j+2] + 1, tmp_org, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">if</span>(tmp_Sz !=0){ <span class="comment">// not Sz conserved</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1,tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,0.0,0.0);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        dam_pr = 0.0;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keywordflow">if</span>(org_isite1 &gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> &amp;&amp; org_isite3&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#a76cf91a2d8317a9349bc362f1aea33f7">X_child_CisAisCjuAju_GeneralSpin_MPIdouble</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#ae8b5eaea3b894110484f2214d7566ecf">X_child_CisAitCjuAjv_GeneralSpin_MPIdouble</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4,tmp_V, X, vec, vec);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordflow">else</span>{</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                dam_pr=0.0;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite3 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> || org_isite1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#a79408eeba2cc4efd8ae0267d3ea351df">X_child_CisAisCjuAju_GeneralSpin_MPIsingle</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#ac43adc132f4ddcfef02f936ba1d9784a">X_child_CisAitCjuAjv_GeneralSpin_MPIsingle</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4,tmp_V, X, vec, vec);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">else</span>{</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                dam_pr=0.0;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, num1) firstprivate(i_max,X,org_isite1, org_sigma1,org_isite3, org_sigma3, tmp_V) shared(vec,list_1)</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    num1=<a class="code" href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], org_isite1, org_sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                        num1=<a class="code" href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], org_isite3, org_sigma3, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                        <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                            dam_pr += tmp_V*conj(vec[j])*vec[j];</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, num1) firstprivate(i_max,X, org_isite1, org_isite3, org_sigma1, org_sigma2, org_sigma3, org_sigma4, tmp_off, tmp_off_2, list1_off, myrank, tmp_V) shared(vec, list_1)</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                  num1 = <a class="code" href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], org_isite3, org_sigma4, org_sigma3, &amp;tmp_off, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                  <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    num1 = <a class="code" href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a>(tmp_off, org_isite1, org_sigma2, org_sigma1, &amp;tmp_off_2,</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                                 X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                    <span class="keywordflow">if</span> (num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                      <a class="code" href="bitcalc_8c.html#a3713f8b19de9694c630c5ca182933b5f">ConvertToList1GeneralSpin</a>(tmp_off_2, X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a617d47f691e1ea504faabb55c45cb183">sdim</a>, &amp;list1_off);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                      dam_pr += tmp_V * conj(vec[list1_off]) * vec[j];</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                  }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;              <span class="comment">//printf(&quot;DEBUG: rank=%d, dam_pr=%lf\n&quot;, myrank, creal(dam_pr));</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">else</span>{</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                dam_pr=0.0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        dam_pr = <a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1, tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4, creal(dam_pr),cimag(dam_pr));</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#ad468e5109f6dc215394c103675b503fb">  820</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#ad468e5109f6dc215394c103675b503fb">expec_cisajscktalt_SpinGC</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordtype">int</span> info=0;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a854332d8078d94fd71f022a8a85fe972">iFlgGeneralSpin</a> == <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        info=<a class="code" href="expec__cisajscktaltdc_8c.html#a2e87402ae7a6aeb5e826cd33cdf3ab57">expec_cisajscktalt_SpinGCHalf</a>(X,vec, _fp);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        info=<a class="code" href="expec__cisajscktaltdc_8c.html#ad2872d8b3f1c758d3933dc9e2b19dd16">expec_cisajscktalt_SpinGCGeneral</a>(X,vec, _fp);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> info;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#a2e87402ae7a6aeb5e826cd33cdf3ab57">  840</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#a2e87402ae7a6aeb5e826cd33cdf3ab57">expec_cisajscktalt_SpinGCHalf</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma1,org_sigma2,org_sigma3,org_sigma4;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_isite1,tmp_org_isite2,tmp_org_isite3,tmp_org_isite4;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_sigma1,tmp_org_sigma2,tmp_org_sigma3,tmp_org_sigma4;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isA_up, isB_up;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a>;i++){</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        tmp_org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        tmp_org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        tmp_org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        tmp_org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        tmp_org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        tmp_org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        tmp_org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        tmp_org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a>(i, &amp;org_isite1, &amp;org_isite2, &amp;org_isite3, &amp;org_isite4, &amp;org_sigma1, &amp;org_sigma2, &amp;org_sigma3, &amp;org_sigma4, &amp;tmp_V, X)!=0){</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="comment">//error message will be added</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1,tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,0.0,0.0);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        dam_pr=0.0;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">if</span>(org_isite1&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> &amp;&amp; org_isite3&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){ <span class="comment">//org_isite3 &gt;= org_isite1 &gt; Nsite</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#ab23a10d5019fb27103c4726eadb32179">X_GC_child_CisAisCjuAju_spin_MPIdouble</a>( (org_isite1-1), org_sigma1, (org_isite3-1), org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite1 ==org_isite3 &amp;&amp; org_sigma1 ==org_sigma4 &amp;&amp; org_sigma2 ==org_sigma3){ <span class="comment">//diagonal (for spin: cuadcdau=cuau)</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#a7296cf9063676fa3097f40e89d6c9418">X_GC_child_CisAis_spin_MPIdouble</a>((org_isite1-1), org_sigma1, tmp_V, X, vec, vec);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#a75a9365a3be44e0de5e5850658c92109">X_GC_child_CisAisCjuAjv_spin_MPIdouble</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#a8c2107762d44860950b1deb3a1f0ce60">X_GC_child_CisAitCjuAju_spin_MPIdouble</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                dam_pr +=  <a class="code" href="mltply_m_p_i_spin_core_8c.html#a340591f9ad97da382724029398a333d6">X_GC_child_CisAitCiuAiv_spin_MPIdouble</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite3&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> || org_isite1&gt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){ <span class="comment">//org_isite3 &gt; Nsite &gt;= org_isite1</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#a29c17404e94c3971bee0cc0a9de81533">X_GC_child_CisAisCjuAju_spin_MPIsingle</a>( (org_isite1-1), org_sigma1, (org_isite3-1), org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#a2ad42e0120a7dac9479597ea42c8f55a">X_GC_child_CisAisCjuAjv_spin_MPIsingle</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                dam_pr += <a class="code" href="mltply_m_p_i_spin_core_8c.html#accf48effad335c4471e4522e86371e64">X_GC_child_CisAitCjuAju_spin_MPIsingle</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                dam_pr +=  <a class="code" href="mltply_m_p_i_spin_core_8c.html#a9f761747b03d3dc6a20f73377f7226d4">X_GC_child_CisAitCiuAiv_spin_MPIsingle</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keywordflow">if</span>(org_isite1==org_isite2 &amp;&amp; org_isite3==org_isite4){</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite2-1];</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[org_isite4-1];</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    dam_pr = 0.0;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_V) shared(vec)</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        dam_pr +=<a class="code" href="mltply_spin_core_8c.html#aa25730bebedaef0567be1d1d3a2aa9f7">GC_child_CisAisCisAis_spin_element</a>(j, isA_up, isB_up, org_sigma2, org_sigma4, tmp_V, vec, vec, X);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    dam_pr = 0.0;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_V) shared(vec)</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        dam_pr += <a class="code" href="mltply_spin_core_8c.html#af675fc77ae3b652589d52ff3fa667b77">GC_child_CisAisCitAiu_spin_element</a>(j, org_sigma2, org_sigma4, isA_up, isB_up, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                    }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    dam_pr = 0.0;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_V) shared(vec)</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                        dam_pr += <a class="code" href="mltply_spin_core_8c.html#a220085102d48735b8111fe704e5d5993">GC_child_CisAitCiuAiu_spin_element</a>(j, org_sigma2, org_sigma4, isA_up, isB_up, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                    }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    dam_pr = 0.0;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_V) shared(vec)</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                        dam_pr += <a class="code" href="mltply_spin_core_8c.html#a1b6c6239f632e04606cf340f024d2ed3">GC_child_CisAitCiuAiv_spin_element</a>(j, org_sigma2, org_sigma4, isA_up, isB_up, tmp_V, vec, vec, X, &amp;tmp_off);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        dam_pr = <a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1, tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,creal(dam_pr),cimag(dam_pr));</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;}</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno"><a class="line" href="expec__cisajscktaltdc_8c.html#ad2872d8b3f1c758d3933dc9e2b19dd16">  951</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="expec__cisajscktaltdc_8c.html#ad2872d8b3f1c758d3933dc9e2b19dd16">expec_cisajscktalt_SpinGCGeneral</a>(<span class="keyword">struct</span> <a class="code" href="struct_bind_struct.html">BindStruct</a> *X,<span class="keywordtype">double</span> complex *vec, FILE **_fp){</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma1,org_sigma2,org_sigma3,org_sigma4;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_isite1,tmp_org_isite2,tmp_org_isite3,tmp_org_isite4;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_org_sigma1,tmp_org_sigma2,tmp_org_sigma3,tmp_org_sigma4;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2=0;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordtype">int</span>  num1;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>=M_CORR;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">NCisAjtCkuAlvDC</a>;i++){</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        tmp_org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        tmp_org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        tmp_org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        tmp_org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        tmp_org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        tmp_org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        tmp_org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        tmp_org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        dam_pr = 0.0;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a>(i, &amp;org_isite1, &amp;org_isite2, &amp;org_isite3, &amp;org_isite4, &amp;org_sigma1, &amp;org_sigma2, &amp;org_sigma3, &amp;org_sigma4, &amp;tmp_V, X)!=0){</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;          <span class="comment">//error message will be added</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1,tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4,0.0,0.0);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">if</span>(org_isite1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> &amp;&amp; org_isite3 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#a0f1394dd9dcb5a334f15676d511313b1">X_GC_child_CisAisCjuAju_GeneralSpin_MPIdouble</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#aa75f5ecbbed7438beb33b32592223feb">X_GC_child_CisAisCjuAjv_GeneralSpin_MPIdouble</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#ae2ee1ba3e3c5795a2d80f8bcc0d89732">X_GC_child_CisAitCjuAju_GeneralSpin_MPIdouble</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#a15226d2f776230cec607303d8024f4b1">X_GC_child_CisAitCjuAjv_GeneralSpin_MPIdouble</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4,tmp_V, X, vec, vec);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite3 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> || org_isite1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#ace468131cb9d905d4beaec29719db0b2">X_GC_child_CisAisCjuAju_GeneralSpin_MPIsingle</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#ab674c454b9c1ae861483c53f32c78919">X_GC_child_CisAisCjuAjv_GeneralSpin_MPIsingle</a>(org_isite1-1, org_sigma1, org_isite3-1, org_sigma3, org_sigma4, tmp_V, X, vec, vec);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#a6e7184b965a03e38d608d900c78708c1">X_GC_child_CisAitCjuAju_GeneralSpin_MPIsingle</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, tmp_V, X, vec, vec);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                dam_pr=<a class="code" href="mltply_m_p_i_spin_core_8c.html#a1f383088ec5f7c8f441c6c389b5c187d">X_GC_child_CisAitCjuAjv_GeneralSpin_MPIsingle</a>(org_isite1-1, org_sigma1, org_sigma2, org_isite3-1, org_sigma3, org_sigma4,tmp_V, X, vec, vec);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            }</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, num1) firstprivate(i_max,X,org_isite1, org_sigma1,org_isite3, org_sigma3, tmp_V) shared(vec)</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    num1=<a class="code" href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a>(j-1, org_isite1, org_sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                        num1=<a class="code" href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a>(j-1, org_isite3, org_sigma3, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                        <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                            dam_pr += tmp_V*conj(vec[j])*vec[j];</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                    }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, num1) firstprivate(i_max,X, org_isite1, org_isite3, org_sigma1,org_sigma3,org_sigma4, tmp_off, tmp_V) shared(vec)</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                    num1 = <a class="code" href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a>(j-1, org_isite3, org_sigma4, org_sigma3, &amp;tmp_off, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                        num1=<a class="code" href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a>(tmp_off, org_isite1, org_sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                            dam_pr += tmp_V*conj(vec[tmp_off+1])*vec[j];</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                        }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                    }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, num1) firstprivate(i_max,X, org_isite1, org_isite3, org_sigma1,org_sigma2, org_sigma3, tmp_off, tmp_V) shared(vec)</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    num1 = <a class="code" href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a>(j-1, org_isite3, org_sigma3, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                        num1 = <a class="code" href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a>(j-1, org_isite1, org_sigma2, org_sigma1, &amp;tmp_off, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                        <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                            dam_pr +=  tmp_V*conj(vec[tmp_off+1])*vec[j];</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        }</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, num1) firstprivate(i_max,X, org_isite1, org_isite3, org_sigma1, org_sigma2, org_sigma3, org_sigma4, tmp_off, tmp_off_2, tmp_V) shared(vec)</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    num1 = <a class="code" href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a>(j-1, org_isite3, org_sigma4, org_sigma3, &amp;tmp_off, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        num1 = <a class="code" href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a>(tmp_off, org_isite1, org_sigma2, org_sigma1, &amp;tmp_off_2, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">SiteToBit</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        <span class="keywordflow">if</span>(num1 != <a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                            dam_pr +=  tmp_V*conj(vec[tmp_off_2+1])*vec[j];</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                }</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        dam_pr = <a class="code" href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a>(dam_pr);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        fprintf(*_fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,tmp_org_isite1-1, tmp_org_sigma1, tmp_org_isite2-1, tmp_org_sigma2, tmp_org_isite3-1, tmp_org_sigma3, tmp_org_isite4-1, tmp_org_sigma4, creal(dam_pr),cimag(dam_pr));</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;}</div><div class="ttc" id="struct_define_list_html_af1a607bc77f32d6efe6a799ee78a9456"><div class="ttname"><a href="struct_define_list.html#af1a607bc77f32d6efe6a799ee78a9456">DefineList::irand</a></div><div class="ttdeci">int irand</div><div class="ttdoc">Input keyword TargetTPQRand ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00079">struct.h:79</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00410">struct.h:410</a></div></div>
<div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00342">struct.h:342</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_ab1e0307962ebf631818025cd262c4bd9"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9">expec_cisajscktaltdc</a></div><div class="ttdeci">int expec_cisajscktaltdc(struct BindStruct *X, double complex *vec)</div><div class="ttdoc">Parent function to calculate two-body green&amp;#39;s functions. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00085">expec_cisajscktaltdc.c:85</a></div></div>
<div class="ttc" id="struct_define_list_html_a1ff331495c1f203f90e497c95b835619"><div class="ttname"><a href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">DefineList::St</a></div><div class="ttdeci">int St</div><div class="ttdoc">0 or 1, but it affects nothing. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00080">struct.h:80</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_ac43adc132f4ddcfef02f936ba1d9784a"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#ac43adc132f4ddcfef02f936ba1d9784a">X_child_CisAitCjuAjv_GeneralSpin_MPIsingle</a></div><div class="ttdeci">double complex X_child_CisAitCjuAjv_GeneralSpin_MPIsingle(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the canonical general spin system when one of these sites is in the inter process re...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01873">mltplyMPISpinCore.c:1873</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_ab23a10d5019fb27103c4726eadb32179"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#ab23a10d5019fb27103c4726eadb32179">X_GC_child_CisAisCjuAju_spin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAju_spin_MPIdouble(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">CisAisCjuAjv term in Spin model + GC When both site1 and site2 are in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00397">mltplyMPISpinCore.c:397</a></div></div>
<div class="ttc" id="_log_message_8c_html_a0be8c630a1808dc9ca208626c64ba9c4"><div class="ttname"><a href="_log_message_8c.html#a0be8c630a1808dc9ca208626c64ba9c4">cLogLanczosExpecTwoBodyGStart</a></div><div class="ttdeci">const char * cLogLanczosExpecTwoBodyGStart</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00124">LogMessage.c:124</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a1f383088ec5f7c8f441c6c389b5c187d"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a1f383088ec5f7c8f441c6c389b5c187d">X_GC_child_CisAitCjuAjv_GeneralSpin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAitCjuAjv_GeneralSpin_MPIsingle(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the grandcanonical general spin system when one of these site is in the inter proces...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01514">mltplyMPISpinCore.c:1514</a></div></div>
<div class="ttc" id="struct_define_list_html_a2cbe288a2c6217a4cd148fbea2226c3a"><div class="ttname"><a href="struct_define_list.html#a2cbe288a2c6217a4cd148fbea2226c3a">DefineList::iFlgSzConserved</a></div><div class="ttdeci">int iFlgSzConserved</div><div class="ttdoc">Flag whether Sz is conserved. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00087">struct.h:87</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_aa75f5ecbbed7438beb33b32592223feb"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#aa75f5ecbbed7438beb33b32592223feb">X_GC_child_CisAisCjuAjv_GeneralSpin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAjv_GeneralSpin_MPIdouble(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc"> term in Spin model. When both site1 and site3 are in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00826">mltplyMPISpinCore.c:826</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a14e2a1172cc6ad1cfd4a23c33a63b761"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a></div><div class="ttdeci">int CheckPE(int org_isite, struct BindStruct *X)</div><div class="ttdoc">Check whether this site is in the inter process region or not. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00033">mltplyMPIHubbardCore.c:33</a></div></div>
<div class="ttc" id="wrapper_m_p_i_8c_html_a7a90e7c667189b600a621be9856fa650"><div class="ttname"><a href="wrapper_m_p_i_8c.html#a7a90e7c667189b600a621be9856fa650">SumMPI_dc</a></div><div class="ttdeci">double complex SumMPI_dc(double complex norm)</div><div class="ttdoc">MPI wrapper function to obtain sum of Double complex across processes. </div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8c_source.html#l00205">wrapperMPI.c:205</a></div></div>
<div class="ttc" id="struct_check_list_html_a5d8a1e6a9e9064ae7dab52310d2cce11"><div class="ttname"><a href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">CheckList::idim_max</a></div><div class="ttdeci">unsigned long int idim_max</div><div class="ttdoc">The dimension of the Hilbert space of this process. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00303">struct.h:303</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a7296cf9063676fa3097f40e89d6c9418"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a7296cf9063676fa3097f40e89d6c9418">X_GC_child_CisAis_spin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAis_spin_MPIdouble(int org_isite1, int org_ispin1, double complex tmp_trans, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Hopping term in Spin + GC When both site1 and site2 are in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l02122">mltplyMPISpinCore.c:2122</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_a220085102d48735b8111fe704e5d5993"><div class="ttname"><a href="mltply_spin_core_8c.html#a220085102d48735b8111fe704e5d5993">GC_child_CisAitCiuAiu_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAitCiuAiu_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical spsin system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00494">mltplySpinCore.c:494</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_af675fc77ae3b652589d52ff3fa667b77"><div class="ttname"><a href="mltply_spin_core_8c.html#af675fc77ae3b652589d52ff3fa667b77">GC_child_CisAisCitAiu_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAisCitAiu_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical spsin system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00459">mltplySpinCore.c:459</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00335">struct.h:335</a></div></div>
<div class="ttc" id="_log_message_8c_html_a9fbb46cf5afeb53c4d1879ed2cb2123a"><div class="ttname"><a href="_log_message_8c.html#a9fbb46cf5afeb53c4d1879ed2cb2123a">cTPQExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cTPQExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00132">LogMessage.c:132</a></div></div>
<div class="ttc" id="_log_message_8c_html_a6fe499b1cbded3afdd638d1c98f26a4b"><div class="ttname"><a href="_log_message_8c.html#a6fe499b1cbded3afdd638d1c98f26a4b">cTEExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cTEExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00134">LogMessage.c:134</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_a775bcc202a5a6f57d64ce9fcf8212bdb"><div class="ttname"><a href="mltply_spin_core_8c.html#a775bcc202a5a6f57d64ce9fcf8212bdb">X_child_exchange_spin_element</a></div><div class="ttdeci">int X_child_exchange_spin_element(long unsigned int j, struct BindStruct *X, long unsigned int isA_up, long unsigned int isB_up, long unsigned int sigmaA, long unsigned int sigmaB, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of final wavefunction associated to spin-exchange term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00239">mltplySpinCore.c:239</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a6e7184b965a03e38d608d900c78708c1"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a6e7184b965a03e38d608d900c78708c1">X_GC_child_CisAitCjuAju_GeneralSpin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAitCjuAju_GeneralSpin_MPIsingle(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the grandcanonical general spin system when one of these site is in the inter proces...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01441">mltplyMPISpinCore.c:1441</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a9f761747b03d3dc6a20f73377f7226d4"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a9f761747b03d3dc6a20f73377f7226d4">X_GC_child_CisAitCiuAiv_spin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAitCiuAiv_spin_MPIsingle(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Exchange and Pairlifting term in Spin model + GC When only site2 is in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00522">mltplyMPISpinCore.c:522</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00347">struct.h:347</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a913be849115ac81f093256931b45bba2"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a></div><div class="ttdeci">int child_general_int_GetInfo(int iInterAll, struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdoc">Compute mask for bit operation of general interaction term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00076">mltplyHubbardCore.c:76</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a79408eeba2cc4efd8ae0267d3ea351df"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a79408eeba2cc4efd8ae0267d3ea351df">X_child_CisAisCjuAju_GeneralSpin_MPIsingle</a></div><div class="ttdeci">double complex X_child_CisAisCjuAju_GeneralSpin_MPIsingle(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the canonical general spin system when one of these sites is in the inter process re...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01817">mltplyMPISpinCore.c:1817</a></div></div>
<div class="ttc" id="global_8c_html_a88f940c2e673ea0ac2352249e76f5201"><div class="ttname"><a href="global_8c.html#a88f940c2e673ea0ac2352249e76f5201">cFileName2BGreen_TPQ</a></div><div class="ttdeci">const char * cFileName2BGreen_TPQ</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00061">global.c:61</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a11e540019dd7ff6b6b611767d483fa60"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60">X_GC_child_CisAisCjtAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjtAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00514">mltplyMPIHubbardCore.c:514</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a8575bdd2f35cf049753b0617d2693edb"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00754">mltplyHubbardCore.c:754</a></div></div>
<div class="ttc" id="global_8h_html_aa68aa1cfd58c60e5cb4877965fa41576"><div class="ttname"><a href="global_8h.html#aa68aa1cfd58c60e5cb4877965fa41576">D_FileNameMax</a></div><div class="ttdeci">#define D_FileNameMax</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00023">global.h:23</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_a5d9e5a462ca77248cbae177465fa02c3"><div class="ttname"><a href="mltply_spin_core_8c.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a></div><div class="ttdeci">int X_SpinGC_CisAis(long unsigned int j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int sigma1)</div><div class="ttdoc">Compute the grandcanonical spin state with bit mask is1_spin. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00183">mltplySpinCore.c:183</a></div></div>
<div class="ttc" id="global_8h_html_ad7960e15bbb3ec77e0480d11807de888"><div class="ttname"><a href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a></div><div class="ttdeci">double complex ** vec</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00045">global.h:45</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a76cf91a2d8317a9349bc362f1aea33f7"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a76cf91a2d8317a9349bc362f1aea33f7">X_child_CisAisCjuAju_GeneralSpin_MPIdouble</a></div><div class="ttdeci">double complex X_child_CisAisCjuAju_GeneralSpin_MPIdouble(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the canonical general spin system when both sites are in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01748">mltplyMPISpinCore.c:1748</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a3713f8b19de9694c630c5ca182933b5f"><div class="ttname"><a href="bitcalc_8c.html#a3713f8b19de9694c630c5ca182933b5f">ConvertToList1GeneralSpin</a></div><div class="ttdeci">int ConvertToList1GeneralSpin(const long unsigned int org_ibit, const long unsigned int ihlfbit, long unsigned int *_ilist1Comp)</div><div class="ttdoc">function of converting component to list_1 </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00285">bitcalc.c:285</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a59452329e5c334718f67ab4d3d8b8431"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431">X_child_CisAisCjtAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAisCjtAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l01310">mltplyMPIHubbardCore.c:1310</a></div></div>
<div class="ttc" id="struct_define_list_html_ac22e3ff4e833d0018210a68bee2ed816"><div class="ttname"><a href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">DefineList::CisAjtCkuAlvDC</a></div><div class="ttdeci">int ** CisAjtCkuAlvDC</div><div class="ttdoc">[DefineList::NCisAjtCkuAlvDC][4] Indices of two-body correlation function. malloc in setmem_def()...</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00177">struct.h:177</a></div></div>
<div class="ttc" id="_file_i_o_8c_html_a7d23a0790b28a52d128e0b93bc832cfb"><div class="ttname"><a href="_file_i_o_8c.html#a7d23a0790b28a52d128e0b93bc832cfb">childfopenMPI</a></div><div class="ttdeci">int childfopenMPI(const char *_cPathChild, const char *_cmode, FILE **_fp)</div><div class="ttdoc">Only the root process open file in output/ directory. </div><div class="ttdef"><b>Definition:</b> <a href="_file_i_o_8c_source.html#l00027">FileIO.c:27</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_a1b6c6239f632e04606cf340f024d2ed3"><div class="ttname"><a href="mltply_spin_core_8c.html#a1b6c6239f632e04606cf340f024d2ed3">GC_child_CisAitCiuAiv_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAitCiuAiv_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of grandcanonical spsin system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00529">mltplySpinCore.c:529</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a4779085fc0aeb372e1b3f3b0a20dee5d"><div class="ttname"><a href="struct_bind_struct.html#a4779085fc0aeb372e1b3f3b0a20dee5d">BindStruct::Phys</a></div><div class="ttdeci">struct PhysList Phys</div><div class="ttdoc">Physical quantities. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00413">struct.h:413</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_a93558eb8cb0c4df2ce01e0611b771f66"><div class="ttname"><a href="mltply_spin_core_8c.html#a93558eb8cb0c4df2ce01e0611b771f66">X_Spin_CisAis</a></div><div class="ttdeci">int X_Spin_CisAis(long unsigned int j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int sigma1)</div><div class="ttdoc">Compute the spin state with bit mask is1_spin. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00166">mltplySpinCore.c:166</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a0b7abd184f6ccce7ac4141c21fabf91c"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a0b7abd184f6ccce7ac4141c21fabf91c">expec_cisajscktalt_SpinGeneral</a></div><div class="ttdeci">int expec_cisajscktalt_SpinGeneral(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Child function to calculate two-body green&amp;#39;s functions for General Spin model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00703">expec_cisajscktaltdc.c:703</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_ac0c99cbb8b6107f22d5f98dda7c261c1"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#ac0c99cbb8b6107f22d5f98dda7c261c1">X_child_CisAisCjtAjt_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAisCjtAjt_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00829">mltplyMPIHubbardCore.c:829</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_ae8b5eaea3b894110484f2214d7566ecf"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#ae8b5eaea3b894110484f2214d7566ecf">X_child_CisAitCjuAjv_GeneralSpin_MPIdouble</a></div><div class="ttdeci">double complex X_child_CisAitCjuAjv_GeneralSpin_MPIdouble(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the canonical general spin system when both sites are in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01652">mltplyMPISpinCore.c:1652</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00330">struct.h:330</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a2ca27868fab714216654436b769197bc"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a2ca27868fab714216654436b769197bc">Rearray_Interactions</a></div><div class="ttdeci">int Rearray_Interactions(int i, long unsigned int *org_isite1, long unsigned int *org_isite2, long unsigned int *org_isite3, long unsigned int *org_isite4, long unsigned int *org_sigma1, long unsigned int *org_sigma2, long unsigned int *org_sigma3, long unsigned int *org_sigma4, double complex *tmp_V, struct BindStruct *X)</div><div class="ttdoc">Rearray interactions. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00223">expec_cisajscktaltdc.c:223</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a0f1394dd9dcb5a334f15676d511313b1"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a0f1394dd9dcb5a334f15676d511313b1">X_GC_child_CisAisCjuAju_GeneralSpin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAju_GeneralSpin_MPIdouble(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the grandcanonical general spin system when both site is in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01068">mltplyMPISpinCore.c:1068</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a29c17404e94c3971bee0cc0a9de81533"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a29c17404e94c3971bee0cc0a9de81533">X_GC_child_CisAisCjuAju_spin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAju_spin_MPIsingle(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">CisAisCjuAjv term in Spin model + GC When both site1 and site2 are in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00448">mltplyMPISpinCore.c:448</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a15226d2f776230cec607303d8024f4b1"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a15226d2f776230cec607303d8024f4b1">X_GC_child_CisAitCjuAjv_GeneralSpin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAitCjuAjv_GeneralSpin_MPIdouble(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the grandcanonical general spin system when both site is in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00977">mltplyMPISpinCore.c:977</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_ad468e5109f6dc215394c103675b503fb"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#ad468e5109f6dc215394c103675b503fb">expec_cisajscktalt_SpinGC</a></div><div class="ttdeci">int expec_cisajscktalt_SpinGC(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Parent function to calculate two-body green&amp;#39;s functions for Spin GC model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00820">expec_cisajscktaltdc.c:820</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00026">global.h:26</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_accf48effad335c4471e4522e86371e64"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#accf48effad335c4471e4522e86371e64">X_GC_child_CisAitCjuAju_spin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAitCjuAju_spin_MPIsingle(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">CisAisCjuAjv term in Spin model + GC When only site2 is in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00734">mltplyMPISpinCore.c:734</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a75a9365a3be44e0de5e5850658c92109"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a75a9365a3be44e0de5e5850658c92109">X_GC_child_CisAisCjuAjv_spin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAjv_spin_MPIdouble(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">CisAisCjuAjv term in Spin model + GC When both site1 and site2 are in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00212">mltplyMPISpinCore.c:212</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_check_list_html_a617d47f691e1ea504faabb55c45cb183"><div class="ttname"><a href="struct_check_list.html#a617d47f691e1ea504faabb55c45cb183">CheckList::sdim</a></div><div class="ttdeci">unsigned long int sdim</div><div class="ttdoc">Dimension for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00307">struct.h:307</a></div></div>
<div class="ttc" id="bitcalc_8c_html_af5a13bcff4925b10b27ecba6079fbb5a"><div class="ttname"><a href="bitcalc_8c.html#af5a13bcff4925b10b27ecba6079fbb5a">GetLocal2Sz</a></div><div class="ttdeci">int GetLocal2Sz(const unsigned int isite, const long unsigned int org_bit, const long int *SiteToBit, const long unsigned int *Tpow)</div><div class="ttdoc">get 2sz at a site for general spin </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00449">bitcalc.c:449</a></div></div>
<div class="ttc" id="struct_define_list_html_a66b5c042047526bfb2665961598bc563"><div class="ttname"><a href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">DefineList::OrgTpow</a></div><div class="ttdeci">long unsigned int * OrgTpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00092">struct.h:92</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a571209928d6c7125abd413555f89d748"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a571209928d6c7125abd413555f89d748">X_GC_child_CisAisCjtAjt_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjtAjt_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00263">mltplyMPIHubbardCore.c:263</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00341">struct.h:341</a></div></div>
<div class="ttc" id="struct_bind_struct_html"><div class="ttname"><a href="struct_bind_struct.html">BindStruct</a></div><div class="ttdoc">Bind. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00409">struct.h:409</a></div></div>
<div class="ttc" id="struct_define_list_html_acd881e170f064eb429a207412b8b64a2"><div class="ttname"><a href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">DefineList::Nsite</a></div><div class="ttdeci">unsigned int Nsite</div><div class="ttdoc">Number of sites in the INTRA process region. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00056">struct.h:56</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_aa25730bebedaef0567be1d1d3a2aa9f7"><div class="ttname"><a href="mltply_spin_core_8c.html#aa25730bebedaef0567be1d1d3a2aa9f7">GC_child_CisAisCisAis_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_spin_element(long unsigned int j, long unsigned int isA_up, long unsigned int isB_up, long unsigned int org_sigma2, long unsigned int org_sigma4, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute  term of grandcanonical spsin system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00426">mltplySpinCore.c:426</a></div></div>
<div class="ttc" id="_log_message_8c_html_af9e20cd063f9fc302818c9bd15eff059"><div class="ttname"><a href="_log_message_8c.html#af9e20cd063f9fc302818c9bd15eff059">cLogCGExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cLogCGExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00126">LogMessage.c:126</a></div></div>
<div class="ttc" id="_log_message_8c_html_ad0f20fbe58825d5d2ffe1414937e6386"><div class="ttname"><a href="_log_message_8c.html#ad0f20fbe58825d5d2ffe1414937e6386">cLanczosExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cLanczosExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00128">LogMessage.c:128</a></div></div>
<div class="ttc" id="struct_define_list_html_add52f995b8c9ac337a079d0bbf8ae095"><div class="ttname"><a href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">DefineList::Tpow</a></div><div class="ttdeci">long unsigned int * Tpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00090">struct.h:90</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a78387adc1f4e171d3796235adfcbd87e"><div class="ttname"><a href="bitcalc_8c.html#a78387adc1f4e171d3796235adfcbd87e">GetSplitBitByModel</a></div><div class="ttdeci">int GetSplitBitByModel(const int Nsite, const int iCalcModel, long unsigned int *irght, long unsigned int *ilft, long unsigned int *ihfbit)</div><div class="ttdoc">function of splitting original bit into right and left spaces. </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00078">bitcalc.c:78</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_ac3f88b541387e7b9b13758fa855b9327"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327">X_child_CisAjtCkuAlv_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAjtCkuAlv_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00907">mltplyMPIHubbardCore.c:907</a></div></div>
<div class="ttc" id="_log_message_8c_html_ae7b9876edcd7fb89a7dae61a1e853a9a"><div class="ttname"><a href="_log_message_8c.html#ae7b9876edcd7fb89a7dae61a1e853a9a">cTEExpecTwoBodyGStart</a></div><div class="ttdeci">const char * cTEExpecTwoBodyGStart</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00133">LogMessage.c:133</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a67618b30efd1e0dddf58b89407e13736"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736">X_child_CisAjtCkuAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAjtCkuAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l01121">mltplyMPIHubbardCore.c:1121</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
<div class="ttc" id="_log_message_8c_html_ad55b0f4978dc9f09cbc491ab0d76c78f"><div class="ttname"><a href="_log_message_8c.html#ad55b0f4978dc9f09cbc491ab0d76c78f">cLogLanczosExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cLogLanczosExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00125">LogMessage.c:125</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a6e5c6a3af522a385b4ee60f66efb2557"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00834">mltplyHubbardCore.c:834</a></div></div>
<div class="ttc" id="mltply_spin_core_8c_html_a9f7fc788e6ba0b42f84e2c5a4d187f4a"><div class="ttname"><a href="mltply_spin_core_8c.html#a9f7fc788e6ba0b42f84e2c5a4d187f4a">child_CisAisCisAis_spin_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_spin_element(long unsigned int j, long unsigned int isA_up, long unsigned int isB_up, long unsigned int org_sigma2, long unsigned int org_sigma4, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute  term of canonical spsin system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_spin_core_8c_source.html#l00391">mltplySpinCore.c:391</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a5780ffd65b489119e7d7eb9617e2d3a0"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0">expec_cisajscktalt_HubbardGC</a></div><div class="ttdeci">int expec_cisajscktalt_HubbardGC(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Child function to calculate two-body green&amp;#39;s functions for Hubbard GC model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00312">expec_cisajscktaltdc.c:312</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a915879a823599f9fa3b0cb041c5de568"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a915879a823599f9fa3b0cb041c5de568">expec_cisajscktalt_SpinHalf</a></div><div class="ttdeci">int expec_cisajscktalt_SpinHalf(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Child function to calculate two-body green&amp;#39;s functions for 1/2 Spin model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00571">expec_cisajscktaltdc.c:571</a></div></div>
<div class="ttc" id="_log_message_8c_html_ac36c65487237081689e0c26fbe269c35"><div class="ttname"><a href="_log_message_8c.html#ac36c65487237081689e0c26fbe269c35">cLanczosExpecTwoBodyGStart</a></div><div class="ttdeci">const char * cLanczosExpecTwoBodyGStart</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00127">LogMessage.c:127</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a2d5b96ff0d102ab1501330d94d23d866"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866">X_GC_child_CisAjtCkuAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAjtCkuAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00343">mltplyMPIHubbardCore.c:343</a></div></div>
<div class="ttc" id="struct_define_list_html_a854332d8078d94fd71f022a8a85fe972"><div class="ttname"><a href="struct_define_list.html#a854332d8078d94fd71f022a8a85fe972">DefineList::iFlgGeneralSpin</a></div><div class="ttdeci">int iFlgGeneralSpin</div><div class="ttdoc">Flag for the general (Sz/=1/2) spin. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00086">struct.h:86</a></div></div>
<div class="ttc" id="_log_message_8c_html_a7519659e9f2c455440ff713b688cc682"><div class="ttname"><a href="_log_message_8c.html#a7519659e9f2c455440ff713b688cc682">cCGExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cCGExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00130">LogMessage.c:130</a></div></div>
<div class="ttc" id="global_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00047">global.h:47</a></div></div>
<div class="ttc" id="global_8c_html_a2a071aec3f989fa3b894107138199ddb"><div class="ttname"><a href="global_8c.html#a2a071aec3f989fa3b894107138199ddb">cFileName2BGreen_CG</a></div><div class="ttdeci">const char * cFileName2BGreen_CG</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00046">global.c:46</a></div></div>
<div class="ttc" id="struct_define_list_html_a7782126bb1a4979ab7ee87c652a2cec7"><div class="ttname"><a href="struct_define_list.html#a7782126bb1a4979ab7ee87c652a2cec7">DefineList::NCisAjtCkuAlvDC</a></div><div class="ttdeci">unsigned int NCisAjtCkuAlvDC</div><div class="ttdoc">Number of indices of two-body correlation function. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00178">struct.h:178</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00333">struct.h:333</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a11e78b661246513350ad6ee2e3985d9f"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00689">mltplyHubbardCore.c:689</a></div></div>
<div class="ttc" id="global_8c_html_a30aa928612a1c54d049114f96c2d25e7"><div class="ttname"><a href="global_8c.html#a30aa928612a1c54d049114f96c2d25e7">cFileName2BGreen_Lanczos</a></div><div class="ttdeci">const char * cFileName2BGreen_Lanczos</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00045">global.c:45</a></div></div>
<div class="ttc" id="struct_define_list_html_a382f41379aeddfc7a721d39a0c5770a2"><div class="ttname"><a href="struct_define_list.html#a382f41379aeddfc7a721d39a0c5770a2">DefineList::SiteToBit</a></div><div class="ttdeci">long int * SiteToBit</div><div class="ttdoc">[DefineList::NsiteMPI] Similar to DefineList::Tpow. For general spin. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00094">struct.h:94</a></div></div>
<div class="ttc" id="struct_define_list_html_abe80758171b3ffeca7b5fa790e5ede22"><div class="ttname"><a href="struct_define_list.html#abe80758171b3ffeca7b5fa790e5ede22">DefineList::istep</a></div><div class="ttdeci">int istep</div><div class="ttdoc">Index of TPQ step ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00078">struct.h:78</a></div></div>
<div class="ttc" id="_log_message_8c_html_a95586278e0e76764e6307174e5d6b3f4"><div class="ttname"><a href="_log_message_8c.html#a95586278e0e76764e6307174e5d6b3f4">cCGExpecTwoBodyGStart</a></div><div class="ttdeci">const char * cCGExpecTwoBodyGStart</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00129">LogMessage.c:129</a></div></div>
<div class="ttc" id="global_8c_html_a4cc81b237528770cf1b012aee34ba424"><div class="ttname"><a href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a></div><div class="ttdeci">const char * cFileNameTimeKeep</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00023">global.c:23</a></div></div>
<div class="ttc" id="_log_message_8c_html_acf90179a5d51508dd9973c8389f4aed2"><div class="ttname"><a href="_log_message_8c.html#acf90179a5d51508dd9973c8389f4aed2">cTPQExpecTwoBodyGStart</a></div><div class="ttdeci">const char * cTPQExpecTwoBodyGStart</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8c_source.html#l00131">LogMessage.c:131</a></div></div>
<div class="ttc" id="bitcalc_8c_html_aa28fdedad7cf9d8eb0dc6fa5ead0635f"><div class="ttname"><a href="bitcalc_8c.html#aa28fdedad7cf9d8eb0dc6fa5ead0635f">BitCheckGeneral</a></div><div class="ttdeci">int BitCheckGeneral(const long unsigned int org_bit, const unsigned int org_isite, const unsigned int target_ispin, const long int *SiteToBit, const long unsigned int *Tpow)</div><div class="ttdoc">bit check function for general spin </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00393">bitcalc.c:393</a></div></div>
<div class="ttc" id="global_8c_html_a233d7c672baf88d830d6ddd086f0ebaa"><div class="ttname"><a href="global_8c.html#a233d7c672baf88d830d6ddd086f0ebaa">cFileName2BGreen_TE</a></div><div class="ttdeci">const char * cFileName2BGreen_TE</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00063">global.c:63</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a2e87402ae7a6aeb5e826cd33cdf3ab57"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a2e87402ae7a6aeb5e826cd33cdf3ab57">expec_cisajscktalt_SpinGCHalf</a></div><div class="ttdeci">int expec_cisajscktalt_SpinGCHalf(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Child function to calculate two-body green&amp;#39;s functions for 1/2 Spin GC model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00840">expec_cisajscktaltdc.c:840</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_ae2ee1ba3e3c5795a2d80f8bcc0d89732"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#ae2ee1ba3e3c5795a2d80f8bcc0d89732">X_GC_child_CisAitCjuAju_GeneralSpin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAitCjuAju_GeneralSpin_MPIdouble(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc"> term in Spin model. When both site1 and site3 are in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00901">mltplyMPISpinCore.c:901</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00346">struct.h:346</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_8c_html_a4e5f05080675ce78c92496afca5e5965"><div class="ttname"><a href="mltply_m_p_i_spin_8c.html#a4e5f05080675ce78c92496afca5e5965">X_child_general_int_spin_MPIdouble</a></div><div class="ttdeci">double complex X_child_general_int_spin_MPIdouble(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Exchange term in Spin model When both site1 and site2 are in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_8c_source.html#l00061">mltplyMPISpin.c:61</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_add9824527f147708e47dc84b8322600e"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAjtCkuAlv_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00541">mltplyMPIHubbardCore.c:541</a></div></div>
<div class="ttc" id="struct_8h_html_a2e5276e30c3a9c9155e407ab3e645567"><div class="ttname"><a href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a></div><div class="ttdeci">struct EDMainCalStruct X</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00432">struct.h:432</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_ad2872d8b3f1c758d3933dc9e2b19dd16"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#ad2872d8b3f1c758d3933dc9e2b19dd16">expec_cisajscktalt_SpinGCGeneral</a></div><div class="ttdeci">int expec_cisajscktalt_SpinGCGeneral(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Child function to calculate two-body green&amp;#39;s functions for General Spin GC model. ...</div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00951">expec_cisajscktaltdc.c:951</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_ab674c454b9c1ae861483c53f32c78919"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#ab674c454b9c1ae861483c53f32c78919">X_GC_child_CisAisCjuAjv_GeneralSpin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAjv_GeneralSpin_MPIsingle(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the grandcanonical general spin system when one of these site is in the inter proces...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01362">mltplyMPISpinCore.c:1362</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a918ce8a912fe44cd3f9e49f6b8ca0581"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a918ce8a912fe44cd3f9e49f6b8ca0581">expec_cisajscktalt_Spin</a></div><div class="ttdeci">int expec_cisajscktalt_Spin(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Parent function to calculate two-body green&amp;#39;s functions for Spin model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00551">expec_cisajscktaltdc.c:551</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a2ad42e0120a7dac9479597ea42c8f55a"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a2ad42e0120a7dac9479597ea42c8f55a">X_GC_child_CisAisCjuAjv_spin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAjv_spin_MPIsingle(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">CisAisCjuAjv term in Spin model + GC When only site2 is in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00629">mltplyMPISpinCore.c:629</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_8c_html_abdfa931ba0482cdf3c19181478055d02"><div class="ttname"><a href="mltply_m_p_i_spin_8c.html#abdfa931ba0482cdf3c19181478055d02">X_child_general_int_spin_MPIsingle</a></div><div class="ttdeci">double complex X_child_general_int_spin_MPIsingle(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_8c_source.html#l00222">mltplyMPISpin.c:222</a></div></div>
<div class="ttc" id="struct_define_list_html_acc55ef9e68605fbaba4697e0e4e90b95"><div class="ttname"><a href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">DefineList::iCalcModel</a></div><div class="ttdeci">int iCalcModel</div><div class="ttdoc">Switch for model. 0:Hubbard, 1:Spin, 2:Kondo, 3:HubbardGC, 4:SpinGC, 5:KondoGC, 6:HubbardNConserved. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00198">struct.h:198</a></div></div>
<div class="ttc" id="bitcalc_8c_html_ab4222507f3f98dfa3fd72e6187deb78d"><div class="ttname"><a href="bitcalc_8c.html#ab4222507f3f98dfa3fd72e6187deb78d">GetOffCompGeneralSpin</a></div><div class="ttdeci">int GetOffCompGeneralSpin(const long unsigned int org_ibit, const int org_isite, const int org_ispin, const int off_ispin, long unsigned int *_ioffComp, const long int *SiteToBit, const long unsigned int *Tpow)</div><div class="ttdoc">function of getting off-diagonal component for general spin </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00243">bitcalc.c:243</a></div></div>
<div class="ttc" id="global_8c_html_af97aa29cc5e6f180b89596e6c91a3ffc"><div class="ttname"><a href="global_8c.html#af97aa29cc5e6f180b89596e6c91a3ffc">cFileName2BGreen_FullDiag</a></div><div class="ttdeci">const char * cFileName2BGreen_FullDiag</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00077">global.c:77</a></div></div>
<div class="ttc" id="global_8h_html_aa8a2431e50f9fc7d8c78af300d5f3bee"><div class="ttname"><a href="global_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdoc">Process ID, defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00163">global.h:163</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a340591f9ad97da382724029398a333d6"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a340591f9ad97da382724029398a333d6">X_GC_child_CisAitCiuAiv_spin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAitCiuAiv_spin_MPIdouble(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, int org_ispin4, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc"> term in Spin model + GC. When both site1 and site2 are in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00103">mltplyMPISpinCore.c:103</a></div></div>
<div class="ttc" id="struct_phys_list_html_a5616dcf1777ecef24f4883835541a375"><div class="ttname"><a href="struct_phys_list.html#a5616dcf1777ecef24f4883835541a375">PhysList::eigen_num</a></div><div class="ttdeci">int eigen_num</div><div class="ttdoc">Index of eigenstate used for the file name of the correlation function. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00367">struct.h:367</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a5a389f0d9543e02b5d2e19df0198bafc"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex GC_child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00865">mltplyHubbardCore.c:865</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a95fc4908040330c6556954b46972e35f"><div class="ttname"><a href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">BindStruct::Check</a></div><div class="ttdeci">struct CheckList Check</div><div class="ttdoc">Size of the Hilbert space. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00411">struct.h:411</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_a8c2107762d44860950b1deb3a1f0ce60"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#a8c2107762d44860950b1deb3a1f0ce60">X_GC_child_CisAitCjuAju_spin_MPIdouble</a></div><div class="ttdeci">double complex X_GC_child_CisAitCjuAju_spin_MPIdouble(int org_isite1, int org_ispin1, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">CisAisCjuAjv term in Spin model + GC When both site1 and site2 are in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l00309">mltplyMPISpinCore.c:309</a></div></div>
<div class="ttc" id="struct_define_list_html_aa769a551105160efd6f8dc36040c1289"><div class="ttname"><a href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">DefineList::CDataFileHead</a></div><div class="ttdeci">char * CDataFileHead</div><div class="ttdoc">Read from Calcmod in readdef.h. Header of output file such as Green&amp;#39;s function. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00042">struct.h:42</a></div></div>
<div class="ttc" id="log_8c_html_a07deb00043cb31a691ff307cc8ae0552"><div class="ttname"><a href="log_8c.html#a07deb00043cb31a691ff307cc8ae0552">TimeKeeperWithStep</a></div><div class="ttdeci">int TimeKeeperWithStep(struct BindStruct *X, const char *cFileName, const char *cTimeKeeper_Message, const char *cWriteType, const int istep)</div><div class="ttdoc">Functions for writing a time log. </div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00078">log.c:78</a></div></div>
<div class="ttc" id="mltply_m_p_i_spin_core_8c_html_ace468131cb9d905d4beaec29719db0b2"><div class="ttname"><a href="mltply_m_p_i_spin_core_8c.html#ace468131cb9d905d4beaec29719db0b2">X_GC_child_CisAisCjuAju_GeneralSpin_MPIsingle</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjuAju_GeneralSpin_MPIsingle(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_J, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term in the grandcanonical general spin system when one of these site is in the inter proces...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_spin_core_8c_source.html#l01598">mltplyMPISpinCore.c:1598</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ab7d585bf30bbcee8449b8c54d0bb128e"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00901">mltplyHubbardCore.c:901</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a2e64839292192a5851d4be60a4f3561a"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00791">mltplyHubbardCore.c:791</a></div></div>
<div class="ttc" id="expec__cisajscktaltdc_8c_html_a57e6093abb7b98c433e953764b892d15"><div class="ttname"><a href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15">expec_cisajscktalt_Hubbard</a></div><div class="ttdeci">int expec_cisajscktalt_Hubbard(struct BindStruct *X, double complex *vec, FILE **_fp)</div><div class="ttdoc">Child function to calculate two-body green&amp;#39;s functions for Hubbard model. </div><div class="ttdef"><b>Definition:</b> <a href="expec__cisajscktaltdc_8c_source.html#l00430">expec_cisajscktaltdc.c:430</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a6d06655a28258eea84191579396219e1"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00937">mltplyHubbardCore.c:937</a></div></div>
<div class="ttc" id="log_8c_html_aa7daf8ff6a1c61ea795f4096043f1c19"><div class="ttname"><a href="log_8c.html#aa7daf8ff6a1c61ea795f4096043f1c19">TimeKeeperWithRandAndStep</a></div><div class="ttdeci">int TimeKeeperWithRandAndStep(struct BindStruct *X, const char *cFileName, const char *cTimeKeeper_Message, const char *cWriteType, const int irand, const int istep)</div><div class="ttdoc">Functions for writing a time log. </div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00117">log.c:117</a></div></div>
<div class="ttc" id="log_8c_html_a5c659bb0ba9e5d8a508c6cb6b7431f23"><div class="ttname"><a href="log_8c.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a></div><div class="ttdeci">int TimeKeeper(struct BindStruct *X, const char *cFileName, const char *cTimeKeeper_Message, const char *cWriteType)</div><div class="ttdoc">Functions for writing a time log. </div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00042">log.c:42</a></div></div>
<div class="ttc" id="struct_define_list_html_a2cdda57afe9e27418aab516c9c00526c"><div class="ttname"><a href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">DefineList::iCalcType</a></div><div class="ttdeci">int iCalcType</div><div class="ttdoc">Switch for calculation type. 0:Lanczos, 1:TPQCalc, 2:FullDiag. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00192">struct.h:192</a></div></div>
<div class="ttc" id="global_8h_html_abacbc82cf67663cd6f3708f1274ac207"><div class="ttname"><a href="global_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a></div><div class="ttdeci">FILE * stdoutMPI</div><div class="ttdoc">File pointer to the standard output defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00165">global.h:165</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a985bdb0d96a952fc6c447e12ea2b906a"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00718">mltplyHubbardCore.c:718</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="expec__cisajscktaltdc_8c.html">expec_cisajscktaltdc.c</a></li>
    <li class="footer">Generated on Mon Jul 1 2019 17:07:05 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

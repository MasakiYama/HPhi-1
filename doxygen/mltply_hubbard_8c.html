<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HΦ: mltplyHubbard.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mltply_hubbard_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mltplyHubbard.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Function for Hubbard Hamitonian.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;bitcalc.h&gt;</code><br />
<code>#include &quot;mltplyCommon.h&quot;</code><br />
<code>#include &quot;mltplyHubbard.h&quot;</code><br />
<code>#include &quot;mltplyMPIHubbard.h&quot;</code><br />
<code>#include &quot;CalcTime.h&quot;</code><br />
<code>#include &quot;mltplyHubbardCore.h&quot;</code><br />
<code>#include &quot;mltplyMPIHubbardCore.h&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for mltplyHubbard.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c__incl.png" border="0" usemap="#mltply_hubbard_8c" alt=""/></div>
<map name="mltply_hubbard_8c" id="mltply_hubbard_8c">
</map>
</div>
</div>
<p><a href="mltply_hubbard_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae34b47523aa0e2619a18e316f3d1e930"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930">mltplyHubbard</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *tmp_v0, double complex *tmp_v1)</td></tr>
<tr class="memdesc:ae34b47523aa0e2619a18e316f3d1e930"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform Hamiltonian vector product for (extended) Hubbard type model. \({\bf v}_0 = {\hat H}{\bf v}_1\)  <a href="#ae34b47523aa0e2619a18e316f3d1e930">More...</a><br /></td></tr>
<tr class="separator:ae34b47523aa0e2619a18e316f3d1e930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8ead6d49a5b1621694d91c05ee3dc2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2">mltplyHubbardGC</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *tmp_v0, double complex *tmp_v1)</td></tr>
<tr class="memdesc:a3a8ead6d49a5b1621694d91c05ee3dc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). \({\bf v}_0 = {\hat H}{\bf v}_1\)  <a href="#a3a8ead6d49a5b1621694d91c05ee3dc2">More...</a><br /></td></tr>
<tr class="separator:a3a8ead6d49a5b1621694d91c05ee3dc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d178b47dde9c5e387a87d482463575d"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#a4d178b47dde9c5e387a87d482463575d">child_pairhopp</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:a4d178b47dde9c5e387a87d482463575d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute pairhopp term (canonical)  <a href="#a4d178b47dde9c5e387a87d482463575d">More...</a><br /></td></tr>
<tr class="separator:a4d178b47dde9c5e387a87d482463575d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5821f04d36f42ce53a1d522dcb5548c5"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#a5821f04d36f42ce53a1d522dcb5548c5">child_exchange</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:a5821f04d36f42ce53a1d522dcb5548c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Exchange term (canonical) in single process.  <a href="#a5821f04d36f42ce53a1d522dcb5548c5">More...</a><br /></td></tr>
<tr class="separator:a5821f04d36f42ce53a1d522dcb5548c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6de5fa85bba8abb6001cea5f4eae19e"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#ac6de5fa85bba8abb6001cea5f4eae19e">child_general_hopp</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex trans)</td></tr>
<tr class="memdesc:ac6de5fa85bba8abb6001cea5f4eae19e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute hopping (canonical)  <a href="#ac6de5fa85bba8abb6001cea5f4eae19e">More...</a><br /></td></tr>
<tr class="separator:ac6de5fa85bba8abb6001cea5f4eae19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f11fc0359c4543168c6a6f61a1ec70"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70">GC_child_general_hopp</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex trans)</td></tr>
<tr class="memdesc:a59f11fc0359c4543168c6a6f61a1ec70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commpute hopping term (grandcanonical)  <a href="#a59f11fc0359c4543168c6a6f61a1ec70">More...</a><br /></td></tr>
<tr class="separator:a59f11fc0359c4543168c6a6f61a1ec70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9d79bf221699cecaa1b65b374e5b92"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92">child_general_int</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:aef9d79bf221699cecaa1b65b374e5b92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute inter-all term (canonical)  <a href="#aef9d79bf221699cecaa1b65b374e5b92">More...</a><br /></td></tr>
<tr class="separator:aef9d79bf221699cecaa1b65b374e5b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e66e6ab9f74ec21130ed2363e24a51"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51">GC_child_general_int</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:a70e66e6ab9f74ec21130ed2363e24a51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute inter-all term (canonical)  <a href="#a70e66e6ab9f74ec21130ed2363e24a51">More...</a><br /></td></tr>
<tr class="separator:a70e66e6ab9f74ec21130ed2363e24a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16f7b63b9768957a720004697a7a774"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#ad16f7b63b9768957a720004697a7a774">GC_child_pairhopp</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:ad16f7b63b9768957a720004697a7a774"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute pairhopp term (grandcanonical)  <a href="#ad16f7b63b9768957a720004697a7a774">More...</a><br /></td></tr>
<tr class="separator:ad16f7b63b9768957a720004697a7a774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23af00b3160b075156e1c842bb3a879d"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_8c.html#a23af00b3160b075156e1c842bb3a879d">GC_child_exchange</a> (double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:a23af00b3160b075156e1c842bb3a879d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Exchange term (grandcanonical) in single process.  <a href="#a23af00b3160b075156e1c842bb3a879d">More...</a><br /></td></tr>
<tr class="separator:a23af00b3160b075156e1c842bb3a879d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Function for Hubbard Hamitonian. </p>
<ul>
<li>
<a class="el" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model.  ">mltplyHubbard()</a>: Main routine of hubbard hamiltonian (canonical). </li>
<li>
<a class="el" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical).  ">mltplyHubbardGC()</a>: Main routine of hubbard hamiltonian (grandcanonical). </li>
</ul>
<table class="doxtable">
<tr>
<td></td><td>Canonical </td><td>Canonical </td><td>Grand Canonical </td><td>Grand Canonical  </td></tr>
<tr>
<td></td><td>Intra Process </td><td>Inter Process </td><td>Intra Process </td><td>Inter Process  </td></tr>
<tr>
<td>\(c_{i s}^\dagger\) </td><td>::Cis, <a class="el" href="mltply_hubbard_core_8c.html#a3f49b75c63d21a51d25b3d414a759be7" title="Compute index of final wavefunction associatesd to  term of canonical Hubbard system. ">X_Cis</a> </td><td>::Cis_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a76ed1830af9fb3d1f1f49981f0a6672e" title="Compute  term of canonical Hubbard system. ">X_Cis_MPI</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#a82057cd7316bca01585868207301cf39" title="Compute  term of grandcanonical Hubbard system. ">GC_Cis</a>, ::X_GC_Cis </td><td>::GC_Cis_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a65a9cb52d6f6b78d3c5c26bb091f2b0b" title="Single creation/annihilation operator in the inter process region for HubbardGC. ">X_GC_Cis_MPI</a>  </td></tr>
<tr>
<td>\(c_{j t}\) </td><td>::Ajt, <a class="el" href="mltply_hubbard_core_8c.html#ae302b1f2124063034b348974c361f966" title="Compute index of final wavefunction associatesd to  term of canonical Hubbard system. ">X_Ajt</a> </td><td>::Ajt_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a76860c3ee2aaf4109b0cd9e458cd54e3" title="Compute  term of canonical Hubbard system. ">X_Ajt_MPI</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#a414245ea3f4742224f9d99a0da15a228" title="Compute  term of grandcanonical Hubbard system. ">GC_Ajt</a>, ::X_GC_Ajt </td><td>::GC_Ajt_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#afb05b7aaa7ae3d03c5c029b807e60358" title="Single creation/annihilation operator in the inter process region for HubbardGC. ">X_GC_Ajt_MPI</a>  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{i s}\) </td><td>::CisAis, <a class="el" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) ">X_CisAis</a> </td><td>::child_CisAis_Hubbard_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#ac2399f2f6269841904d827a67af2c2f5">X_child_CisAis_Hubbard_MPI</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4" title="Operation of  (Grandcanonical) ">GC_CisAis</a>, <a class="el" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) ">X_CisAis</a> </td><td>::GC_child_CisAis_Hubbard_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#ab59deb7bc8d1509683aa8f2b376cbceb" title="Compute  term of grandcanonical Hubbard system. ">X_GC_child_CisAis_Hubbard_MPI</a>  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{j t}\) </td><td><a class="el" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928" title=" term for canonical Hubbard ">CisAjt</a>, <a class="el" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. ">X_CisAjt</a> </td><td>::child_CisAjt_MPIsingle, ::child_CisAjt_MPIdouble, <a class="el" href="mltply_m_p_i_hubbard_8c.html#a58b4fbd3fa69809e9633f197f23dced8" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When only site2 is in the inter process region...">X_child_CisAjt_MPIsingle</a>, <a class="el" href="mltply_m_p_i_hubbard_8c.html#a0d286e432184734976ab21cbbb4bdc8b" title="Hopping term in Hubbard + MPI When both site1 and site2 are in the inter process region. ">X_child_CisAjt_MPIdouble</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936" title=" term for grandcanonical Hubbard ">GC_CisAjt</a>, <a class="el" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. ">X_GC_CisAjt</a> </td><td>::GC_child_CisAjt_Hubbard_MPI, <a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a5d60d0a1211bf7dd5fea8be49de9b655" title="Compute  term of grandcanonical Hubbard system. ">X_GC_child_CisAjt_Hubbard_MPI</a>  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{i s} c_{i s}^\dagger c_{i s}\) </td><td><a class="el" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f" title="Compute  term of canonical Hubbard system. ">child_CisAisCisAis_element</a> </td><td>::X_child_CisAisCisAis_Hubbard_MPI </td><td><a class="el" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557" title="Compute  term of grandcanonical Hubbard system. ">GC_child_CisAisCisAis_element</a> </td><td>::X_GC_child_CisAisCisAis_Hubbard_MPI  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{i s} c_{j t}^\dagger c_{j t}\) </td><td>::child_CisAisCjtAjt_element </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#ac0c99cbb8b6107f22d5f98dda7c261c1" title="Compute  term of canonical Hubbard system. ">X_child_CisAisCjtAjt_Hubbard_MPI</a> </td><td>::GC_child_CisAisCjtAjt_element </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a571209928d6c7125abd413555f89d748" title="Compute  term of grandcanonical Hubbard system. ">X_GC_child_CisAisCjtAjt_Hubbard_MPI</a>  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{i s} c_{j t}^\dagger c_{k u}\) </td><td><a class="el" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a" title="Compute  term of canonical Hubbard system. ">child_CisAisCjtAku_element</a> </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431" title="Compute  term of canonical Hubbard system. ">X_child_CisAisCjtAku_Hubbard_MPI</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc" title="Compute  term of grandcanonical Hubbard system. ">GC_child_CisAisCjtAku_element</a> </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60" title="Compute  term of grandcanonical Hubbard system. ">X_GC_child_CisAisCjtAku_Hubbard_MPI</a>  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{j t} c_{k u}^\dagger c_{k u}\) </td><td><a class="el" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb" title="Compute  term of canonical Hubbard system. ">child_CisAjtCkuAku_element</a> </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736" title="Compute  term of canonical Hubbard system. ">X_child_CisAjtCkuAku_Hubbard_MPI</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e" title="Compute  term of grandcanonical Hubbard system. ">GC_child_CisAjtCkuAku_element</a> </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866" title="Compute  term of grandcanonical Hubbard system. ">X_GC_child_CisAjtCkuAku_Hubbard_MPI</a>  </td></tr>
<tr>
<td>\(c_{i s}^\dagger c_{j t} c_{k u}^\dagger c_{l v}\) </td><td><a class="el" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a" title="Compute  term of canonical Hubbard system. ">child_CisAjtCkuAlv_element</a> </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327" title="Compute  term of canonical Hubbard system. ">X_child_CisAjtCkuAlv_Hubbard_MPI</a> </td><td><a class="el" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1" title="Compute  term of grandcanonical Hubbard system. ">GC_child_CisAjtCkuAlv_element</a> </td><td><a class="el" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e" title="Compute  term of grandcanonical Hubbard system. ">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a>  </td></tr>
</table>
<p>Other </p><table class="doxtable">
<tr>
<td></td><td>Get info </td><td>Canonical </td><td>Grandcanonical  </td></tr>
<tr>
<td>Exchange </td><td><a class="el" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08" title="Compute mask for bit operation of exchange term. ">child_exchange_GetInfo</a> </td><td><a class="el" href="mltply_hubbard_8c.html#a5821f04d36f42ce53a1d522dcb5548c5" title="Compute Exchange term (canonical) in single process. ">child_exchange</a>, <a class="el" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59" title="Compute exchange term of canonical-Hubbard. ">child_exchange_element</a> </td><td><a class="el" href="mltply_hubbard_8c.html#a23af00b3160b075156e1c842bb3a879d" title="Compute Exchange term (grandcanonical) in single process. ">GC_child_exchange</a>, <a class="el" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5" title="Compute exchange term of grandcanonical Hubbard system. ">GC_child_exchange_element</a>  </td></tr>
<tr>
<td>Pair hop </td><td><a class="el" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404" title="Compute mask for bit operation of pairhop term. ">child_pairhopp_GetInfo</a> </td><td><a class="el" href="mltply_hubbard_8c.html#a4d178b47dde9c5e387a87d482463575d" title="Compute pairhopp term (canonical) ">child_pairhopp</a>, <a class="el" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f" title="Compute pairhopp term of canonical Hubbard system. ">child_pairhopp_element</a> </td><td><a class="el" href="mltply_hubbard_8c.html#ad16f7b63b9768957a720004697a7a774" title="Compute pairhopp term (grandcanonical) ">GC_child_pairhopp</a>, <a class="el" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8" title="Compute pairhopp term of grandcanonical Hubbard system. ">GC_child_pairhopp_element</a>  </td></tr>
<tr>
<td>General int. </td><td><a class="el" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2" title="Compute mask for bit operation of general interaction term. ">child_general_int_GetInfo</a> </td><td><a class="el" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter-all term (canonical) ">child_general_int</a> </td><td><a class="el" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter-all term (canonical) ">GC_child_general_int</a>  </td></tr>
<tr>
<td>General hop </td><td><a class="el" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264" title="Compute mask for bit operation of hopping term. ">child_general_hopp_GetInfo</a> </td><td><a class="el" href="mltply_hubbard_8c.html#ac6de5fa85bba8abb6001cea5f4eae19e" title="Compute hopping (canonical) ">child_general_hopp</a>, <a class="el" href="mltply_m_p_i_hubbard_8c.html#aa938067934c1c1a813b5bbc5c94f9d26" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When only site2 is in the inter process region...">child_general_hopp_MPIsingle</a>, <a class="el" href="mltply_m_p_i_hubbard_8c.html#ab1b2e0743624e8698eb36484166f92cc" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When both site1 and site2 are in the inter proce...">child_general_hopp_MPIdouble</a> </td><td><a class="el" href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70" title="Commpute hopping term (grandcanonical) ">GC_child_general_hopp</a>, <a class="el" href="mltply_m_p_i_hubbard_8c.html#a83da98c99feda75fe253ef0177bbb9ab" title="Hopping term in Hubbard + GC When only site2 is in the inter process region. ">GC_child_general_hopp_MPIsingle</a>, <a class="el" href="mltply_m_p_i_hubbard_8c.html#a7a8d32b95ea4b6d9b943d35d67deb88b" title="Hopping term in Hubbard + GC When both site1 and site2 are in the inter process region. ">GC_child_general_hopp_MPIdouble</a>  </td></tr>
</table>

<p class="definition">Definition in file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5821f04d36f42ce53a1d522dcb5548c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5821f04d36f42ce53a1d522dcb5548c5">&#9670;&nbsp;</a></span>child_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_exchange </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Exchange term (canonical) in single process. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00561">561</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="mltply_hubbard_core_8c_source.html#l00472">child_exchange_element()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, and <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>.</p>
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off = 0;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) firstprivate(i_max, X,off) private(j) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59">child_exchange_element</a>(j, tmp_v0, tmp_v1, X, &amp;off);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}<span class="comment">/*double complex child_exchange*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_acc7b0c2967b4cd90703907383169df59"><div class="ttname"><a href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59">child_exchange_element</a></div><div class="ttdeci">double complex child_exchange_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute exchange term of canonical-Hubbard. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00472">mltplyHubbardCore.c:472</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_cgraph.png" border="0" usemap="#mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_cgraph" id="mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59" title="Compute exchange term of canonical&#45;Hubbard. " alt="" coords="165,5,331,32"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="379,5,475,32"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="523,5,587,32"/>
</map>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_icgraph.png" border="0" usemap="#mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_icgraph" id="mltply_hubbard_8c_a5821f04d36f42ce53a1d522dcb5548c5_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="165,230,272,257"/>
<area shape="rect" id="node3" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="320,230,377,257"/>
<area shape="rect" id="node4" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="672,15,825,42"/>
<area shape="rect" id="node7" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="465,129,585,155"/>
<area shape="rect" id="node9" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="461,331,589,358"/>
<area shape="rect" id="node15" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="453,179,597,206"/>
<area shape="rect" id="node16" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="450,230,599,257"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="425,63,624,104"/>
<area shape="rect" id="node19" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="693,230,805,257"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="467,382,582,409"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="471,433,579,459"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="881,70,986,97"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1041,255,1092,282"/>
<area shape="rect" id="node8" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="691,179,806,206"/>
<area shape="rect" id="node10" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="702,382,795,409"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="887,382,979,409"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="723,281,774,307"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="877,281,990,307"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="873,230,993,257"/>
<area shape="rect" id="node18" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="675,70,823,97"/>
<area shape="rect" id="node21" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="715,433,782,459"/>
</map>
</div>

</div>
</div>
<a id="ac6de5fa85bba8abb6001cea5f4eae19e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6de5fa85bba8abb6001cea5f4eae19e">&#9670;&nbsp;</a></span>child_general_hopp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_general_hopp </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute hopping (canonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Hopping integral </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00582">582</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="struct_8h_source.html#l00341">LargeList::A_spin</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00305">CisAjt()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, <a class="el" href="struct_8h_source.html#l00332">LargeList::is1_spin</a>, <a class="el" href="struct_8h_source.html#l00333">LargeList::is2_spin</a>, <a class="el" href="struct_8h_source.html#l00346">LargeList::isA_spin</a>, and <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>.</p>

<p class="reference">Referenced by <a class="el" href="expec__cisajs_8c_source.html#l00257">expec_cisajs_Hubbard()</a>, <a class="el" href="_pair_ex_hubbard_8c_source.html#l00137">GetPairExcitedStateHubbard()</a>, and <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>.</p>
<div class="fragment"><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, isite1, isite2, Asum, Adiff;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  Asum = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  Adiff = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">//fprintf(stdout, &quot;DEBUG, isite1=%ld, isite2=%ld, Asum=%ld, Adiff=%ld \n&quot;, isite1, isite2, Asum, Adiff);</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) \</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">firstprivate(i_max,X,Asum,Adiff,isite1,isite2,trans) private(j) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928">CisAjt</a>(j, tmp_v0, tmp_v1, X, isite1, isite2, Asum, Adiff, trans) * trans;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}<span class="comment">/*double complex child_general_hopp*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_aaf0a9a1a4862be39ce011d0acf118928"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928">CisAjt</a></div><div class="ttdeci">double complex CisAjt(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V)</div><div class="ttdoc"> term for canonical Hubbard </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00305">mltplyHubbardCore.c:305</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00341">struct.h:341</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00333">struct.h:333</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00346">struct.h:346</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_cgraph.png" border="0" usemap="#mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_cgraph" id="mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928" title=" term for canonical Hubbard " alt="" coords="187,31,245,57"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="311,5,372,32"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="293,56,389,83"/>
<area shape="rect" id="node5" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="437,56,501,83"/>
</map>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_icgraph.png" border="0" usemap="#mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_icgraph" id="mltply_hubbard_8c_ac6de5fa85bba8abb6001cea5f4eae19e_icgraph">
<area shape="rect" id="node2" href="expec__cisajs_8c.html#a7b526b4cb5619bc0908c98c04428ffab" title="function of calculation for one body green&#39;s function for Hubbard model. " alt="" coords="205,259,359,285"/>
<area shape="rect" id="node11" href="_pair_ex_hubbard_8c.html#ad6ea48aa669d72fd8cc85162bae8b834" title="GetPairExcitedStateHubbard" alt="" coords="187,360,377,387"/>
<area shape="rect" id="node15" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="229,309,335,336"/>
<area shape="rect" id="node3" href="expec__cisajs_8c.html#aaaa7c9da11d8ae60fe21f1d046358a6c" title="function of calculation for one body green&#39;s function " alt="" coords="665,107,763,133"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="881,259,995,285"/>
<area shape="rect" id="node6" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="891,107,985,133"/>
<area shape="rect" id="node7" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="1077,56,1169,83"/>
<area shape="rect" id="node8" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="913,208,963,235"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1231,183,1281,209"/>
<area shape="rect" id="node9" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="1066,157,1179,184"/>
<area shape="rect" id="node10" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1063,208,1183,235"/>
<area shape="rect" id="node12" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="Calculating the pair excited state by the pair operator; &#160;&#160;&#160;, where &#160;indicates a creation (anti&#45;creat..." alt="" coords="425,469,567,496"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="Parent function to calculate the excited state. " alt="" coords="879,577,997,604"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1070,499,1175,525"/>
<area shape="rect" id="node16" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="467,309,525,336"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="861,525,1015,552"/>
<area shape="rect" id="node18" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="654,360,774,387"/>
<area shape="rect" id="node19" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="650,157,778,184"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="642,259,786,285"/>
<area shape="rect" id="node21" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="639,309,789,336"/>
<area shape="rect" id="node22" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="615,462,813,503"/>
<area shape="rect" id="node24" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="882,360,994,387"/>
<area shape="rect" id="node25" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="657,56,771,83"/>
<area shape="rect" id="node27" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="660,208,768,235"/>
<area shape="rect" id="node23" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="864,473,1012,500"/>
<area shape="rect" id="node26" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="905,5,971,32"/>
</map>
</div>

</div>
</div>
<a id="aef9d79bf221699cecaa1b65b374e5b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef9d79bf221699cecaa1b65b374e5b92">&#9670;&nbsp;</a></span>child_general_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_general_int </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute inter-all term (canonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00645">645</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="struct_8h_source.html#l00341">LargeList::A_spin</a>, <a class="el" href="struct_8h_source.html#l00342">LargeList::B_spin</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00689">child_CisAisCisAis_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00718">child_CisAisCjtAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00754">child_CisAjtCkuAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00791">child_CisAjtCkuAlv_element()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, <a class="el" href="struct_8h_source.html#l00332">LargeList::is1_spin</a>, <a class="el" href="struct_8h_source.html#l00333">LargeList::is2_spin</a>, <a class="el" href="struct_8h_source.html#l00334">LargeList::is3_spin</a>, <a class="el" href="struct_8h_source.html#l00335">LargeList::is4_spin</a>, <a class="el" href="struct_8h_source.html#l00346">LargeList::isA_spin</a>, <a class="el" href="struct_8h_source.html#l00347">LargeList::isB_spin</a>, <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>, and <a class="el" href="struct_8h_source.html#l00348">LargeList::tmp_V</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>.</p>
<div class="fragment"><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">double</span> complex dam_pr, tmp_V;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, i_max;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1, isite2, isite3, isite4;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum, Bsum, Adiff, Bdiff;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off = 0;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2 = 0;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">//note: this site is labeled for not only site but site with spin.</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  Asum = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  Adiff = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  Bsum = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  Bdiff = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  tmp_V = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">tmp_V</a>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  dam_pr = 0.0;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="preprocessor">#pragma omp parallel default(none) reduction(+:dam_pr) \</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">private(j, tmp_off, tmp_off_2) \</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="preprocessor">firstprivate(i_max, X, isite1, isite2, isite3, isite4, Asum, Bsum, Adiff, Bdiff, tmp_V) \</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (isite1 == isite2 &amp;&amp; isite3 == isite4) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }<span class="comment">/*if (isite1 == isite2 &amp;&amp; isite3 == isite4)*/</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 == isite2 &amp;&amp; isite3 != isite4) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a>(</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }<span class="comment">/*if (isite1 == isite2 &amp;&amp; isite3 != isite4)*/</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 != isite2 &amp;&amp; isite3 == isite4) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }<span class="comment">/*if (isite1 != isite2 &amp;&amp; isite3 == isite4)*/</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 != isite2 &amp;&amp; isite3 != isite4) {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a>(</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off_2);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }<span class="comment">/*if (isite1 != isite2 &amp;&amp; isite3 != isite4)*/</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  }<span class="comment">/*End of parallel region*/</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}<span class="comment">/*double complex child_general_int*/</span></div><div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00342">struct.h:342</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00335">struct.h:335</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00347">struct.h:347</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a8575bdd2f35cf049753b0617d2693edb"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00754">mltplyHubbardCore.c:754</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00341">struct.h:341</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00333">struct.h:333</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a11e78b661246513350ad6ee2e3985d9f"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00689">mltplyHubbardCore.c:689</a></div></div>
<div class="ttc" id="struct_large_list_html_ad706dd1a7ccaaa6f4e50cdcde74382a9"><div class="ttname"><a href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">LargeList::tmp_V</a></div><div class="ttdeci">double complex tmp_V</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00348">struct.h:348</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00346">struct.h:346</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a2e64839292192a5851d4be60a4f3561a"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00791">mltplyHubbardCore.c:791</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a985bdb0d96a952fc6c447e12ea2b906a"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00718">mltplyHubbardCore.c:718</a></div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_cgraph.png" border="0" usemap="#mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_cgraph" id="mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="174,5,309,47"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="174,71,309,112"/>
<area shape="rect" id="node10" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="172,136,311,177"/>
<area shape="rect" id="node11" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="174,201,309,243"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="359,78,436,105"/>
<area shape="rect" id="node5" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. " alt="" coords="360,150,435,177"/>
<area shape="rect" id="node6" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="484,205,585,231"/>
<area shape="rect" id="node8" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="487,150,583,177"/>
<area shape="rect" id="node7" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="635,205,696,231"/>
<area shape="rect" id="node9" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="633,150,697,177"/>
</map>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_icgraph.png" border="0" usemap="#mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_icgraph" id="mltply_hubbard_8c_aef9d79bf221699cecaa1b65b374e5b92_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="172,230,279,257"/>
<area shape="rect" id="node3" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="327,230,384,257"/>
<area shape="rect" id="node4" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="679,15,832,42"/>
<area shape="rect" id="node7" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="471,129,591,155"/>
<area shape="rect" id="node9" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="467,331,595,358"/>
<area shape="rect" id="node15" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="459,179,603,206"/>
<area shape="rect" id="node16" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="457,230,606,257"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="432,63,631,104"/>
<area shape="rect" id="node19" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="699,230,811,257"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="474,382,589,409"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="477,433,585,459"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="887,70,993,97"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1048,255,1099,282"/>
<area shape="rect" id="node8" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="698,179,813,206"/>
<area shape="rect" id="node10" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="709,382,802,409"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="894,382,986,409"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="730,281,781,307"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="883,281,997,307"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="880,230,1000,257"/>
<area shape="rect" id="node18" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="681,70,829,97"/>
<area shape="rect" id="node21" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="722,433,789,459"/>
</map>
</div>

</div>
</div>
<a id="a4d178b47dde9c5e387a87d482463575d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d178b47dde9c5e387a87d482463575d">&#9670;&nbsp;</a></span>child_pairhopp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_pairhopp </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute pairhopp term (canonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00540">540</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="mltply_hubbard_core_8c_source.html#l00533">child_pairhopp_element()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, and <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>.</p>
<div class="fragment"><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off = 0;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0.0;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) firstprivate(i_max, X,off) private(j) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f">child_pairhopp_element</a>(j, tmp_v0, tmp_v1, X, &amp;off);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;}<span class="comment">/*double complex child_pairhopp*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_addf4f9287c995be7868555e50bbf898f"><div class="ttname"><a href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f">child_pairhopp_element</a></div><div class="ttdeci">double complex child_pairhopp_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute pairhopp term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00533">mltplyHubbardCore.c:533</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
</div><!-- fragment --><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_cgraph.png" border="0" usemap="#mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_cgraph" id="mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f" title="Compute pairhopp term of canonical Hubbard system. " alt="" coords="159,5,317,32"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="365,5,461,32"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="509,5,573,32"/>
</map>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_icgraph.png" border="0" usemap="#mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_icgraph" id="mltply_hubbard_8c_a4d178b47dde9c5e387a87d482463575d_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="159,230,265,257"/>
<area shape="rect" id="node3" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="313,230,371,257"/>
<area shape="rect" id="node4" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="665,15,819,42"/>
<area shape="rect" id="node7" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="458,129,578,155"/>
<area shape="rect" id="node9" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="454,331,582,358"/>
<area shape="rect" id="node15" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="446,179,590,206"/>
<area shape="rect" id="node16" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="443,230,593,257"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="419,63,617,104"/>
<area shape="rect" id="node19" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="686,230,798,257"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="461,382,575,409"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="464,433,572,459"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="874,70,979,97"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1035,255,1085,282"/>
<area shape="rect" id="node8" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="685,179,799,206"/>
<area shape="rect" id="node10" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="695,382,789,409"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="881,382,973,409"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="717,281,767,307"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="870,281,983,307"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="867,230,987,257"/>
<area shape="rect" id="node18" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="668,70,816,97"/>
<area shape="rect" id="node21" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="709,433,775,459"/>
</map>
</div>

</div>
</div>
<a id="a23af00b3160b075156e1c842bb3a879d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23af00b3160b075156e1c842bb3a879d">&#9670;&nbsp;</a></span>GC_child_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_exchange </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Exchange term (grandcanonical) in single process. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00791">791</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="mltply_hubbard_core_8c_source.html#l00582">GC_child_exchange_element()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, and <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off = 0;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0.0;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) \</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor">reduction(+:dam_pr) firstprivate(i_max, X,off) private(j) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5">GC_child_exchange_element</a>(j, tmp_v0, tmp_v1, X, &amp;off);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;}<span class="comment">/*double complex GC_child_exchange*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a85a5f403eb683e5ebee4ab40a8a390e5"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5">GC_child_exchange_element</a></div><div class="ttdeci">double complex GC_child_exchange_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute exchange term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00582">mltplyHubbardCore.c:582</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
</div><!-- fragment --><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_cgraph.png" border="0" usemap="#mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_cgraph" id="mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5" title="Compute exchange term of grandcanonical Hubbard system. " alt="" coords="192,5,384,32"/>
</map>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_icgraph.png" border="0" usemap="#mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_icgraph" id="mltply_hubbard_8c_a23af00b3160b075156e1c842bb3a879d_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="192,230,319,257"/>
<area shape="rect" id="node3" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="367,230,424,257"/>
<area shape="rect" id="node4" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="719,15,872,42"/>
<area shape="rect" id="node7" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="511,129,631,155"/>
<area shape="rect" id="node9" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="507,331,635,358"/>
<area shape="rect" id="node15" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="499,179,643,206"/>
<area shape="rect" id="node16" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="497,230,646,257"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="472,63,671,104"/>
<area shape="rect" id="node19" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="739,230,851,257"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="514,382,629,409"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="517,433,625,459"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="927,70,1033,97"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1088,255,1139,282"/>
<area shape="rect" id="node8" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="738,179,853,206"/>
<area shape="rect" id="node10" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="749,382,842,409"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="934,382,1026,409"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="770,281,821,307"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="923,281,1037,307"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="920,230,1040,257"/>
<area shape="rect" id="node18" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="721,70,869,97"/>
<area shape="rect" id="node21" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="762,433,829,459"/>
</map>
</div>

</div>
</div>
<a id="a59f11fc0359c4543168c6a6f61a1ec70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f11fc0359c4543168c6a6f61a1ec70">&#9670;&nbsp;</a></span>GC_child_general_hopp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_general_hopp </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Commpute hopping term (grandcanonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>Hopping integral </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00609">609</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="struct_8h_source.html#l00341">LargeList::A_spin</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00233">GC_CisAis()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00354">GC_CisAjt()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, <a class="el" href="struct_8h_source.html#l00332">LargeList::is1_spin</a>, <a class="el" href="struct_8h_source.html#l00333">LargeList::is2_spin</a>, <a class="el" href="struct_8h_source.html#l00346">LargeList::isA_spin</a>, and <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>.</p>

<p class="reference">Referenced by <a class="el" href="expec__cisajs_8c_source.html#l00188">expec_cisajs_HubbardGC()</a>, <a class="el" href="_pair_ex_hubbard_8c_source.html#l00037">GetPairExcitedStateHubbardGC()</a>, and <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, isite1, isite2, Asum, Adiff;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  Asum = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  Adiff = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">if</span> (isite1 == isite2) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) \</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">private(j) firstprivate(i_max,X,isite1, trans) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4">GC_CisAis</a>(j, tmp_v0, tmp_v1, X, isite1, trans) * trans;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  }<span class="comment">/*if (isite1 == isite2)*/</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) \</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">firstprivate(i_max,X,Asum,Adiff,isite1,isite2,trans) private(j,tmp_off) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a>(j, tmp_v0, tmp_v1, X, isite1, isite2, Asum, Adiff, trans, &amp;tmp_off) * trans;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}<span class="comment">/*double complex GC_child_general_hopp*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a257628b6ed79f7a93d3d2a9a957bc936"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a></div><div class="ttdeci">double complex GC_CisAjt(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V, long unsigned int *tmp_off)</div><div class="ttdoc"> term for grandcanonical Hubbard </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00354">mltplyHubbardCore.c:354</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00341">struct.h:341</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00333">struct.h:333</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00346">struct.h:346</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_acf3b726a0fbe639a2b7169210c3a24c4"><div class="ttname"><a href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4">GC_CisAis</a></div><div class="ttdeci">double complex GC_CisAis(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, double complex tmp_trans)</div><div class="ttdoc">Operation of  (Grandcanonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00233">mltplyHubbardCore.c:233</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_cgraph.png" border="0" usemap="#mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_cgraph" id="mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4" title="Operation of &#160;(Grandcanonical) " alt="" coords="213,5,301,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936" title=" term for grandcanonical Hubbard " alt="" coords="215,56,300,83"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="349,56,411,83"/>
</map>
</div>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_icgraph.png" border="0" usemap="#mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_icgraph" id="mltply_hubbard_8c_a59f11fc0359c4543168c6a6f61a1ec70_icgraph">
<area shape="rect" id="node2" href="expec__cisajs_8c.html#a0d30174954dc8ad83ceeba5932ece811" title="function of calculation for one body green&#39;s function for Hubbard GC model. " alt="" coords="231,259,406,285"/>
<area shape="rect" id="node11" href="_pair_ex_hubbard_8c.html#aab52ec15363468b5cc7dd30215d889fe" title="GetPairExcitedStateHubbardGC" alt="" coords="213,360,424,387"/>
<area shape="rect" id="node15" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="255,309,382,336"/>
<area shape="rect" id="node3" href="expec__cisajs_8c.html#aaaa7c9da11d8ae60fe21f1d046358a6c" title="function of calculation for one body green&#39;s function " alt="" coords="711,107,810,133"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="927,259,1042,285"/>
<area shape="rect" id="node6" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="938,107,1031,133"/>
<area shape="rect" id="node7" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="1123,56,1215,83"/>
<area shape="rect" id="node8" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="959,208,1010,235"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1277,183,1328,209"/>
<area shape="rect" id="node9" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="1113,157,1226,184"/>
<area shape="rect" id="node10" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1109,208,1229,235"/>
<area shape="rect" id="node12" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="Calculating the pair excited state by the pair operator; &#160;&#160;&#160;, where &#160;indicates a creation (anti&#45;creat..." alt="" coords="472,469,613,496"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="Parent function to calculate the excited state. " alt="" coords="925,577,1044,604"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1117,499,1222,525"/>
<area shape="rect" id="node16" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="514,309,571,336"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="908,525,1061,552"/>
<area shape="rect" id="node18" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="701,360,821,387"/>
<area shape="rect" id="node19" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="697,157,825,184"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="689,259,833,285"/>
<area shape="rect" id="node21" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="686,309,835,336"/>
<area shape="rect" id="node22" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="661,462,860,503"/>
<area shape="rect" id="node24" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="929,360,1041,387"/>
<area shape="rect" id="node25" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="703,56,818,83"/>
<area shape="rect" id="node27" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="707,208,815,235"/>
<area shape="rect" id="node23" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="911,473,1059,500"/>
<area shape="rect" id="node26" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="951,5,1018,32"/>
</map>
</div>

</div>
</div>
<a id="a70e66e6ab9f74ec21130ed2363e24a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70e66e6ab9f74ec21130ed2363e24a51">&#9670;&nbsp;</a></span>GC_child_general_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_general_int </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute inter-all term (canonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00708">708</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="struct_8h_source.html#l00341">LargeList::A_spin</a>, <a class="el" href="struct_8h_source.html#l00342">LargeList::B_spin</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00834">GC_child_CisAisCisAis_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00865">GC_child_CisAisCjtAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00901">GC_child_CisAjtCkuAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00937">GC_child_CisAjtCkuAlv_element()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, <a class="el" href="struct_8h_source.html#l00332">LargeList::is1_spin</a>, <a class="el" href="struct_8h_source.html#l00333">LargeList::is2_spin</a>, <a class="el" href="struct_8h_source.html#l00334">LargeList::is3_spin</a>, <a class="el" href="struct_8h_source.html#l00335">LargeList::is4_spin</a>, <a class="el" href="struct_8h_source.html#l00346">LargeList::isA_spin</a>, <a class="el" href="struct_8h_source.html#l00347">LargeList::isB_spin</a>, <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>, and <a class="el" href="struct_8h_source.html#l00348">LargeList::tmp_V</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">double</span> complex dam_pr, tmp_V;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, i_max;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1, isite2, isite3, isite4;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum, Bsum, Adiff, Bdiff;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off = 0;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2 = 0;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  Asum = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  Adiff = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  Bsum = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  Bdiff = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  tmp_V = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">tmp_V</a>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  dam_pr = 0.0;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#pragma omp parallel default(none) reduction(+:dam_pr) private(j) \</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor">firstprivate(i_max, X, isite1, isite2, isite4, isite3, Asum, Bsum, Adiff, Bdiff, tmp_off, tmp_off_2, tmp_V) \</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor">shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (isite1 == isite2 &amp;&amp; isite3 == isite4) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }<span class="comment">/*if (isite1 == isite2 &amp;&amp; isite3 == isite4)*/</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 == isite2 &amp;&amp; isite3 != isite4) {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }<span class="comment">/*if (isite1 == isite2 &amp;&amp; isite3 != isite4)*/</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 != isite2 &amp;&amp; isite3 == isite4) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a>(</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          j, isite1, isite2, isite3, Asum, Adiff, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }<span class="comment">/*if (isite1 != isite2 &amp;&amp; isite3 == isite4)*/</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 != isite2 &amp;&amp; isite3 != isite4) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">#pragma omp for</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a>(</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, tmp_v0, tmp_v1, X, &amp;tmp_off_2);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }<span class="comment">/*if (isite1 != isite2 &amp;&amp; isite3 != isite4)*/</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  }<span class="comment">/*End of parallel region*/</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;}<span class="comment">/*double complex GC_child_general_int*/</span></div><div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00342">struct.h:342</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00335">struct.h:335</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00347">struct.h:347</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00341">struct.h:341</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a6e5c6a3af522a385b4ee60f66efb2557"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00834">mltplyHubbardCore.c:834</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00333">struct.h:333</a></div></div>
<div class="ttc" id="struct_large_list_html_ad706dd1a7ccaaa6f4e50cdcde74382a9"><div class="ttname"><a href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">LargeList::tmp_V</a></div><div class="ttdeci">double complex tmp_V</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00348">struct.h:348</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00346">struct.h:346</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a5a389f0d9543e02b5d2e19df0198bafc"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex GC_child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00865">mltplyHubbardCore.c:865</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ab7d585bf30bbcee8449b8c54d0bb128e"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00901">mltplyHubbardCore.c:901</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a6d06655a28258eea84191579396219e1"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00937">mltplyHubbardCore.c:937</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_cgraph.png" border="0" usemap="#mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_cgraph" id="mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="203,5,364,47"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="202,71,365,112"/>
<area shape="rect" id="node7" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="200,136,367,177"/>
<area shape="rect" id="node8" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="202,201,365,243"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="427,78,504,105"/>
<area shape="rect" id="node5" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="415,143,516,170"/>
<area shape="rect" id="node6" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="564,143,625,170"/>
</map>
</div>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_icgraph.png" border="0" usemap="#mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_icgraph" id="mltply_hubbard_8c_a70e66e6ab9f74ec21130ed2363e24a51_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="200,230,327,257"/>
<area shape="rect" id="node3" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="375,230,432,257"/>
<area shape="rect" id="node4" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="727,15,880,42"/>
<area shape="rect" id="node7" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="519,129,639,155"/>
<area shape="rect" id="node9" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="515,331,643,358"/>
<area shape="rect" id="node15" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="507,179,651,206"/>
<area shape="rect" id="node16" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="505,230,654,257"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="480,63,679,104"/>
<area shape="rect" id="node19" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="747,230,859,257"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="522,382,637,409"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="525,433,633,459"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="935,70,1041,97"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1096,255,1147,282"/>
<area shape="rect" id="node8" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="746,179,861,206"/>
<area shape="rect" id="node10" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="757,382,850,409"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="942,382,1034,409"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="778,281,829,307"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="931,281,1045,307"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="928,230,1048,257"/>
<area shape="rect" id="node18" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="729,70,877,97"/>
<area shape="rect" id="node21" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="770,433,837,459"/>
</map>
</div>

</div>
</div>
<a id="ad16f7b63b9768957a720004697a7a774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16f7b63b9768957a720004697a7a774">&#9670;&nbsp;</a></span>GC_child_pairhopp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_pairhopp </td>
          <td>(</td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute pairhopp term (grandcanonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00769">769</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="mltply_hubbard_core_8c_source.html#l00640">GC_child_pairhopp_element()</a>, <a class="el" href="struct_8h_source.html#l00317">LargeList::i_max</a>, and <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off = 0;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0.0;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) firstprivate(i_max,X,off) private(j) shared(tmp_v0, tmp_v1)</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt;= i_max; j++) </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    dam_pr += <a class="code" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">GC_child_pairhopp_element</a>(j, tmp_v0, tmp_v1, X, &amp;off);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}<span class="comment">/*double complex GC_child_pairhopp*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ab45a0a7e963c4c9d2d4bfa86ca5c44b8"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">GC_child_pairhopp_element</a></div><div class="ttdeci">double complex GC_child_pairhopp_element(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdoc">Compute pairhopp term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00640">mltplyHubbardCore.c:640</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdoc">Length of eigenvector. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00317">struct.h:317</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_cgraph.png" border="0" usemap="#mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_cgraph" id="mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8" title="Compute pairhopp term of grandcanonical Hubbard system. " alt="" coords="185,5,371,32"/>
</map>
</div>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_icgraph.png" border="0" usemap="#mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_icgraph" id="mltply_hubbard_8c_ad16f7b63b9768957a720004697a7a774_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="185,230,312,257"/>
<area shape="rect" id="node3" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="360,230,417,257"/>
<area shape="rect" id="node4" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="712,15,865,42"/>
<area shape="rect" id="node7" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="505,129,625,155"/>
<area shape="rect" id="node9" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="501,331,629,358"/>
<area shape="rect" id="node15" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="493,179,637,206"/>
<area shape="rect" id="node16" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="490,230,639,257"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="465,63,664,104"/>
<area shape="rect" id="node19" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="733,230,845,257"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="507,382,622,409"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="511,433,619,459"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="921,70,1026,97"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1081,255,1132,282"/>
<area shape="rect" id="node8" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="731,179,846,206"/>
<area shape="rect" id="node10" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="742,382,835,409"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="927,382,1019,409"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="763,281,814,307"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="917,281,1030,307"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="913,230,1033,257"/>
<area shape="rect" id="node18" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="715,70,863,97"/>
<area shape="rect" id="node21" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="755,433,822,459"/>
</map>
</div>

</div>
</div>
<a id="ae34b47523aa0e2619a18e316f3d1e930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34b47523aa0e2619a18e316f3d1e930">&#9670;&nbsp;</a></span>mltplyHubbard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mltplyHubbard </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform Hamiltonian vector product for (extended) Hubbard type model. \({\bf v}_0 = {\hat H}{\bf v}_1\) </p>
<dl class="section return"><dt>Returns</dt><dd>errorcode. 0 for normal, other error </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<p>Transfer</p>
<p>InterAll</p>
<p>Pair hopping</p>
<p>Exchange</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00150">150</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00033">CheckPE()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00561">child_exchange()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00197">child_exchange_GetInfo()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00582">child_general_hopp()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00034">child_general_hopp_GetInfo()</a>, <a class="el" href="mltply_m_p_i_hubbard_8c_source.html#l00334">child_general_hopp_MPIdouble()</a>, <a class="el" href="mltply_m_p_i_hubbard_8c_source.html#l00439">child_general_hopp_MPIsingle()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00645">child_general_int()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00076">child_general_int_GetInfo()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00540">child_pairhopp()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00169">child_pairhopp_GetInfo()</a>, <a class="el" href="struct_8h_source.html#l00410">BindStruct::Def</a>, <a class="el" href="struct_8h_source.html#l00110">DefineList::EDGeneralTransfer</a>, <a class="el" href="struct_8h_source.html#l00105">DefineList::EDNTransfer</a>, <a class="el" href="struct_8h_source.html#l00116">DefineList::EDParaGeneralTransfer</a>, <a class="el" href="struct_8h_source.html#l00146">DefineList::ExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00161">DefineList::InterAll_OffDiagonal</a>, <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00145">DefineList::NExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00165">DefineList::NInterAll_OffDiagonal</a>, <a class="el" href="struct_8h_source.html#l00139">DefineList::NPairHopping</a>, <a class="el" href="struct_8h_source.html#l00056">DefineList::Nsite</a>, <a class="el" href="struct_8h_source.html#l00092">DefineList::OrgTpow</a>, <a class="el" href="struct_8h_source.html#l00140">DefineList::PairHopping</a>, <a class="el" href="struct_8h_source.html#l00148">DefineList::ParaExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00170">DefineList::ParaInterAll_OffDiagonal</a>, <a class="el" href="struct_8h_source.html#l00142">DefineList::ParaPairHopping</a>, <a class="el" href="struct_8h_source.html#l00314">LargeList::prdct</a>, <a class="el" href="time_8c_source.html#l00071">StartTimer()</a>, <a class="el" href="time_8c_source.html#l00083">StopTimer()</a>, <a class="el" href="struct_8h_source.html#l00322">LargeList::tmp_trans</a>, <a class="el" href="global_8h_source.html#l00026">TRUE</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00829">X_child_CisAisCjtAjt_Hubbard_MPI()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l01310">X_child_CisAisCjtAku_Hubbard_MPI()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l01121">X_child_CisAjtCkuAku_Hubbard_MPI()</a>, and <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00907">X_child_CisAjtCkuAlv_Hubbard_MPI()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_8c_source.html#l00056">mltply()</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1, isite2, sigma1, sigma2;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3, isite4, sigma3, sigma4;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibitsite1, ibitsite2, ibitsite3, ibitsite4;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">double</span> complex tmp_trans;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">/*[s] For InterAll */</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">/*[e] For InterAll */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">int</span> ihermite=0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">int</span> idx=0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(300);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(310);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7d6c2b8989994d2a60ff8b70717799aa">EDNTransfer</a>; i+=2) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> &amp;&amp;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(311);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="mltply_m_p_i_hubbard_8c.html#ab1b2e0743624e8698eb36484166f92cc">child_general_hopp_MPIdouble</a>(i, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(311);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(312);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="mltply_m_p_i_hubbard_8c.html#aa938067934c1c1a813b5bbc5c94f9d26">child_general_hopp_MPIsingle</a>(i, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(312);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(312);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="mltply_m_p_i_hubbard_8c.html#aa938067934c1c1a813b5bbc5c94f9d26">child_general_hopp_MPIsingle</a>(i + 1, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(312);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(313);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">for</span> (ihermite = 0; ihermite&lt;2; ihermite++) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        idx = i + ihermite;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][0] + 1;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][2] + 1;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][1];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][3];</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a>(X, isite1, isite2, sigma1, sigma2) != 0) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        tmp_trans = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">EDParaGeneralTransfer</a>[idx];</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ad48959bc0a579f39cb1c77f7a9ec5dfb">tmp_trans</a> = tmp_trans;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        dam_pr = <a class="code" href="mltply_hubbard_8c.html#ac6de5fa85bba8abb6001cea5f4eae19e">child_general_hopp</a>(tmp_v0, tmp_v1, X, tmp_trans);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(313);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.EDNTransfer; i+=2)*/</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(310);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(320);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ae8d61074333f09b35dc8c0491e93617c">NInterAll_OffDiagonal</a>; i+=2) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        </div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][0] + 1;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][2] + 1;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][4] + 1;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][6] + 1;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][1];</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][3];</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][5];</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][7];</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    tmp_V = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[i];</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    dam_pr = 0.0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite1 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite2 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> ||</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite3 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite4 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(321);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      ibitsite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2*isite1-2+sigma1] ;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      ibitsite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite2 - 2 + sigma2];</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      ibitsite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite3 - 2 + sigma3];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      ibitsite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite4 - 2 + sigma4];</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">if</span> (ibitsite1 == ibitsite2 &amp;&amp; ibitsite3 == ibitsite4) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        dam_pr += <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#ac0c99cbb8b6107f22d5f98dda7c261c1">X_child_CisAisCjtAjt_Hubbard_MPI</a>(isite1 - 1, sigma1,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          isite3 - 1, sigma3,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibitsite1 == ibitsite2 &amp;&amp; ibitsite3 != ibitsite4) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        dam_pr += <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431">X_child_CisAisCjtAku_Hubbard_MPI</a>(isite1 - 1, sigma1,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          isite3 - 1, sigma3, isite4 - 1, sigma4,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibitsite1 != ibitsite2 &amp;&amp; ibitsite3 == ibitsite4) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        dam_pr += <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736">X_child_CisAjtCkuAku_Hubbard_MPI</a>(isite1 - 1, sigma1, isite2 - 1, sigma2,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          isite3 - 1, sigma3, tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibitsite1 != ibitsite2 &amp;&amp; ibitsite3 != ibitsite4) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        dam_pr += <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327">X_child_CisAjtCkuAlv_Hubbard_MPI</a>(isite1 - 1, sigma1, isite2 - 1, sigma2,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          isite3 - 1, sigma3, isite4 - 1, sigma4, tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(321);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(322);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">for</span> (ihermite = 0; ihermite &lt; 2; ihermite++) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        idx = i + ihermite;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][0] + 1;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][2] + 1;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][4] + 1;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][6] + 1;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][1];</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][3];</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][5];</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][7];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        tmp_V = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[idx];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a>(i, X, isite1, isite2, isite3, isite4, </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          sigma1, sigma2, sigma3, sigma4, tmp_V);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92">child_general_int</a>(tmp_v0, tmp_v1, X);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }<span class="comment">/*for (ihermite = 0; ihermite &lt; 2; ihermite++)*/</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(322);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.NInterAll_OffDiagonal; i+=2)*/</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(320);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(330);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7f69f45ef995623b96a7387c751da13d">NPairHopping</a>; i +=2) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    sigma1=0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    sigma2=1;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    dam_pr = 0.0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> ( X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      || X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][1] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(331);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327">X_child_CisAjtCkuAlv_Hubbard_MPI</a>(</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][0], sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][1], sigma1, </div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][0], sigma2, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][1], sigma2, </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">ParaPairHopping</a>[i], X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(331);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(332);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">for</span> (ihermite = 0; ihermite&lt;2; ihermite++) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        idx = i + ihermite;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a>(idx, X);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_8c.html#a4d178b47dde9c5e387a87d482463575d">child_pairhopp</a>(tmp_v0, tmp_v1, X);            </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      }<span class="comment">/*for (ihermite = 0; ihermite&lt;2; ihermite++)*/</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(332);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.NPairHopping; i += 2)*/</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(330);  </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(340);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ab50dd294ed527884a215792cb844204b">NExchangeCoupling</a>; i ++) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    sigma1 = 0;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    sigma2 = 1;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    dam_pr=0.0;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> ||</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][1] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(341);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327">X_child_CisAjtCkuAlv_Hubbard_MPI</a>(</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][0], sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][1], sigma1,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][1], sigma2, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][0], sigma2,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">ParaExchangeCoupling</a>[i], X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(341);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(342);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a>(i, X);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      dam_pr = <a class="code" href="mltply_hubbard_8c.html#a5821f04d36f42ce53a1d522dcb5548c5">child_exchange</a>(tmp_v0, tmp_v1, X);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(342);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.NExchangeCoupling; i ++)*/</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(340);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(300);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}<span class="comment">/*int mltplyHubbard*/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00410">struct.h:410</a></div></div>
<div class="ttc" id="time_8c_html_a2581cae87041a26e35cc11d2b36433ea"><div class="ttname"><a href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a></div><div class="ttdeci">void StartTimer(int n)</div><div class="ttdoc">function for initializing elapse time [start] </div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00071">time.c:71</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a14e2a1172cc6ad1cfd4a23c33a63b761"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a></div><div class="ttdeci">int CheckPE(int org_isite, struct BindStruct *X)</div><div class="ttdoc">Check whether this site is in the inter process region or not. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00033">mltplyMPIHubbardCore.c:33</a></div></div>
<div class="ttc" id="struct_define_list_html_aca15af1bddc7adf084cf01542a25f4c2"><div class="ttname"><a href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">DefineList::ExchangeCoupling</a></div><div class="ttdeci">int ** ExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling][2] Index of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00146">struct.h:146</a></div></div>
<div class="ttc" id="time_8c_html_a7a401c1e932bb7ff998602ee237fbecd"><div class="ttname"><a href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a></div><div class="ttdeci">void StopTimer(int n)</div><div class="ttdoc">function for calculating elapse time [elapse time=StartTimer-StopTimer] </div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00083">time.c:83</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a913be849115ac81f093256931b45bba2"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a></div><div class="ttdeci">int child_general_int_GetInfo(int iInterAll, struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdoc">Compute mask for bit operation of general interaction term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00076">mltplyHubbardCore.c:76</a></div></div>
<div class="ttc" id="struct_large_list_html_ac0e932f82f716485a2bb012dc05bc7c1"><div class="ttname"><a href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">LargeList::prdct</a></div><div class="ttdeci">double complex prdct</div><div class="ttdoc">The expectation value of the energy. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00314">struct.h:314</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a59452329e5c334718f67ab4d3d8b8431"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431">X_child_CisAisCjtAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAisCjtAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l01310">mltplyMPIHubbardCore.c:1310</a></div></div>
<div class="ttc" id="struct_define_list_html_ad3139436290b45f996399b9d139c2dd4"><div class="ttname"><a href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">DefineList::EDGeneralTransfer</a></div><div class="ttdeci">int ** EDGeneralTransfer</div><div class="ttdoc">Index of transfer integrals for calculation. malloc in setmem_def(). Data Format [DefineList::NTransf...</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00110">struct.h:110</a></div></div>
<div class="ttc" id="struct_define_list_html_a3265979ab4d2cc9c37463ae4642c6358"><div class="ttname"><a href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">DefineList::ParaInterAll_OffDiagonal</a></div><div class="ttdeci">double complex * ParaInterAll_OffDiagonal</div><div class="ttdoc">[DefineList::NInterAll_OffDiagonal] Coupling constant of off-diagonal inter-all term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00170">struct.h:170</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_ac0c99cbb8b6107f22d5f98dda7c261c1"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#ac0c99cbb8b6107f22d5f98dda7c261c1">X_child_CisAisCjtAjt_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAisCjtAjt_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00829">mltplyMPIHubbardCore.c:829</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00026">global.h:26</a></div></div>
<div class="ttc" id="struct_define_list_html_ae8d61074333f09b35dc8c0491e93617c"><div class="ttname"><a href="struct_define_list.html#ae8d61074333f09b35dc8c0491e93617c">DefineList::NInterAll_OffDiagonal</a></div><div class="ttdeci">unsigned int NInterAll_OffDiagonal</div><div class="ttdoc">Number of interall term (off-diagonal) </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00165">struct.h:165</a></div></div>
<div class="ttc" id="struct_define_list_html_acf2546cf5a91658ba830d3c9246ee13f"><div class="ttname"><a href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">DefineList::InterAll_OffDiagonal</a></div><div class="ttdeci">int ** InterAll_OffDiagonal</div><div class="ttdoc">[DefineList::NinterAll_OffDiagonal][8] Interacted quartet </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00161">struct.h:161</a></div></div>
<div class="ttc" id="struct_define_list_html_a66b5c042047526bfb2665961598bc563"><div class="ttname"><a href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">DefineList::OrgTpow</a></div><div class="ttdeci">long unsigned int * OrgTpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00092">struct.h:92</a></div></div>
<div class="ttc" id="struct_define_list_html_ad60b3e75def64fc7dbdcd484236419eb"><div class="ttname"><a href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">DefineList::PairHopping</a></div><div class="ttdeci">int ** PairHopping</div><div class="ttdoc">[DefineList::NPairHopping][2] Index of pair-hopping. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00140">struct.h:140</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_ac6de5fa85bba8abb6001cea5f4eae19e"><div class="ttname"><a href="mltply_hubbard_8c.html#ac6de5fa85bba8abb6001cea5f4eae19e">child_general_hopp</a></div><div class="ttdeci">double complex child_general_hopp(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, double complex trans)</div><div class="ttdoc">Compute hopping (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00582">mltplyHubbard.c:582</a></div></div>
<div class="ttc" id="struct_large_list_html_ad48959bc0a579f39cb1c77f7a9ec5dfb"><div class="ttname"><a href="struct_large_list.html#ad48959bc0a579f39cb1c77f7a9ec5dfb">LargeList::tmp_trans</a></div><div class="ttdeci">double complex tmp_trans</div><div class="ttdoc">Hopping parameter. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00322">struct.h:322</a></div></div>
<div class="ttc" id="struct_define_list_html_a854ba3669106f1f557d0c021c44430b6"><div class="ttname"><a href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">DefineList::ParaExchangeCoupling</a></div><div class="ttdeci">double * ParaExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling] Coupling constant of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00148">struct.h:148</a></div></div>
<div class="ttc" id="struct_define_list_html_acd881e170f064eb429a207412b8b64a2"><div class="ttname"><a href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">DefineList::Nsite</a></div><div class="ttdeci">unsigned int Nsite</div><div class="ttdoc">Number of sites in the INTRA process region. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00056">struct.h:56</a></div></div>
<div class="ttc" id="struct_define_list_html_a7759e4fbd1140e455dfec8fb7d126627"><div class="ttname"><a href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">DefineList::EDParaGeneralTransfer</a></div><div class="ttdeci">double complex * EDParaGeneralTransfer</div><div class="ttdoc">Value of general transfer integrals by a def file. malloc in setmem_def(). Data Format [DefineList::N...</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00116">struct.h:116</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_8c_html_ab1b2e0743624e8698eb36484166f92cc"><div class="ttname"><a href="mltply_m_p_i_hubbard_8c.html#ab1b2e0743624e8698eb36484166f92cc">child_general_hopp_MPIdouble</a></div><div class="ttdeci">void child_general_hopp_MPIdouble(unsigned long int itrans, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Hopping term in Hubbard (Kondo) + Canonical ensemble When both site1 and site2 are in the inter proce...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_8c_source.html#l00334">mltplyMPIHubbard.c:334</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a7fbaf32cf6b714a4304e20db480b5404"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a></div><div class="ttdeci">int child_pairhopp_GetInfo(int iPairHopp, struct BindStruct *X)</div><div class="ttdoc">Compute mask for bit operation of pairhop term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00169">mltplyHubbardCore.c:169</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_ac3f88b541387e7b9b13758fa855b9327"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327">X_child_CisAjtCkuAlv_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAjtCkuAlv_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00907">mltplyMPIHubbardCore.c:907</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a67618b30efd1e0dddf58b89407e13736"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736">X_child_CisAjtCkuAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_child_CisAjtCkuAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of canonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l01121">mltplyMPIHubbardCore.c:1121</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_aef9d79bf221699cecaa1b65b374e5b92"><div class="ttname"><a href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92">child_general_int</a></div><div class="ttdeci">double complex child_general_int(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute inter-all term (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00645">mltplyHubbard.c:645</a></div></div>
<div class="ttc" id="struct_define_list_html_ab50dd294ed527884a215792cb844204b"><div class="ttname"><a href="struct_define_list.html#ab50dd294ed527884a215792cb844204b">DefineList::NExchangeCoupling</a></div><div class="ttdeci">unsigned int NExchangeCoupling</div><div class="ttdoc">Number of exchange term. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00145">struct.h:145</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_a4d178b47dde9c5e387a87d482463575d"><div class="ttname"><a href="mltply_hubbard_8c.html#a4d178b47dde9c5e387a87d482463575d">child_pairhopp</a></div><div class="ttdeci">double complex child_pairhopp(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute pairhopp term (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00540">mltplyHubbard.c:540</a></div></div>
<div class="ttc" id="struct_define_list_html_a7f69f45ef995623b96a7387c751da13d"><div class="ttname"><a href="struct_define_list.html#a7f69f45ef995623b96a7387c751da13d">DefineList::NPairHopping</a></div><div class="ttdeci">unsigned int NPairHopping</div><div class="ttdoc">Number of pair-hopping term. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00139">struct.h:139</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ad2c9c4176ec4f0f7d5087a890467a264"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a></div><div class="ttdeci">int child_general_hopp_GetInfo(struct BindStruct *X, unsigned long int isite1, unsigned long int isite2, unsigned long int sigma1, unsigned long int sigma2)</div><div class="ttdoc">Compute mask for bit operation of hopping term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00034">mltplyHubbardCore.c:34</a></div></div>
<div class="ttc" id="struct_define_list_html_ad5e8872cb5fff4eebf3e8b8f1c42ec8e"><div class="ttname"><a href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">DefineList::ParaPairHopping</a></div><div class="ttdeci">double * ParaPairHopping</div><div class="ttdoc">[DefineList::NPairHopping] Coupling constant of pair-hopping term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00142">struct.h:142</a></div></div>
<div class="ttc" id="struct_define_list_html_a7d6c2b8989994d2a60ff8b70717799aa"><div class="ttname"><a href="struct_define_list.html#a7d6c2b8989994d2a60ff8b70717799aa">DefineList::EDNTransfer</a></div><div class="ttdeci">unsigned int EDNTransfer</div><div class="ttdoc">Number of transfer integrals for calculation. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00105">struct.h:105</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_a5821f04d36f42ce53a1d522dcb5548c5"><div class="ttname"><a href="mltply_hubbard_8c.html#a5821f04d36f42ce53a1d522dcb5548c5">child_exchange</a></div><div class="ttdeci">double complex child_exchange(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute Exchange term (canonical) in single process. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00561">mltplyHubbard.c:561</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_8c_html_aa938067934c1c1a813b5bbc5c94f9d26"><div class="ttname"><a href="mltply_m_p_i_hubbard_8c.html#aa938067934c1c1a813b5bbc5c94f9d26">child_general_hopp_MPIsingle</a></div><div class="ttdeci">void child_general_hopp_MPIsingle(unsigned long int itrans, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Hopping term in Hubbard (Kondo) + Canonical ensemble When only site2 is in the inter process region...</div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_8c_source.html#l00439">mltplyMPIHubbard.c:439</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a4765a56a883cd352b3f08546fc3bff08"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a></div><div class="ttdeci">int child_exchange_GetInfo(int iExchange, struct BindStruct *X)</div><div class="ttdoc">Compute mask for bit operation of exchange term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00197">mltplyHubbardCore.c:197</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_cgraph.png" border="0" usemap="#mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_cgraph" id="mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_cgraph">
<area shape="rect" id="node2" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761" title="Check whether this site is in the inter process region or not. " alt="" coords="1056,1159,1135,1185"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#a5821f04d36f42ce53a1d522dcb5548c5" title="Compute Exchange term (canonical) in single process. " alt="" coords="189,215,301,241"/>
<area shape="rect" id="node7" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08" title="Compute mask for bit operation of exchange term. " alt="" coords="163,379,326,405"/>
<area shape="rect" id="node8" href="mltply_hubbard_8c.html#ac6de5fa85bba8abb6001cea5f4eae19e" title="Compute hopping (canonical) " alt="" coords="393,649,527,676"/>
<area shape="rect" id="node11" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264" title="Compute mask for bit operation of hopping term. " alt="" coords="178,481,311,522"/>
<area shape="rect" id="node12" href="mltply_m_p_i_hubbard_8c.html#ab1b2e0743624e8698eb36484166f92cc" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When both site1 and site2 are in the inter proce..." alt="" coords="393,158,527,199"/>
<area shape="rect" id="node15" href="mltply_m_p_i_hubbard_8c.html#aa938067934c1c1a813b5bbc5c94f9d26" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When only site2 is in the inter process region..." alt="" coords="393,223,527,265"/>
<area shape="rect" id="node17" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="401,529,519,556"/>
<area shape="rect" id="node25" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2" title="Compute mask for bit operation of general interaction term. " alt="" coords="160,699,329,725"/>
<area shape="rect" id="node26" href="mltply_hubbard_8c.html#a4d178b47dde9c5e387a87d482463575d" title="Compute pairhopp term (canonical) " alt="" coords="407,31,513,57"/>
<area shape="rect" id="node28" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404" title="Compute mask for bit operation of pairhop term. " alt="" coords="167,816,322,843"/>
<area shape="rect" id="node29" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea" title="function for initializing elapse time [start] " alt="" coords="203,867,286,893"/>
<area shape="rect" id="node30" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd" title="function for calculating elapse time [elapse time=StartTimer&#45;StopTimer] " alt="" coords="203,917,286,944"/>
<area shape="rect" id="node31" href="mltply_m_p_i_hubbard_core_8c.html#ac0c99cbb8b6107f22d5f98dda7c261c1" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="388,1126,532,1167"/>
<area shape="rect" id="node34" href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="385,958,535,999"/>
<area shape="rect" id="node35" href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="613,927,767,969"/>
<area shape="rect" id="node39" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="169,750,320,791"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59" title="Compute exchange term of canonical&#45;Hubbard. " alt="" coords="377,107,543,133"/>
<area shape="rect" id="node5" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="1047,208,1143,235"/>
<area shape="rect" id="node6" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="1195,208,1259,235"/>
<area shape="rect" id="node9" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928" title=" term for canonical Hubbard " alt="" coords="887,653,946,680"/>
<area shape="rect" id="node10" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="1196,597,1257,624"/>
<area shape="rect" id="node13" href="mltply_m_p_i_hubbard_8c.html#aed2861272c984ba51e9c76bdbdfad67f" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When both site1 and site2 are in the inter proce..." alt="" coords="615,158,765,199"/>
<area shape="rect" id="node14" href="wrapper_m_p_i_8c.html#ae0504dbbe2857fc4f3c84ef0b7bc45ed" title="MPI Abortation wrapper. " alt="" coords="883,309,950,336"/>
<area shape="rect" id="node16" href="mltply_m_p_i_hubbard_8c.html#af402c076da283e62da488dbd305f36cf" title="Hopping term in Hubbard (Kondo) + Canonical ensemble When only site2 is in the inter process region..." alt="" coords="615,223,765,265"/>
<area shape="rect" id="node18" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="623,391,757,433"/>
<area shape="rect" id="node20" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="623,457,757,498"/>
<area shape="rect" id="node23" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="621,522,759,563"/>
<area shape="rect" id="node24" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="623,587,757,629"/>
<area shape="rect" id="node19" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="878,471,955,497"/>
<area shape="rect" id="node21" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. " alt="" coords="879,529,954,556"/>
<area shape="rect" id="node22" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="1045,597,1146,624"/>
<area shape="rect" id="node27" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f" title="Compute pairhopp term of canonical Hubbard system. " alt="" coords="837,5,996,32"/>
<area shape="rect" id="node32" href="mltply_m_p_i_hubbard_core_8c.html#ad7c739742ce1cad082947c7f647d1289" title="Check the occupation of both site 1 and site 3. " alt="" coords="855,1159,979,1185"/>
<area shape="rect" id="node33" href="mltply_m_p_i_hubbard_core_8c.html#a4a379d4c2b9e6fd33972c1049c57a26a" title="Check the occupation of &#160;state, and compute the index of final wavefunction associated to ..." alt="" coords="1046,1032,1145,1059"/>
<area shape="rect" id="node36" href="mltply_m_p_i_hubbard_core_8c.html#a030d235af73dc5a86e82993363153156" title="Compute the index of final wavefunction associated to , and check whether this operator is relevant o..." alt="" coords="845,1057,988,1084"/>
<area shape="rect" id="node38" href="mltply_m_p_i_hubbard_core_8c.html#a81ceaf1edd9e416156a2430f36ca6de3" title="Compute the index of final wavefunction associated to , and Fermion sign. " alt="" coords="863,889,970,916"/>
<area shape="rect" id="node37" href="mltply_m_p_i_hubbard_core_8c.html#ae4ad198537fcc87eb94dba8535607204" title="Check the occupation of &#160;state, and compute the index of final wavefunction associated to ..." alt="" coords="1044,1083,1147,1109"/>
<area shape="rect" id="node40" href="mltply_m_p_i_hubbard_core_8c.html#ac2399f2f6269841904d827a67af2c2f5" title="X_child_CisAis_Hubbard_MPI" alt="" coords="591,755,789,781"/>
</map>
</div>
<div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_icgraph.png" border="0" usemap="#mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_icgraph" id="mltply_hubbard_8c_ae34b47523aa0e2619a18e316f3d1e930_icgraph">
<area shape="rect" id="node2" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="160,230,217,257"/>
<area shape="rect" id="node3" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="512,15,665,42"/>
<area shape="rect" id="node6" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="305,129,425,155"/>
<area shape="rect" id="node8" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="301,331,429,358"/>
<area shape="rect" id="node14" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="293,179,437,206"/>
<area shape="rect" id="node15" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="290,230,439,257"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="265,63,464,104"/>
<area shape="rect" id="node18" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="533,230,645,257"/>
<area shape="rect" id="node19" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="307,382,422,409"/>
<area shape="rect" id="node21" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="311,433,419,459"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="721,70,826,97"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="881,255,932,282"/>
<area shape="rect" id="node7" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="531,179,646,206"/>
<area shape="rect" id="node9" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="542,382,635,409"/>
<area shape="rect" id="node10" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="727,382,819,409"/>
<area shape="rect" id="node11" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="563,281,614,307"/>
<area shape="rect" id="node12" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="717,281,830,307"/>
<area shape="rect" id="node13" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="713,230,833,257"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="515,70,663,97"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="555,433,622,459"/>
</map>
</div>

</div>
</div>
<a id="a3a8ead6d49a5b1621694d91c05ee3dc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8ead6d49a5b1621694d91c05ee3dc2">&#9670;&nbsp;</a></span>mltplyHubbardGC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mltplyHubbardGC </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). \({\bf v}_0 = {\hat H}{\bf v}_1\) </p>
<dl class="section return"><dt>Returns</dt><dd>errorcode. 0 for normal, other error </dd></dl>
<p>Transfer</p>
<p>Inter All</p>
<p>Pair hopping</p>
<p>Exchange</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mltply_hubbard_8c_source.html#l00347">347</a> of file <a class="el" href="mltply_hubbard_8c_source.html">mltplyHubbard.c</a>.</p>

<p class="reference">References <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00033">CheckPE()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00197">child_exchange_GetInfo()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00034">child_general_hopp_GetInfo()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00076">child_general_int_GetInfo()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00169">child_pairhopp_GetInfo()</a>, <a class="el" href="struct_8h_source.html#l00410">BindStruct::Def</a>, <a class="el" href="struct_8h_source.html#l00110">DefineList::EDGeneralTransfer</a>, <a class="el" href="struct_8h_source.html#l00105">DefineList::EDNTransfer</a>, <a class="el" href="struct_8h_source.html#l00116">DefineList::EDParaGeneralTransfer</a>, <a class="el" href="struct_8h_source.html#l00146">DefineList::ExchangeCoupling</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00791">GC_child_exchange()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00609">GC_child_general_hopp()</a>, <a class="el" href="mltply_m_p_i_hubbard_8c_source.html#l00033">GC_child_general_hopp_MPIdouble()</a>, <a class="el" href="mltply_m_p_i_hubbard_8c_source.html#l00211">GC_child_general_hopp_MPIsingle()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00708">GC_child_general_int()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00769">GC_child_pairhopp()</a>, <a class="el" href="struct_8h_source.html#l00161">DefineList::InterAll_OffDiagonal</a>, <a class="el" href="struct_8h_source.html#l00412">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00145">DefineList::NExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00165">DefineList::NInterAll_OffDiagonal</a>, <a class="el" href="struct_8h_source.html#l00139">DefineList::NPairHopping</a>, <a class="el" href="struct_8h_source.html#l00056">DefineList::Nsite</a>, <a class="el" href="struct_8h_source.html#l00092">DefineList::OrgTpow</a>, <a class="el" href="struct_8h_source.html#l00140">DefineList::PairHopping</a>, <a class="el" href="struct_8h_source.html#l00148">DefineList::ParaExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00170">DefineList::ParaInterAll_OffDiagonal</a>, <a class="el" href="struct_8h_source.html#l00142">DefineList::ParaPairHopping</a>, <a class="el" href="struct_8h_source.html#l00314">LargeList::prdct</a>, <a class="el" href="time_8c_source.html#l00071">StartTimer()</a>, <a class="el" href="time_8c_source.html#l00083">StopTimer()</a>, <a class="el" href="global_8h_source.html#l00026">TRUE</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00263">X_GC_child_CisAisCjtAjt_Hubbard_MPI()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00514">X_GC_child_CisAisCjtAku_Hubbard_MPI()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00343">X_GC_child_CisAjtCkuAku_Hubbard_MPI()</a>, and <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00541">X_GC_child_CisAjtCkuAlv_Hubbard_MPI()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mltply_8c_source.html#l00056">mltply()</a>.</p>
<div class="fragment"><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1, isite2, sigma1, sigma2;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite3, isite4, sigma3, sigma4;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibitsite1, ibitsite2, ibitsite3, ibitsite4;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">double</span> complex tmp_trans;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">/*[s] For InterAll */</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">double</span> complex tmp_V;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">/*[e] For InterAll */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">int</span> ihermite=0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">int</span> idx=0;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(200);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(210);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7d6c2b8989994d2a60ff8b70717799aa">EDNTransfer</a>; i += 2) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a> &amp;&amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(211);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="mltply_m_p_i_hubbard_8c.html#a7a8d32b95ea4b6d9b943d35d67deb88b">GC_child_general_hopp_MPIdouble</a>(i, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(211);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>){</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(212);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="mltply_m_p_i_hubbard_8c.html#a83da98c99feda75fe253ef0177bbb9ab">GC_child_general_hopp_MPIsingle</a>(i, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(212);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(212);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <a class="code" href="mltply_m_p_i_hubbard_8c.html#a83da98c99feda75fe253ef0177bbb9ab">GC_child_general_hopp_MPIsingle</a>(i+1, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(212);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(213);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">for</span> (ihermite = 0; ihermite&lt;2; ihermite++) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        idx = i + ihermite;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][0] + 1;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][2] + 1;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][1];</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[idx][3];</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a>(X, isite1, isite2, sigma1, sigma2) != 0) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        tmp_trans = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">EDParaGeneralTransfer</a>[idx];</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        dam_pr = <a class="code" href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70">GC_child_general_hopp</a>(tmp_v0, tmp_v1, X, tmp_trans);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(213);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.EDNTransfer; i += 2)*/</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(210);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(220);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ae8d61074333f09b35dc8c0491e93617c">NInterAll_OffDiagonal</a>; i+=2) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][0] + 1;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][2] + 1;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][4] + 1;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][6] + 1;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][1];</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][3];</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][5];</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][7];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    tmp_V = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[i];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite1 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite2 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite3 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a>(isite4 - 1, X) == <a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(221);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      ibitsite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite1 - 2 + sigma1];</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      ibitsite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite2 - 2 + sigma2];</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      ibitsite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite3 - 2 + sigma3];</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      ibitsite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">OrgTpow</a>[2 * isite4 - 2 + sigma4];</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">if</span> (ibitsite1 == ibitsite2 &amp;&amp; ibitsite3 == ibitsite4) </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a571209928d6c7125abd413555f89d748">X_GC_child_CisAisCjtAjt_Hubbard_MPI</a>(</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          isite1 - 1, sigma1, isite3 - 1, sigma3, tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibitsite1 == ibitsite2 &amp;&amp; ibitsite3 != ibitsite4) </div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60">X_GC_child_CisAisCjtAku_Hubbard_MPI</a>(</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          isite1 - 1, sigma1, isite3 - 1, sigma3, isite4 - 1, sigma4, tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibitsite1 != ibitsite2 &amp;&amp; ibitsite3 == ibitsite4) </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866">X_GC_child_CisAjtCkuAku_Hubbard_MPI</a>(</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;          isite1 - 1, sigma1, isite2 - 1, sigma2, isite3 - 1, sigma3, tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibitsite1 != ibitsite2 &amp;&amp; ibitsite3 != ibitsite4) </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a>(</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          isite1 - 1, sigma1, isite2 - 1, sigma2, isite3 - 1, sigma3, isite4 - 1, sigma4, tmp_V, X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(221);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }<span class="comment">//InterPE</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(222);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      dam_pr=0.0;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">for</span>(ihermite=0; ihermite&lt;2; ihermite++){</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        idx=i+ihermite;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][0] + 1;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][2] + 1;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][4] + 1;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][6] + 1;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][1];</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][3];</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][5];</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[idx][7];</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        tmp_V = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[idx];</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a>(i, X, isite1, isite2, isite3, isite4, </div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                        sigma1, sigma2, sigma3, sigma4, tmp_V); </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51">GC_child_general_int</a>(tmp_v0, tmp_v1, X);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      }<span class="comment">/*for(ihermite=0; ihermite&lt;2; ihermite++)*/</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(222);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.NInterAll_OffDiagonal; i+=2)*/</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(220);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(230);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7f69f45ef995623b96a7387c751da13d">NPairHopping</a>; i +=2) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    sigma1 = 0;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    sigma2 = 1;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    dam_pr = 0.0;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> ( X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      || X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][1] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(231);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a>(</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][0], sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][1], sigma1,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][0], sigma2, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[i][1], sigma2,</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">ParaPairHopping</a>[i], X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(231);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(232);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">for</span> (ihermite = 0; ihermite&lt;2; ihermite++) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        idx = i + ihermite;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a>(idx, X);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        dam_pr += <a class="code" href="mltply_hubbard_8c.html#ad16f7b63b9768957a720004697a7a774">GC_child_pairhopp</a>(tmp_v0, tmp_v1, X);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      }<span class="comment">/*for (ihermite = 0; ihermite&lt;2; ihermite++)*/</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(232);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.NPairHopping; i += 2)*/</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(230);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(240);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ab50dd294ed527884a215792cb844204b">NExchangeCoupling</a>; i++) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    sigma1=0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    sigma2=1;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    dam_pr=0.0;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> ( X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][0] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      || X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][1] + 1 &gt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">Nsite</a>) </div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(241);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      dam_pr = <a class="code" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a>(</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][0], sigma1, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][1], sigma1,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][1], sigma2, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[i][0], sigma2,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">ParaExchangeCoupling</a>[i], X, tmp_v0, tmp_v1);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(241);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a>(242);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <a class="code" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a>(i, X);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      dam_pr = <a class="code" href="mltply_hubbard_8c.html#a23af00b3160b075156e1c842bb3a879d">GC_child_exchange</a>(tmp_v0, tmp_v1, X);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(242);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a> += dam_pr;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }<span class="comment">/*for (i = 0; i &lt; X-&gt;Def.NExchangeCoupling; i++)*/</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(240);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a>(200);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}<span class="comment">/*int mltplyHubbardGC*/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00410">struct.h:410</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_a23af00b3160b075156e1c842bb3a879d"><div class="ttname"><a href="mltply_hubbard_8c.html#a23af00b3160b075156e1c842bb3a879d">GC_child_exchange</a></div><div class="ttdeci">double complex GC_child_exchange(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute Exchange term (grandcanonical) in single process. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00791">mltplyHubbard.c:791</a></div></div>
<div class="ttc" id="time_8c_html_a2581cae87041a26e35cc11d2b36433ea"><div class="ttname"><a href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea">StartTimer</a></div><div class="ttdeci">void StartTimer(int n)</div><div class="ttdoc">function for initializing elapse time [start] </div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00071">time.c:71</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a14e2a1172cc6ad1cfd4a23c33a63b761"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761">CheckPE</a></div><div class="ttdeci">int CheckPE(int org_isite, struct BindStruct *X)</div><div class="ttdoc">Check whether this site is in the inter process region or not. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00033">mltplyMPIHubbardCore.c:33</a></div></div>
<div class="ttc" id="struct_define_list_html_aca15af1bddc7adf084cf01542a25f4c2"><div class="ttname"><a href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">DefineList::ExchangeCoupling</a></div><div class="ttdeci">int ** ExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling][2] Index of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00146">struct.h:146</a></div></div>
<div class="ttc" id="time_8c_html_a7a401c1e932bb7ff998602ee237fbecd"><div class="ttname"><a href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd">StopTimer</a></div><div class="ttdeci">void StopTimer(int n)</div><div class="ttdoc">function for calculating elapse time [elapse time=StartTimer-StopTimer] </div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00083">time.c:83</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a913be849115ac81f093256931b45bba2"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a></div><div class="ttdeci">int child_general_int_GetInfo(int iInterAll, struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdoc">Compute mask for bit operation of general interaction term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00076">mltplyHubbardCore.c:76</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a11e540019dd7ff6b6b611767d483fa60"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60">X_GC_child_CisAisCjtAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjtAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00514">mltplyMPIHubbardCore.c:514</a></div></div>
<div class="ttc" id="struct_large_list_html_ac0e932f82f716485a2bb012dc05bc7c1"><div class="ttname"><a href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">LargeList::prdct</a></div><div class="ttdeci">double complex prdct</div><div class="ttdoc">The expectation value of the energy. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00314">struct.h:314</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00412">struct.h:412</a></div></div>
<div class="ttc" id="struct_define_list_html_ad3139436290b45f996399b9d139c2dd4"><div class="ttname"><a href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">DefineList::EDGeneralTransfer</a></div><div class="ttdeci">int ** EDGeneralTransfer</div><div class="ttdoc">Index of transfer integrals for calculation. malloc in setmem_def(). Data Format [DefineList::NTransf...</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00110">struct.h:110</a></div></div>
<div class="ttc" id="struct_define_list_html_a3265979ab4d2cc9c37463ae4642c6358"><div class="ttname"><a href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">DefineList::ParaInterAll_OffDiagonal</a></div><div class="ttdeci">double complex * ParaInterAll_OffDiagonal</div><div class="ttdoc">[DefineList::NInterAll_OffDiagonal] Coupling constant of off-diagonal inter-all term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00170">struct.h:170</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00026">global.h:26</a></div></div>
<div class="ttc" id="struct_define_list_html_ae8d61074333f09b35dc8c0491e93617c"><div class="ttname"><a href="struct_define_list.html#ae8d61074333f09b35dc8c0491e93617c">DefineList::NInterAll_OffDiagonal</a></div><div class="ttdeci">unsigned int NInterAll_OffDiagonal</div><div class="ttdoc">Number of interall term (off-diagonal) </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00165">struct.h:165</a></div></div>
<div class="ttc" id="struct_define_list_html_acf2546cf5a91658ba830d3c9246ee13f"><div class="ttname"><a href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">DefineList::InterAll_OffDiagonal</a></div><div class="ttdeci">int ** InterAll_OffDiagonal</div><div class="ttdoc">[DefineList::NinterAll_OffDiagonal][8] Interacted quartet </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00161">struct.h:161</a></div></div>
<div class="ttc" id="struct_define_list_html_a66b5c042047526bfb2665961598bc563"><div class="ttname"><a href="struct_define_list.html#a66b5c042047526bfb2665961598bc563">DefineList::OrgTpow</a></div><div class="ttdeci">long unsigned int * OrgTpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00092">struct.h:92</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_8c_html_a7a8d32b95ea4b6d9b943d35d67deb88b"><div class="ttname"><a href="mltply_m_p_i_hubbard_8c.html#a7a8d32b95ea4b6d9b943d35d67deb88b">GC_child_general_hopp_MPIdouble</a></div><div class="ttdeci">void GC_child_general_hopp_MPIdouble(unsigned long int itrans, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Hopping term in Hubbard + GC When both site1 and site2 are in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_8c_source.html#l00033">mltplyMPIHubbard.c:33</a></div></div>
<div class="ttc" id="struct_define_list_html_ad60b3e75def64fc7dbdcd484236419eb"><div class="ttname"><a href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">DefineList::PairHopping</a></div><div class="ttdeci">int ** PairHopping</div><div class="ttdoc">[DefineList::NPairHopping][2] Index of pair-hopping. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00140">struct.h:140</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a571209928d6c7125abd413555f89d748"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a571209928d6c7125abd413555f89d748">X_GC_child_CisAisCjtAjt_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAisCjtAjt_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00263">mltplyMPIHubbardCore.c:263</a></div></div>
<div class="ttc" id="struct_define_list_html_a854ba3669106f1f557d0c021c44430b6"><div class="ttname"><a href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">DefineList::ParaExchangeCoupling</a></div><div class="ttdeci">double * ParaExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling] Coupling constant of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00148">struct.h:148</a></div></div>
<div class="ttc" id="struct_define_list_html_acd881e170f064eb429a207412b8b64a2"><div class="ttname"><a href="struct_define_list.html#acd881e170f064eb429a207412b8b64a2">DefineList::Nsite</a></div><div class="ttdeci">unsigned int Nsite</div><div class="ttdoc">Number of sites in the INTRA process region. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00056">struct.h:56</a></div></div>
<div class="ttc" id="struct_define_list_html_a7759e4fbd1140e455dfec8fb7d126627"><div class="ttname"><a href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">DefineList::EDParaGeneralTransfer</a></div><div class="ttdeci">double complex * EDParaGeneralTransfer</div><div class="ttdoc">Value of general transfer integrals by a def file. malloc in setmem_def(). Data Format [DefineList::N...</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00116">struct.h:116</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a7fbaf32cf6b714a4304e20db480b5404"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a></div><div class="ttdeci">int child_pairhopp_GetInfo(int iPairHopp, struct BindStruct *X)</div><div class="ttdoc">Compute mask for bit operation of pairhop term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00169">mltplyHubbardCore.c:169</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_a70e66e6ab9f74ec21130ed2363e24a51"><div class="ttname"><a href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51">GC_child_general_int</a></div><div class="ttdeci">double complex GC_child_general_int(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute inter-all term (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00708">mltplyHubbard.c:708</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_ad16f7b63b9768957a720004697a7a774"><div class="ttname"><a href="mltply_hubbard_8c.html#ad16f7b63b9768957a720004697a7a774">GC_child_pairhopp</a></div><div class="ttdeci">double complex GC_child_pairhopp(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdoc">Compute pairhopp term (grandcanonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00769">mltplyHubbard.c:769</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_8c_html_a83da98c99feda75fe253ef0177bbb9ab"><div class="ttname"><a href="mltply_m_p_i_hubbard_8c.html#a83da98c99feda75fe253ef0177bbb9ab">GC_child_general_hopp_MPIsingle</a></div><div class="ttdeci">void GC_child_general_hopp_MPIsingle(unsigned long int itrans, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Hopping term in Hubbard + GC When only site2 is in the inter process region. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_8c_source.html#l00211">mltplyMPIHubbard.c:211</a></div></div>
<div class="ttc" id="struct_define_list_html_ab50dd294ed527884a215792cb844204b"><div class="ttname"><a href="struct_define_list.html#ab50dd294ed527884a215792cb844204b">DefineList::NExchangeCoupling</a></div><div class="ttdeci">unsigned int NExchangeCoupling</div><div class="ttdoc">Number of exchange term. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00145">struct.h:145</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_a2d5b96ff0d102ab1501330d94d23d866"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866">X_GC_child_CisAjtCkuAku_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAjtCkuAku_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00343">mltplyMPIHubbardCore.c:343</a></div></div>
<div class="ttc" id="struct_define_list_html_a7f69f45ef995623b96a7387c751da13d"><div class="ttname"><a href="struct_define_list.html#a7f69f45ef995623b96a7387c751da13d">DefineList::NPairHopping</a></div><div class="ttdeci">unsigned int NPairHopping</div><div class="ttdoc">Number of pair-hopping term. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00139">struct.h:139</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_ad2c9c4176ec4f0f7d5087a890467a264"><div class="ttname"><a href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a></div><div class="ttdeci">int child_general_hopp_GetInfo(struct BindStruct *X, unsigned long int isite1, unsigned long int isite2, unsigned long int sigma1, unsigned long int sigma2)</div><div class="ttdoc">Compute mask for bit operation of hopping term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00034">mltplyHubbardCore.c:34</a></div></div>
<div class="ttc" id="struct_define_list_html_ad5e8872cb5fff4eebf3e8b8f1c42ec8e"><div class="ttname"><a href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">DefineList::ParaPairHopping</a></div><div class="ttdeci">double * ParaPairHopping</div><div class="ttdoc">[DefineList::NPairHopping] Coupling constant of pair-hopping term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00142">struct.h:142</a></div></div>
<div class="ttc" id="struct_define_list_html_a7d6c2b8989994d2a60ff8b70717799aa"><div class="ttname"><a href="struct_define_list.html#a7d6c2b8989994d2a60ff8b70717799aa">DefineList::EDNTransfer</a></div><div class="ttdeci">unsigned int EDNTransfer</div><div class="ttdoc">Number of transfer integrals for calculation. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00105">struct.h:105</a></div></div>
<div class="ttc" id="mltply_m_p_i_hubbard_core_8c_html_add9824527f147708e47dc84b8322600e"><div class="ttname"><a href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e">X_GC_child_CisAjtCkuAlv_Hubbard_MPI</a></div><div class="ttdeci">double complex X_GC_child_CisAjtCkuAlv_Hubbard_MPI(int org_isite1, int org_ispin1, int org_isite2, int org_ispin2, int org_isite3, int org_ispin3, int org_isite4, int org_ispin4, double complex tmp_V, struct BindStruct *X, double complex *tmp_v0, double complex *tmp_v1)</div><div class="ttdoc">Compute  term of grandcanonical Hubbard system. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_m_p_i_hubbard_core_8c_source.html#l00541">mltplyMPIHubbardCore.c:541</a></div></div>
<div class="ttc" id="mltply_hubbard_8c_html_a59f11fc0359c4543168c6a6f61a1ec70"><div class="ttname"><a href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70">GC_child_general_hopp</a></div><div class="ttdeci">double complex GC_child_general_hopp(double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, double complex trans)</div><div class="ttdoc">Commpute hopping term (grandcanonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_8c_source.html#l00609">mltplyHubbard.c:609</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a4765a56a883cd352b3f08546fc3bff08"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a></div><div class="ttdeci">int child_exchange_GetInfo(int iExchange, struct BindStruct *X)</div><div class="ttdoc">Compute mask for bit operation of exchange term. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00197">mltplyHubbardCore.c:197</a></div></div>
</div><!-- fragment --><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_cgraph.png" border="0" usemap="#mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_cgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_cgraph" id="mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_cgraph">
<area shape="rect" id="node2" href="mltply_m_p_i_hubbard_core_8c.html#a14e2a1172cc6ad1cfd4a23c33a63b761" title="Check whether this site is in the inter process region or not. " alt="" coords="1147,144,1225,170"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08" title="Compute mask for bit operation of exchange term. " alt="" coords="188,777,351,804"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264" title="Compute mask for bit operation of hopping term. " alt="" coords="203,828,336,870"/>
<area shape="rect" id="node5" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2" title="Compute mask for bit operation of general interaction term. " alt="" coords="185,894,354,921"/>
<area shape="rect" id="node6" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404" title="Compute mask for bit operation of pairhop term. " alt="" coords="192,945,347,972"/>
<area shape="rect" id="node7" href="mltply_hubbard_8c.html#a23af00b3160b075156e1c842bb3a879d" title="Compute Exchange term (grandcanonical) in single process. " alt="" coords="200,996,339,1022"/>
<area shape="rect" id="node9" href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70" title="Commpute hopping term (grandcanonical) " alt="" coords="189,98,349,125"/>
<area shape="rect" id="node13" href="mltply_m_p_i_hubbard_8c.html#a7a8d32b95ea4b6d9b943d35d67deb88b" title="Hopping term in Hubbard + GC When both site1 and site2 are in the inter process region. " alt="" coords="423,672,583,714"/>
<area shape="rect" id="node16" href="mltply_m_p_i_hubbard_8c.html#a83da98c99feda75fe253ef0177bbb9ab" title="Hopping term in Hubbard + GC When only site2 is in the inter process region. " alt="" coords="423,738,583,779"/>
<area shape="rect" id="node18" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="686,928,833,954"/>
<area shape="rect" id="node25" href="mltply_hubbard_8c.html#ad16f7b63b9768957a720004697a7a774" title="Compute pairhopp term (grandcanonical) " alt="" coords="203,1046,335,1073"/>
<area shape="rect" id="node27" href="time_8c.html#a2581cae87041a26e35cc11d2b36433ea" title="function for initializing elapse time [start] " alt="" coords="228,1097,311,1124"/>
<area shape="rect" id="node28" href="time_8c.html#a7a401c1e932bb7ff998602ee237fbecd" title="function for calculating elapse time [elapse time=StartTimer&#45;StopTimer] " alt="" coords="228,1148,311,1174"/>
<area shape="rect" id="node29" href="mltply_m_p_i_hubbard_core_8c.html#a571209928d6c7125abd413555f89d748" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="674,134,845,175"/>
<area shape="rect" id="node32" href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="413,403,592,444"/>
<area shape="rect" id="node33" href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="668,462,851,503"/>
<area shape="rect" id="node37" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="180,454,359,495"/>
<area shape="rect" id="node8" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5" title="Compute exchange term of grandcanonical Hubbard system. " alt="" coords="407,996,599,1022"/>
<area shape="rect" id="node10" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4" title="Operation of &#160;(Grandcanonical) " alt="" coords="459,98,547,125"/>
<area shape="rect" id="node11" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936" title=" term for grandcanonical Hubbard " alt="" coords="961,250,1046,277"/>
<area shape="rect" id="node12" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="1285,680,1347,706"/>
<area shape="rect" id="node14" href="mltply_m_p_i_hubbard_8c.html#a987bcd9d7be83743c90f148481ff5cd3" title="Hopping term in Hubbard + GC When both site1 and site2 are in the inter process region. " alt="" coords="689,672,830,714"/>
<area shape="rect" id="node15" href="wrapper_m_p_i_8c.html#ae0504dbbe2857fc4f3c84ef0b7bc45ed" title="MPI Abortation wrapper. " alt="" coords="970,625,1037,652"/>
<area shape="rect" id="node17" href="mltply_m_p_i_hubbard_8c.html#a89d8854d5f7b9da8c6ab596ac926caf9" title="Hopping term in Hubbard + GC When only site2 is in the inter process region. " alt="" coords="689,738,830,779"/>
<area shape="rect" id="node19" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="923,1051,1084,1092"/>
<area shape="rect" id="node21" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="922,920,1085,962"/>
<area shape="rect" id="node23" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="920,986,1087,1027"/>
<area shape="rect" id="node24" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="922,855,1085,896"/>
<area shape="rect" id="node20" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="1147,993,1225,1020"/>
<area shape="rect" id="node22" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="1135,833,1237,860"/>
<area shape="rect" id="node26" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8" title="Compute pairhopp term of grandcanonical Hubbard system. " alt="" coords="410,1046,595,1073"/>
<area shape="rect" id="node30" href="mltply_m_p_i_hubbard_core_8c.html#ad7c739742ce1cad082947c7f647d1289" title="Check the occupation of both site 1 and site 3. " alt="" coords="941,144,1065,170"/>
<area shape="rect" id="node31" href="mltply_m_p_i_hubbard_core_8c.html#a4a379d4c2b9e6fd33972c1049c57a26a" title="Check the occupation of &#160;state, and compute the index of final wavefunction associated to ..." alt="" coords="1137,301,1235,328"/>
<area shape="rect" id="node34" href="mltply_m_p_i_hubbard_core_8c.html#a030d235af73dc5a86e82993363153156" title="Compute the index of final wavefunction associated to , and check whether this operator is relevant o..." alt="" coords="932,352,1075,378"/>
<area shape="rect" id="node36" href="mltply_m_p_i_hubbard_core_8c.html#a81ceaf1edd9e416156a2430f36ca6de3" title="Compute the index of final wavefunction associated to , and Fermion sign. " alt="" coords="950,570,1057,597"/>
<area shape="rect" id="node35" href="mltply_m_p_i_hubbard_core_8c.html#ae4ad198537fcc87eb94dba8535607204" title="Check the occupation of &#160;state, and compute the index of final wavefunction associated to ..." alt="" coords="1135,352,1237,378"/>
<area shape="rect" id="node38" href="mltply_m_p_i_hubbard_core_8c.html#ab59deb7bc8d1509683aa8f2b376cbceb" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="647,301,872,328"/>
</map>
</div>
<div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_icgraph.png" border="0" usemap="#mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_icgraph" alt=""/></div>
<map name="mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_icgraph" id="mltply_hubbard_8c_a3a8ead6d49a5b1621694d91c05ee3dc2_icgraph">
<area shape="rect" id="node2" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="Parent function of multiplying the wavefunction by the Hamiltonian. . First, the calculation of diago..." alt="" coords="180,230,237,257"/>
<area shape="rect" id="node3" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="532,15,685,42"/>
<area shape="rect" id="node6" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="325,129,445,155"/>
<area shape="rect" id="node8" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="Parent function to calculate expected values of energy and physical quantities. " alt="" coords="321,331,449,358"/>
<area shape="rect" id="node14" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Main function for calculating eigen values by Lanczos method. The energy convergence is judged by the..." alt="" coords="313,179,457,206"/>
<area shape="rect" id="node15" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Calculate eigenvectors by the Lanczos method. &#160;The calculated tridiagonal matrix components &#160;are stor..." alt="" coords="310,230,459,257"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="285,63,484,104"/>
<area shape="rect" id="node18" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="553,230,665,257"/>
<area shape="rect" id="node19" href="_multiply_8c.html#a6f1bb639d327a924157a9e903a854d2c" title="Function of multiplying Hamiltonian for Time Evolution. " alt="" coords="327,382,442,409"/>
<area shape="rect" id="node21" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="331,433,439,459"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="741,70,846,97"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="901,255,952,282"/>
<area shape="rect" id="node7" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="551,179,666,206"/>
<area shape="rect" id="node9" href="_calc_by_t_e_m_8c.html#a95c436e25727f69519a98af30f6eb00d" title="main function of time evolution calculation " alt="" coords="562,382,655,409"/>
<area shape="rect" id="node10" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="A main function to calculate physical quqntities by TPQ method. " alt="" coords="747,382,839,409"/>
<area shape="rect" id="node11" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="583,281,634,307"/>
<area shape="rect" id="node12" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="Parent function for FullDiag mode. " alt="" coords="737,281,850,307"/>
<area shape="rect" id="node13" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="733,230,853,257"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ (Note: This method is trial) " alt="" coords="535,70,683,97"/>
<area shape="rect" id="node20" href="_multiply_8c.html#a8f840d0f8db7e5c75e241f8b223a098e" title="Function of calculating the i&#45;th step norm as &#160;and update the i+1&#45;th wave vector as &#160;for TPQ calculat..." alt="" coords="575,433,642,459"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="mltply_hubbard_8c.html">mltplyHubbard.c</a></li>
    <li class="footer">Generated on Mon Jul 1 2019 17:07:17 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

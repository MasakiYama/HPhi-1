<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HΦ: Add new lattice model into Standard mode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_addstandard.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Add new lattice model into Standard mode </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_stan_proc"></a>
Overall procedure</h1>
<p>If you want to create a new lattice file, the following procedures are needed.</p>
<ol type="1">
<li>Copy one of lattice files such as <a class="el" href="_kagome_8c.html" title="Standard mode for the kagome lattice. ">Kagome.c</a> (Probably the most similar one) and rename it.</li>
<li><a class="el" href="page_addstandard.html#sec_lattice">Modify lattice model file</a></li>
<li>Add the function in the header file, StdFace_ModelUtil.h.</li>
<li>Add entry at  <div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="_std_face__main_8c.html#ae55faf027f0fa2b17f99755b073ac171">StdFace_main</a>(</div><div class="line">  <span class="keywordtype">char</span> *fname</div><div class="line">)</div><div class="line">{</div><div class="line">  <span class="keyword">struct </span><a class="code" href="struct_std_int_list.html">StdIntList</a> *StdI;</div></div><!-- fragment --> : <div class="fragment"><div class="line">  <span class="comment">/*&gt;&gt;</span></div><div class="line"><span class="comment">  Generate Hamiltonian definition files</span></div><div class="line"><span class="comment">  */</span></div><div class="line">  <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;chain&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;chainlattice&quot;</span>) == 0) <a class="code" href="_chain_lattice_8c.html#a19e850725a6f5def8d78ee6b81d76160">StdFace_Chain</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;face-centeredorthorhombic&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;fcorthorhombic&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;fco&quot;</span>) == 0) <a class="code" href="_f_c_ortho_8c.html#a2a32d3a86f7cdf7bbb7d345be84d691d">StdFace_FCOrtho</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;honeycomb&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;honeycomblattice&quot;</span>) == 0) <a class="code" href="_honeycomb_lattice_8c.html#ad6d5522bfadda85057b31b89c25df32f">StdFace_Honeycomb</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;kagome&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;kagomelattice&quot;</span>) == 0) <a class="code" href="_kagome_8c.html#a4fcbd7403146f24148bcd917daf12068">StdFace_Kagome</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;ladder&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;ladderlattice&quot;</span>) == 0) <a class="code" href="_ladder_8c.html#a2d64104994aeea52623f67cce3e604e1">StdFace_Ladder</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;orthorhombic&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;simpleorthorhombic&quot;</span>) == 0) <a class="code" href="_orthorhombic_8c.html#a33fb6a1902e42ecafe2d1249640825b1">StdFace_Orthorhombic</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;pyrochlore&quot;</span>) == 0) <a class="code" href="_pyrochlore_8c.html#a1bb6dee1ad8080fcb79eb017d12bb2b7">StdFace_Pyrochlore</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;tetragonal&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;tetragonallattice&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;square&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;squarelattice&quot;</span>) == 0) <a class="code" href="_square_lattice_8c.html#a0449f65a4c6ec527da3e6ebb4253942e">StdFace_Tetragonal</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;triangular&quot;</span>) == 0</div><div class="line">    || strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;triangularlattice&quot;</span>) == 0) <a class="code" href="_triangular_lattice_8c.html#ad018d6d2847251fd450eb248032c97fe">StdFace_Triangular</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>, <span class="stringliteral">&quot;wannier90&quot;</span>) == 0) <a class="code" href="_wannier90_8c.html#ab4fe35c22a4d6f54807e3c5d786f8223">StdFace_Wannier90</a>(StdI);</div><div class="line">  <span class="keywordflow">else</span> <a class="code" href="_std_face__main_8c.html#a51d9cb31caa893c65d948e203e20621e">UnsupportedSystem</a>(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#af0085f9f67afe7851df5d4026a6ac67b">lattice</a>);<span class="comment">//&lt;&lt;</span></div></div><!-- fragment --></li>
</ol>
<hr/>
 <h1><a class="anchor" id="sec_lattice"></a>
Modify lattice model file</h1>
<p>To create a new lattice file, please modify the following part (<a class="el" href="_kagome_8c.html" title="Standard mode for the kagome lattice. ">Kagome.c</a> as an example):</p>
 Define function as <div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="_kagome_8c.html#a4fcbd7403146f24148bcd917daf12068">StdFace_Kagome</a>(</div><div class="line">  <span class="keyword">struct</span> <a class="code" href="struct_std_int_list.html">StdIntList</a> *StdI</div><div class="line">)</div><div class="line">{</div></div><!-- fragment --> Lattice parameters are used only in geometry.dat and lattice.gp <div class="fragment"><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;a&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a5dbe7cea79042fa567290f79dd116ce4">a</a>, 1.0);</div><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;Wlength&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a8485b7660203c940b6083a5e0bb96cb8">length</a>[0], StdI-&gt;<a class="code" href="struct_std_int_list.html#a5dbe7cea79042fa567290f79dd116ce4">a</a>);</div><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;Llength&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a8485b7660203c940b6083a5e0bb96cb8">length</a>[1], StdI-&gt;<a class="code" href="struct_std_int_list.html#a5dbe7cea79042fa567290f79dd116ce4">a</a>);</div><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;Wx&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a38754a3ac8c04adf8411ebe13054b991">direct</a>[0][0], StdI-&gt;<a class="code" href="struct_std_int_list.html#a8485b7660203c940b6083a5e0bb96cb8">length</a>[0]);</div><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;Wy&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a38754a3ac8c04adf8411ebe13054b991">direct</a>[0][1], 0.0);</div><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;Lx&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a38754a3ac8c04adf8411ebe13054b991">direct</a>[1][0], StdI-&gt;<a class="code" href="struct_std_int_list.html#a8485b7660203c940b6083a5e0bb96cb8">length</a>[1] * 0.5);</div><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a40c0095bc5329e343502d453f929fecc">StdFace_PrintVal_d</a>(<span class="stringliteral">&quot;Ly&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a38754a3ac8c04adf8411ebe13054b991">direct</a>[1][1], StdI-&gt;<a class="code" href="struct_std_int_list.html#a8485b7660203c940b6083a5e0bb96cb8">length</a>[1] * 0.5 * sqrt(3.0));</div></div><!-- fragment --> These are unit lattice vectors.<br />
Just call this function to initialize all lattice related parameters <div class="fragment"><div class="line">  <a class="code" href="_std_face___model_util_8c.html#a6080686c51f2da7c33ad0a1479d6efdd">StdFace_InitSite</a>(StdI, fp, 2);</div></div><!-- fragment --> where "2" indicates 2D. <div class="fragment"><div class="line">  StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[0][0] = 0.0; StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[0][1] = 0.0; StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[0][2] = 0.0;</div><div class="line">  StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[1][0] = 0.5; StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[1][1] = 0.0; StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[1][2] = 0.0;</div><div class="line">  StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[2][0] = 0.0; StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[2][1] = 0.5; StdI-&gt;<a class="code" href="struct_std_int_list.html#a4d397b052818481fc0085a0fcc4b706f">tau</a>[2][2] = 0.0;</div></div><!-- fragment --> These are the fractional coordinates of internal sites. Then set parameters of Hamiltonian <div class="fragment"><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J0&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a11467f4974cbe3c7658323813bd78df4">J0All</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a5f3e4d6a825664f646c4ed36a32e1cf4">J0</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J1&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#ac94d02e9aa8bc551b2491d94823492f7">J1All</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a1c6cd56756a2766bbd93691474f4feac">J1</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J2&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#ad1dbff8050b26811633ca96c650b6029">J2All</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a80d536f7221820b9f90f682e0b9ced98">J2</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J&#39;&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#aad96b35e2eb2e95986962f4d503292c7">JpAll</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a18017a0437363e575ac961f78ebee846">Jp</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J0&#39;&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a4eeacb89beca0961ada8c5452925dc81">J0pAll</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#acac6a701a8a36d04fb0f52fdf40a82c4">J0p</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J1&#39;&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a69b6de14bab45dfda47efc2bf9a60d8c">J1pAll</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a64f83e7172dfbb6c2b2b92a1a66bee4d">J1p</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J2&#39;&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a54989a3d1a05d629689d29b0dd03d8be">J2pAll</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a9ac3b6f82f9bdc7d5272f0270b5543f5">J2p</a>);</div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a05386999c1e68124dd96f79ccdd80dbd">StdFace_NotUsed_d</a>(<span class="stringliteral">&quot;D&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a684365c7707466c826248437b06455c4">D</a>[2][2]);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;hubbard&quot;</span>) == 0 ) {</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#afb9e23628e57aea2f08ef65acc308c2a">StdFace_NotUsed_i</a>(<span class="stringliteral">&quot;2S&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>);</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#a9dec65b2b7a257de0b80f5975be6bf93">StdFace_NotUsed_J</a>(<span class="stringliteral">&quot;J&quot;</span>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a52087ff4e3ba6aede54eeed68e53ba5d">JAll</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#af2e748a33b818f5347533d65c0059f11">J</a>);</div><div class="line">    }<span class="comment">/*if (strcmp(StdI-&gt;model, &quot;hubbard&quot;) == 0 )*/</span></div><div class="line">    <span class="keywordflow">else</span> {</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#ad0b1739352d13d79ba19e2973abb67f9">StdFace_PrintVal_i</a>(<span class="stringliteral">&quot;2S&quot;</span>, &amp;StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, 1);</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#a5a86fdb31d13d86813dd893b76f485aa">StdFace_InputSpin</a>(StdI-&gt;<a class="code" href="struct_std_int_list.html#af2e748a33b818f5347533d65c0059f11">J</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a52087ff4e3ba6aede54eeed68e53ba5d">JAll</a>, <span class="stringliteral">&quot;J&quot;</span>);</div><div class="line">    }<span class="comment">/*if (model != &quot;hubbard&quot;)*/</span></div><div class="line"></div><div class="line">  }<span class="comment">/*if (model != &quot;spin&quot;)@@*/</span></div></div><!-- fragment --> to determine the default values of them and unused parameters. For more details, please see the description of each function. Then compute the upper limit of the number of Transfer &amp; Interaction and malloc them. <div class="fragment"><div class="line">  <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;spin&quot;</span>) == 0 ) {<span class="comment">//&gt;&gt;</span></div><div class="line">    ntransMax = StdI-&gt;<a class="code" href="struct_std_int_list.html#a317f2f89352eec7db84fa5933a1ae0f8">nsite</a> * (StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a> + 1<span class="comment">/*h*/</span> + 2 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a><span class="comment">/*Gamma*/</span>);</div><div class="line">    nintrMax = StdI-&gt;<a class="code" href="struct_std_int_list.html#a7cbb66f480057a094b43dc6076cb7b4e">NCell</a> * (StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a><span class="comment">/*D*/</span> + 6<span class="comment">/*J*/</span> + 6<span class="comment">/*J&#39;*/</span>)</div><div class="line">      * (3 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a> + 1) * (3 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a> + 1);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">else</span> {</div><div class="line">    ntransMax = StdI-&gt;<a class="code" href="struct_std_int_list.html#a7cbb66f480057a094b43dc6076cb7b4e">NCell</a> * 2<span class="comment">/*spin*/</span> * (2 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a><span class="comment">/*mu+h+Gamma*/</span> + 12<span class="comment">/*t*/</span> + 12<span class="comment">/*t&#39;*/</span>);</div><div class="line">    nintrMax = StdI-&gt;<a class="code" href="struct_std_int_list.html#a7cbb66f480057a094b43dc6076cb7b4e">NCell</a> * (StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a><span class="comment">/*U*/</span> + 4 * (6<span class="comment">/*V*/</span> + 6<span class="comment">/*V&#39;*/</span>));</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;kondo&quot;</span>) == 0) {</div><div class="line">      ntransMax += StdI-&gt;<a class="code" href="struct_std_int_list.html#a317f2f89352eec7db84fa5933a1ae0f8">nsite</a> / 2 * (StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a> + 1<span class="comment">/*h*/</span> + 2 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a><span class="comment">/*Gamma*/</span>);</div><div class="line">      nintrMax += StdI-&gt;<a class="code" href="struct_std_int_list.html#a317f2f89352eec7db84fa5933a1ae0f8">nsite</a> / 2 * (3 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a> + 1) * (3 * StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a> + 1);</div><div class="line">    }<span class="comment">/*if (strcmp(StdI-&gt;model, &quot;kondo&quot;) == 0)*/</span></div><div class="line">  }<span class="comment">//&lt;&lt;</span></div></div><!-- fragment --> Please estimate the number of bonds per site. <div class="fragment"><div class="line">  <span class="keywordflow">for</span> (kCell = 0; kCell &lt; StdI-&gt;<a class="code" href="struct_std_int_list.html#a7cbb66f480057a094b43dc6076cb7b4e">NCell</a>; kCell++) {</div></div><!-- fragment --> In this loop, the parameters of Hamiltonian are computed &amp; stored. The local term is computed as follows: <div class="fragment"><div class="line">    <span class="comment">/*&gt;&gt;</span></div><div class="line"><span class="comment">    Local term</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    isite = StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a> * kCell;</div><div class="line">    <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;kondo&quot;</span>) == 0 ) isite += StdI-&gt;<a class="code" href="struct_std_int_list.html#a317f2f89352eec7db84fa5933a1ae0f8">nsite</a> / 2;</div><div class="line">    </div><div class="line">    <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;spin&quot;</span>) == 0 ) {</div><div class="line">      <span class="keywordflow">for</span> (isiteUC = 0; isiteUC &lt; StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a>; isiteUC++) {</div><div class="line">        <a class="code" href="_std_face___model_util_8c.html#ac1af12b9586d7c8be9dd531c36595717">StdFace_MagField</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, -StdI-&gt;<a class="code" href="struct_std_int_list.html#a323f712936a7df68950c7eea90da9b50">h</a>, -StdI-&gt;<a class="code" href="struct_std_int_list.html#a847b9f6d3798574c553d567bac91d15b">Gamma</a>, isite + isiteUC);</div><div class="line">        <a class="code" href="_std_face___model_util_8c.html#add96059e3108ff162542b600ca3b9a80">StdFace_GeneralJ</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#a684365c7707466c826248437b06455c4">D</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, isite + isiteUC, isite + isiteUC);</div><div class="line">      }<span class="comment">/*for (jsite = 0; jsite &lt; StdI-&gt;NsiteUC; jsite++)*/</span></div><div class="line">    }<span class="comment">/*if (strcmp(StdI-&gt;model, &quot;spin&quot;) == 0 )*/</span></div><div class="line">    <span class="keywordflow">else</span> {</div><div class="line">      <span class="keywordflow">for</span> (isiteUC = 0; isiteUC &lt; StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a>; isiteUC++)</div><div class="line">        <a class="code" href="_std_face___model_util_8c.html#a01c24570458edde44713a0552a802afe">StdFace_HubbardLocal</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#a924210957d9b10a640fe39be6a531856">mu</a>, -StdI-&gt;<a class="code" href="struct_std_int_list.html#a323f712936a7df68950c7eea90da9b50">h</a>, -StdI-&gt;<a class="code" href="struct_std_int_list.html#a847b9f6d3798574c553d567bac91d15b">Gamma</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#ad89a4c748ea039b34d4b3c86763d2e40">U</a>, isite + isiteUC);</div><div class="line">      </div><div class="line">      <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;kondo&quot;</span>) == 0 ) {</div><div class="line">        jsite = StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a> * kCell;</div><div class="line">        <span class="keywordflow">for</span> (isiteUC = 0; isiteUC &lt; StdI-&gt;<a class="code" href="struct_std_int_list.html#a1db1097def8cb6957f11753744bf215c">NsiteUC</a>; isiteUC++) {</div><div class="line">          <a class="code" href="_std_face___model_util_8c.html#add96059e3108ff162542b600ca3b9a80">StdFace_GeneralJ</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#af2e748a33b818f5347533d65c0059f11">J</a>, 1, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, isite + isiteUC, jsite + isiteUC);</div><div class="line">          <a class="code" href="_std_face___model_util_8c.html#ac1af12b9586d7c8be9dd531c36595717">StdFace_MagField</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, -StdI-&gt;<a class="code" href="struct_std_int_list.html#a323f712936a7df68950c7eea90da9b50">h</a>, -StdI-&gt;<a class="code" href="struct_std_int_list.html#a847b9f6d3798574c553d567bac91d15b">Gamma</a>, jsite + isiteUC);</div><div class="line">        }<span class="comment">/*for (isiteUC = 0; isiteUC &lt; StdI-&gt;NsiteUC; isiteUC++)*/</span></div><div class="line">      }<span class="comment">/*if (strcmp(StdI-&gt;model, &quot;kondo&quot;) == 0 )*/</span></div><div class="line">    }<span class="comment">/*if (strcmp(StdI-&gt;model, &quot;spin&quot;) != 0 )&lt;&lt;*/</span></div></div><!-- fragment --> Probably, it is not necessary to modify this part. The non-local term is as follows: <div class="fragment"><div class="line">    <span class="comment">/*&gt;&gt;</span></div><div class="line"><span class="comment">    Nearest neighbor intra cell 0 -&gt; 1</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    <a class="code" href="_std_face___model_util_8c.html#a8bc881eb932eea5d4616b9bb574630ef">StdFace_SetLabel</a>(StdI, fp, iW, iL, 0, 0, 0, 1, &amp;isite, &amp;jsite, 1, &amp;Cphase, dR);</div><div class="line">    </div><div class="line">    <span class="keywordflow">if</span> (strcmp(StdI-&gt;<a class="code" href="struct_std_int_list.html#ae3d75f889623d1f077621bf61cdcc7f2">model</a>, <span class="stringliteral">&quot;spin&quot;</span>) == 0 ) {</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#add96059e3108ff162542b600ca3b9a80">StdFace_GeneralJ</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#a80d536f7221820b9f90f682e0b9ced98">J2</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, StdI-&gt;<a class="code" href="struct_std_int_list.html#a211b3f4b3da1f5e1692f32246636ada1">S2</a>, isite, jsite);</div><div class="line">    }<span class="comment">/*if (strcmp(StdI-&gt;model, &quot;spin&quot;) == 0 )*/</span></div><div class="line">    <span class="keywordflow">else</span> {</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#af11c2301253e545c597a2833d41a1cfc">StdFace_Hopping</a>(StdI, Cphase * StdI-&gt;<a class="code" href="struct_std_int_list.html#a3615dbe163146e98c4136b9381be0b1e">t2</a>, isite, jsite, dR);</div><div class="line">      <a class="code" href="_std_face___model_util_8c.html#a2a4d37887a480ebe9a993a2921423f78">StdFace_Coulomb</a>(StdI, StdI-&gt;<a class="code" href="struct_std_int_list.html#adb5fc79358ebbd0a039d39e9f7bac133">V2</a>, isite, jsite);</div><div class="line">    }<span class="comment">//&lt;&lt;</span></div></div><!-- fragment --> For more details, please see each function. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jul 1 2019 17:07:29 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
